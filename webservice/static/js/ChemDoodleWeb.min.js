//
// ChemDoodle Web Components 7.0.2
//
// http://web.chemdoodle.com
//
// Copyright 2009-2015 iChemLabs, LLC.  All rights reserved.
//
// The ChemDoodle Web Components library is licensed under version 3
// of the GNU GENERAL PUBLIC LICENSE.
//
// You may redistribute it and/or modify it under the terms of the
// GNU General Public License as published by the Free Software Foundation,
// either version 3 of the License, or (at your option) any later version.
//
// As an exception to the GPL, you may distribute this packed form of
// the code without the copy of the GPL license normally required,
// provided you include this license notice and a URL through which
// recipients can access the corresponding unpacked source code. 
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// Please contact iChemLabs <http://www.ichemlabs.com/contact-us> for
// alternate licensing options.
//
var ChemDoodle=function(){var e={iChemLabs:{},informatics:{},io:{},lib:{},notations:{},structures:{}};return e.structures.d2={},e.structures.d3={},e.getVersion=function(){return"7.0.2"},e}();(function(e,t,n){function r(e){var t=e.length,n=rt.type(e);return rt.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&0<t&&t-1 in e)}function i(e,t,r,i){if(rt.acceptData(e)){var s=rt.expando,o=e.nodeType,u=o?rt.cache:e,a=o?e[s]:e[s]&&s;if(a&&u[a]&&(i||u[a].data)||r!==n||"string"!=typeof t){a||(a=o?e[s]=K.pop()||rt.guid++:s),u[a]||(u[a]=o?{}:{toJSON:rt.noop});if("object"==typeof t||"function"==typeof t)i?u[a]=rt.extend(u[a],t):u[a].data=rt.extend(u[a].data,t);return e=u[a],i||(e.data||(e.data={}),e=e.data),r!==n&&(e[rt.camelCase(t)]=r),"string"==typeof t?(r=e[t],null==r&&(r=e[rt.camelCase(t)])):r=e,r}}}function s(e,t,n){if(rt.acceptData(e)){var r,i,s=e.nodeType,o=s?rt.cache:e,a=s?e[rt.expando]:rt.expando;if(o[a]){if(t&&(r=n?o[a]:o[a].data)){rt.isArray(t)?t=t.concat(rt.map(t,rt.camelCase)):t in r?t=[t]:(t=rt.camelCase(t),t=t in r?[t]:t.split(" "));for(i=t.length;i--;)delete r[t[i]];if(n?!u(r):!rt.isEmptyObject(r))return}if(!n&&(delete o[a].data,!u(o[a])))return;s?rt.cleanData([e],!0):rt.support.deleteExpando||o!=o.window?delete o[a]:o[a]=null}}}function o(e,t,r){if(r===n&&1===e.nodeType)if(r="data-"+t.replace(Gn,"-$1").toLowerCase(),r=e.getAttribute(r),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:Qn.test(r)?rt.parseJSON(r):r}catch(i){}rt.data(e,t,r)}else r=n;return r}function u(e){for(var t in e)if(("data"!==t||!rt.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function a(){return!0}function f(){return!1}function l(){try{return W.activeElement}catch(e){}}function c(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function h(e,t,n){if(rt.isFunction(t))return rt.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return rt.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(hr.test(t))return rt.filter(t,e,n);t=rt.filter(t,e)}return rt.grep(e,function(e){return 0<=rt.inArray(e,t)!==n})}function p(e){var t=mr.split("|");e=e.createDocumentFragment();if(e.createElement)for(;t.length;)e.createElement(t.pop());return e}function d(e,t){return rt.nodeName(e,"table")&&rt.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function v(e){return e.type=(null!==rt.find.attr(e,"type"))+"/"+e.type,e}function m(e){var t=Lr.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function g(e,t){for(var n,r=0;null!=(n=e[r]);r++)rt._data(n,"globalEval",!t||rt._data(t[r],"globalEval"))}function y(e,t){if(1===t.nodeType&&rt.hasData(e)){var n,r,i;r=rt._data(e);var s=rt._data(t,r),o=r.events;if(o)for(n in delete s.handle,s.events={},o){r=0;for(i=o[n].length;r<i;r++)rt.event.add(t,n,o[n][r])}s.data&&(s.data=rt.extend({},s.data))}}function b(e,t){var r,i,s=0,o=typeof e.getElementsByTagName!==U?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==U?e.querySelectorAll(t||"*"):n;if(!o){o=[];for(r=e.childNodes||e;null!=(i=r[s]);s++)!t||rt.nodeName(i,t)?o.push(i):rt.merge(o,b(i,t))}return t===n||t&&rt.nodeName(e,t)?rt.merge([e],o):o}function w(e){Nr.test(e.type)&&(e.defaultChecked=e.checked)}function E(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=$r.length;i--;)if(t=$r[i]+n,t in e)return t;return r}function S(e,t){return e=t||e,"none"===rt.css(e,"display")||!rt.contains(e.ownerDocument,e)}function x(e,t){for(var n,r,i,s=[],o=0,u=e.length;o<u;o++)if(r=e[o],r.style)(s[o]=rt._data(r,"olddisplay"),n=r.style.display,t)?(!s[o]&&"none"===n&&(r.style.display=""),""===r.style.display&&S(r)&&(s[o]=rt._data(r,"olddisplay",k(r.nodeName)))):!s[o]&&(i=S(r),n&&"none"!==n||!i)&&rt._data(r,"olddisplay",i?n:rt.css(r,"display"));for(o=0;o<u;o++)if(r=e[o],r.style&&(!t||"none"===r.style.display||""===r.style.display))r.style.display=t?s[o]||"":"none";return e}function T(e,t,n){return(e=qr.exec(t))?Math.max(0,e[1]-(n||0))+(e[2]||"px"):t}function N(e,t,n,r,i){t=n===(r?"border":"content")?4:"width"===t?1:0;for(var s=0;4>t;t+=2)"margin"===n&&(s+=rt.css(e,n+Vr[t],!0,i)),r?("content"===n&&(s-=rt.css(e,"padding"+Vr[t],!0,i)),"margin"!==n&&(s-=rt.css(e,"border"+Vr[t]+"Width",!0,i))):(s+=rt.css(e,"padding"+Vr[t],!0,i),"padding"!==n&&(s+=rt.css(e,"border"+Vr[t]+"Width",!0,i)));return s}function C(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=Dr(e),o=rt.support.boxSizing&&"border-box"===rt.css(e,"boxSizing",!1,s);if(0>=i||null==i){i=Pr(e,t,s);if(0>i||null==i)i=e.style[t];if(Rr.test(i))return i;r=o&&(rt.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+N(e,t,n||(o?"border":"content"),r,s)+"px"}function k(e){var t=W,n=zr[e];if(!n){n=L(e,t);if("none"===n||!n)_r=(_r||rt("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(_r[0].contentWindow||_r[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=L(e,t),_r.detach();zr[e]=n}return n}function L(e,t){var n=rt(t.createElement(e)).appendTo(t.body),r=rt.css(n[0],"display");return n.remove(),r}function A(e,t,n,r){var i;if(rt.isArray(t))rt.each(t,function(t,i){n||Kr.test(e)?r(e,i):A(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(!n&&"object"===rt.type(t))for(i in t)A(e+"["+i+"]",t[i],n,r);else r(e,t)}function O(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(st)||[];if(rt.isFunction(n))for(;r=s[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function M(e,t,n,r){function i(u){var a;return s[u]=!0,rt.each(e[u]||[],function(e,u){var f=u(t,n,r);if("string"==typeof f&&!o&&!s[f])return t.dataTypes.unshift(f),i(f),!1;if(o)return!(a=f)}),a}var s={},o=e===ci;return i(t.dataTypes[0])||!s["*"]&&i("*")}function _(e,t){var r,i,s=rt.ajaxSettings.flatOptions||{};for(i in t)t[i]!==n&&((s[i]?e:r||(r={}))[i]=t[i]);return r&&rt.extend(!0,e,r),e}function D(){try{return new e.XMLHttpRequest}catch(t){}}function P(){return setTimeout(function(){wi=n}),wi=rt.now()}function H(e,t,n){for(var r,i=(Ci[t]||[]).concat(Ci["*"]),s=0,o=i.length;s<o;s++)if(r=i[s].call(n,t,e))return r}function B(e,t,n){var r,i,s=0,o=Ni.length,u=rt.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;for(var t=wi||P(),t=Math.max(0,f.startTime+f.duration-t),n=1-(t/f.duration||0),r=0,s=f.tweens.length;r<s;r++)f.tweens[r].run(n);return u.notifyWith(e,[f,n,t]),1>n&&s?t:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:rt.extend({},t),opts:rt.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:wi||P(),duration:n.duration,tweens:[],createTween:function(t,n){var r=rt.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}});t=f.props,n=f.opts.specialEasing;var l,c,h,p;for(r in t)if(l=rt.camelCase(r),c=n[l],h=t[r],rt.isArray(h)&&(c=h[1],h=t[r]=h[0]),r!==l&&(t[l]=h,delete t[r]),(p=rt.cssHooks[l])&&"expand"in p)for(r in h=p.expand(h),delete t[l],h)r in t||(t[r]=h[r],n[r]=c);else n[l]=c;for(;s<o;s++)if(r=Ni[s].call(f,e,t,f.opts))return r;return rt.map(t,H,f),rt.isFunction(f.opts.start)&&f.opts.start.call(e,f),rt.fx.timer(rt.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function j(e,t,n,r,i){return new j.prototype.init(e,t,n,r,i)}function F(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Vr[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function I(e){return rt.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var q,R,U=typeof n,z=e.location,W=e.document,X=W.documentElement,V=e.jQuery,$=e.$,J={},K=[],Q=K.concat,G=K.push,Y=K.slice,Z=K.indexOf,et=J.toString,tt=J.hasOwnProperty,nt="1.10.2".trim,rt=function(e,t){return new rt.fn.init(e,t,R)},it=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,st=/\S+/g,ot=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ut=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,at=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ft=/^[\],:{}\s]*$/,lt=/(?:^|:|,)(?:\s*\[)+/g,ct=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,ht=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,pt=/^-ms-/,dt=/-([\da-z])/gi,vt=function(e,t){return t.toUpperCase()},mt=function(e){if(W.addEventListener||"load"===e.type||"complete"===W.readyState)gt(),rt.ready()},gt=function(){W.addEventListener?(W.removeEventListener("DOMContentLoaded",mt,!1),e.removeEventListener("load",mt,!1)):(W.detachEvent("onreadystatechange",mt),e.detachEvent("onload",mt))};rt.fn=rt.prototype={jquery:"1.10.2",constructor:rt,init:function(e,t,r){var i;if(!e)return this;if("string"==typeof e){if((i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&3<=e.length?[null,e,null]:ut.exec(e))&&(i[1]||!t)){if(i[1]){if(t=t instanceof rt?t[0]:t,rt.merge(this,rt.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:W,!0)),at.test(i[1])&&rt.isPlainObject(t))for(i in t)rt.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i])}else{if((t=W.getElementById(i[2]))&&t.parentNode){if(t.id!==i[2])return r.find(e);this.length=1,this[0]=t}this.context=W,this.selector=e}return this}return!t||t.jquery?(t||r).find(e):this.constructor(t).find(e)}return e.nodeType?(this.context=this[0]=e,this.length=1,this):rt.isFunction(e)?r.ready(e):(e.selector!==n&&(this.selector=e.selector,this.context=e.context),rt.makeArray(e,this))},selector:"",length:0,toArray:function(){return Y.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){return e=rt.merge(this.constructor(),e),e.prevObject=this,e.context=this.context,e},each:function(e,t){return rt.each(this,e,t)},ready:function(e){return rt.ready.promise().done(e),this},slice:function(){return this.pushStack(Y.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length;return e=+e+(0>e?t:0),this.pushStack(0<=e&&e<t?[this[e]]:[])},map:function(e){return this.pushStack(rt.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:G,sort:[].sort,splice:[].splice},rt.fn.init.prototype=rt.fn,rt.extend=rt.fn.extend=function(){var e,t,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;"boolean"==typeof o&&(f=o,o=arguments[1]||{},u=2),"object"!=typeof o&&!rt.isFunction(o)&&(o={}),a===u&&(o=this,--u);for(;u<a;u++)if(null!=(s=arguments[u]))for(i in s)e=o[i],r=s[i],o!==r&&(f&&r&&(rt.isPlainObject(r)||(t=rt.isArray(r)))?(t?(t=!1,e=e&&rt.isArray(e)?e:[]):e=e&&rt.isPlainObject(e)?e:{},o[i]=rt.extend(f,e,r)):r!==n&&(o[i]=r));return o},rt.extend({expando:"jQuery"+("1.10.2"+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===rt&&(e.$=$),t&&e.jQuery===rt&&(e.jQuery=V),rt},isReady:!1,readyWait:1,holdReady:function(e){e?rt.readyWait++:rt.ready(!0)},ready:function(e){if(!0===e?!--rt.readyWait:!rt.isReady){if(!W.body)return setTimeout(rt.ready);rt.isReady=!0,!0!==e&&0<--rt.readyWait||(q.resolveWith(W,[rt]),rt.fn.trigger&&rt(W).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===rt.type(e)},isArray:Array.isArray||function(e){return"array"===rt.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?J[et.call(e)]||"object":typeof e},isPlainObject:function(e){var t;if(!e||"object"!==rt.type(e)||e.nodeType||rt.isWindow(e))return!1;try{if(e.constructor&&!tt.call(e,"constructor")&&!tt.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}if(rt.support.ownLast)for(t in e)return tt.call(e,t);for(t in e);return t===n||tt.call(e,t)},isEmptyObject:function(e){for(var t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||W;var r=at.exec(e);return n=!n&&[],r?[t.createElement(r[1])]:(r=rt.buildFragment([e],t,n),n&&rt(n).remove(),rt.merge([],r.childNodes))},parseJSON:function(t){if(e.JSON&&e.JSON.parse)return e.JSON.parse(t);if(null===t)return t;if("string"==typeof t&&(t=rt.trim(t))&&ft.test(t.replace(ct,"@").replace(ht,"]").replace(lt,"")))return(new Function("return "+t))();rt.error("Invalid JSON: "+t)},parseXML:function(t){var r,i;if(!t||"string"!=typeof t)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(t,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(t))}catch(s){r=n}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&rt.error("Invalid XML: "+t),r},noop:function(){},globalEval:function(t){t&&rt.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(pt,"ms-").replace(dt,vt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var i,s=0,o=e.length;i=r(e);if(n){if(i)for(;s<o&&(i=t.apply(e[s],n),!1!==i);s++);else for(s in e)if(i=t.apply(e[s],n),!1===i)break}else if(i)for(;s<o&&(i=t.call(e[s],s,e[s]),!1!==i);s++);else for(s in e)if(i=t.call(e[s],s,e[s]),!1===i)break;return e},trim:nt&&!nt.call("﻿ ")?function(e){return null==e?"":nt.call(e)}:function(e){return null==e?"":(e+"").replace(ot,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(r(Object(e))?rt.merge(n,"string"==typeof e?[e]:e):G.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(Z)return Z.call(t,e,n);r=t.length;for(n=n?0>n?Math.max(0,r+n):n:0;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,t){var r=t.length,i=e.length,s=0;if("number"==typeof r)for(;s<r;s++)e[i++]=t[s];else for(;t[s]!==n;)e[i++]=t[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;for(n=!!n;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var i,s=0,o=e.length,u=[];if(r(e))for(;s<o;s++)i=t(e[s],s,n),null!=i&&(u[u.length]=i);else for(s in e)i=t(e[s],s,n),null!=i&&(u[u.length]=i);return Q.apply([],u)},guid:1,proxy:function(e,t){var r,i;return"string"==typeof t&&(i=e[t],t=e,e=i),rt.isFunction(e)?(r=Y.call(arguments,2),i=function(){return e.apply(t||this,r.concat(Y.call(arguments)))},i.guid=e.guid=e.guid||rt.guid++,i):n},access:function(e,t,r,i,s,o,u){var a=0,f=e.length,l=null==r;if("object"===rt.type(r))for(a in s=!0,r)rt.access(e,t,a,r[a],!0,o,u);else if(i!==n&&(s=!0,rt.isFunction(i)||(u=!0),l&&(u?(t.call(e,i),t=null):(l=t,t=function(e,t,n){return l.call(rt(e),n)})),t))for(;a<f;a++)t(e[a],r,u?i:i.call(e[a],a,t(e[a],r)));return s?e:l?t.call(e):f?t(e[0],r):o},now:function(){return(new Date).getTime()},swap:function(e,t,n,r){var i,s={};for(i in t)s[i]=e.style[i],e.style[i]=t[i];n=n.apply(e,r||[]);for(i in t)e.style[i]=s[i];return n}}),rt.ready.promise=function(t){if(!q)if(q=rt.Deferred(),"complete"===W.readyState)setTimeout(rt.ready);else if(W.addEventListener)W.addEventListener("DOMContentLoaded",mt,!1),e.addEventListener("load",mt,!1);else{W.attachEvent("onreadystatechange",mt),e.attachEvent("onload",mt);var n=!1;try{n=null==e.frameElement&&W.documentElement}catch(r){}n&&n.doScroll&&function i(){if(!rt.isReady){try{n.doScroll("left")}catch(e){return setTimeout(i,50)}gt(),rt.ready()}}()}return q.promise(t)},rt.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){J["[object "+t+"]"]=t.toLowerCase()}),R=rt(W);var yt=e,bt=function(e,t,n,r){var i,s,o,u,a;(t?t.ownerDocument||t:en)!==Vt&&Xt(t),t=t||Vt,n=n||[];if(!e||"string"!=typeof e)return n;if(1!==(u=t.nodeType)&&9!==u)return[];if(Jt&&!r){if(i=An.exec(e))if(o=i[1]){if(9===u){if(!(s=t.getElementById(o))||!s.parentNode)return n;if(s.id===o)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(o))&&Yt(t,s)&&s.id===o)return n.push(s),n}else{if(i[2])return dn.apply(n,t.getElementsByTagName(e)),n;if((o=i[3])&&jt.getElementsByClassName&&t.getElementsByClassName)return dn.apply(n,t.getElementsByClassName(o)),n}if(jt.qsa&&(!Kt||!Kt.test(e))){s=i=Zt,o=t,a=9===u&&e;if(1===u&&"object"!==t.nodeName.toLowerCase()){u=At(e),(i=t.getAttribute("id"))?s=i.replace(_n,"\\$&"):t.setAttribute("id",s),s="[id='"+s+"'] ";for(o=u.length;o--;)u[o]=s+Ot(u[o]);o=xn.test(e)&&t.parentNode||t,a=u.join(",")}if(a)try{return dn.apply(n,o.querySelectorAll(a)),n}catch(f){}finally{i||t.removeAttribute("id")}}}var l;e:{e=e.replace(wn,"$1"),s=At(e);if(!r&&1===s.length){i=s[0]=s[0].slice(0);if(2<i.length&&"ID"===(l=i[0]).type&&jt.getById&&9===t.nodeType&&Jt&&It.relative[i[1].type]){t=(It.find.ID(l.matches[0].replace(Dn,Pn),t)||[])[0];if(!t){l=n;break e}e=e.slice(i.shift().value.length)}for(u=kn.needsContext.test(e)?0:i.length;u--;){l=i[u];if(It.relative[o=l.type])break;if(o=It.find[o])if(r=o(l.matches[0].replace(Dn,Pn),xn.test(i[0].type)&&t.parentNode||t)){i.splice(u,1),e=r.length&&Ot(i);if(!e){dn.apply(n,r),l=n;break e}break}}}Ut(e,s)(r,t,!Jt,n,xn.test(e)),l=n}return l},wt=function(){function e(n,r){return t.push(n+=" ")>It.cacheLength&&delete e[t.shift()],e[n]=r}var t=[];return e},Et=function(e){return e[Zt]=!0,e},St=function(e){var t=Vt.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t)}},xt=function(e,t){for(var n=e.split("|"),r=e.length;r--;)It.attrHandle[n[r]]=t},Tt=function(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||fn)-(~e.sourceIndex||fn);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1},Nt=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}},Ct=function(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}},kt=function(e){return Et(function(t){return t=+t,Et(function(n,r){for(var i,s=e([],n.length,t),o=s.length;o--;)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})},Lt=function(){},At=function(e,t){var n,r,i,s,o,u,a;if(o=sn[e+" "])return t?0:o.slice(0);o=e,u=[];for(a=It.preFilter;o;){if(!n||(r=En.exec(o)))r&&(o=o.slice(r[0].length)||o),u.push(i=[]);n=!1;if(r=Sn.exec(o))n=r.shift(),i.push({value:n,type:r[0].replace(wn," ")}),o=o.slice(n.length);for(s in It.filter)(r=kn[s].exec(o))&&(!a[s]||(r=a[s](r)))&&(n=r.shift(),i.push({value:n,type:s,matches:r}),o=o.slice(n.length));if(!n)break}return t?o.length:o?bt.error(e):sn(e,u).slice(0)},Ot=function(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r},Mt=function(e,t,n){var r=t.dir,i=n&&"parentNode"===r,s=nn++;return t.first?function(t,n,s){for(;t=t[r];)if(1===t.nodeType||i)return e(t,n,s)}:function(t,n,o){var u,a,f,l=tn+" "+s;if(o){for(;t=t[r];)if((1===t.nodeType||i)&&e(t,n,o))return!0}else for(;t=t[r];)if(1===t.nodeType||i)if(f=t[Zt]||(t[Zt]={}),(a=f[r])&&a[0]===l){if(!0===(u=a[1])||u===Ft)return!0===u}else if(a=f[r]=[l],a[1]=e(t,n,o)||Ft,!0===a[1])return!0}},_t=function(e){return 1<e.length?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]},Dt=function(e,t,n,r,i){for(var s,o=[],u=0,a=e.length,f=null!=t;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o},Pt=function(e,t,n,r,i,s){return r&&!r[Zt]&&(r=Pt(r)),i&&!i[Zt]&&(i=Pt(i,s)),Et(function(s,o,u,a){var f,l,c=[],h=[],p=o.length,d;if(!(d=s)){d=t||"*";for(var v=u.nodeType?[u]:u,m=[],g=0,y=v.length;g<y;g++)bt(d,v[g],m);d=m}d=e&&(s||!t)?Dt(d,c,e,u,a):d,v=n?i||(s?e:p||r)?[]:o:d,n&&n(d,v,u,a);if(r){f=Dt(v,h),r(f,[],u,a);for(u=f.length;u--;)if(l=f[u])v[h[u]]=!(d[h[u]]=l)}if(s){if(i||e){if(i){f=[];for(u=v.length;u--;)(l=v[u])&&f.push(d[u]=l);i(null,v=[],f,a)}for(u=v.length;u--;)(l=v[u])&&-1<(f=i?mn.call(s,l):c[u])&&(s[f]=!(o[f]=l))}}else v=Dt(v===o?v.splice(p,v.length):v),i?i(null,o,v,a):dn.apply(o,v)})},Ht=function(e){var t,n,r,i=e.length,s=It.relative[e[0].type];n=s||It.relative[" "];for(var o=s?1:0,u=Mt(function(e){return e===t},n,!0),a=Mt(function(e){return-1<mn.call(t,e)},n,!0),f=[function(e,n,r){return!s&&(r||n!==zt)||((t=n).nodeType?u(e,n,r):a(e,n,r))}];o<i;o++)if(n=It.relative[e[o].type])f=[Mt(_t(f),n)];else{n=It.filter[e[o].type].apply(null,e[o].matches);if(n[Zt]){for(r=++o;r<i&&!It.relative[e[r].type];r++);return Pt(1<o&&_t(f),1<o&&Ot(e.slice(0,o-1).concat({value:" "===e[o-2].type?"*":""})).replace(wn,"$1"),n,o<r&&Ht(e.slice(o,r)),r<i&&Ht(e=e.slice(r)),r<i&&Ot(e))}f.push(n)}return _t(f)},Bt,jt,Ft,It,qt,Rt,Ut,zt,Wt,Xt,Vt,$t,Jt,Kt,Qt,Gt,Yt,Zt="sizzle"+ -(new Date),en=yt.document,tn=0,nn=0,rn=wt(),sn=wt(),on=wt(),un=!1,an=function(e,t){return e===t&&(un=!0),0},fn=-2147483648,ln={}.hasOwnProperty,cn=[],hn=cn.pop,pn=cn.push,dn=cn.push,vn=cn.slice,mn=cn.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t;return-1},gn="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),yn="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)[\\x20\\t\\r\\n\\f]*(?:([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+gn+")|)|)[\\x20\\t\\r\\n\\f]*\\]",bn=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+yn.replace(3,8)+")*)|.*)\\)|)",wn=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),En=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,Sn=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,xn=/[\x20\t\r\n\f]*[+~]/,Tn=RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*)[\\x20\\t\\r\\n\\f]*\\]","g"),Nn=RegExp(bn),Cn=RegExp("^"+gn+"$"),kn={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w*")+")"),ATTR:RegExp("^"+yn),PSEUDO:RegExp("^"+bn),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)","i")},Ln=/^[^{]+\{\s*\[native \w/,An=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,On=/^(?:input|select|textarea|button)$/i,Mn=/^h\d$/i,_n=/'|\\/g,Dn=RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),Pn=function(e,t,n){return e="0x"+t-65536,e!==e||n?t:0>e?String.fromCharCode(e+65536):String.fromCharCode(e>>10|55296,e&1023|56320)};try{dn.apply(cn=vn.call(en.childNodes),en.childNodes),cn[en.childNodes.length].nodeType}catch(Hn){dn={apply:cn.length?function(e,t){pn.apply(e,vn.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}Rt=bt.isXML=function(e){return(e=e&&(e.ownerDocument||e).documentElement)?"HTML"!==e.nodeName:!1},jt=bt.support={},Xt=bt.setDocument=function(e){var t=e?e.ownerDocument||e:en;e=t.defaultView;if(t===Vt||9!==t.nodeType||!t.documentElement)return Vt;Vt=t,$t=t.documentElement,Jt=!Rt(t),e&&e.attachEvent&&e!==e.top&&e.attachEvent("onbeforeunload",function(){Xt()}),jt.attributes=St(function(e){return e.className="i",!e.getAttribute("className")}),jt.getElementsByTagName=St(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),jt.getElementsByClassName=St(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),jt.getById=St(function(e){return $t.appendChild(e).id=Zt,!t.getElementsByName||!t.getElementsByName(Zt).length}),jt.getById?(It.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&Jt){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},It.filter.ID=function(e){var t=e.replace(Dn,Pn);return function(e){return e.getAttribute("id")===t}}):(delete It.find.ID,It.filter.ID=function(e){var t=e.replace(Dn,Pn);return function(e){return(e="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id"))&&e.value===t}}),It.find.TAG=jt.getElementsByTagName?function(e,t){if("undefined"!=typeof t.getElementsByTagName)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){for(;n=s[i++];)1===n.nodeType&&r.push(n);return r}return s},It.find.CLASS=jt.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&Jt)return t.getElementsByClassName(e)},Qt=[],Kt=[];if(jt.qsa=Ln.test(t.querySelectorAll))St(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||Kt.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)"),e.querySelectorAll(":checked").length||Kt.push(":checked")}),St(function(e){var n=t.createElement("input");n.setAttribute("type","hidden"),e.appendChild(n).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&Kt.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"),e.querySelectorAll(":enabled").length||Kt.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),Kt.push(",.*:")});return(jt.matchesSelector=Ln.test(Gt=$t.webkitMatchesSelector||$t.mozMatchesSelector||$t.oMatchesSelector||$t.msMatchesSelector))&&St(function(e){jt.disconnectedMatch=Gt.call(e,"div"),Gt.call(e,"[s!='']:x"),Qt.push("!=",bn)}),Kt=Kt.length&&RegExp(Kt.join("|")),Qt=Qt.length&&RegExp(Qt.join("|")),Yt=Ln.test($t.contains)||$t.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&e.compareDocumentPosition(r)&16)}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},an=$t.compareDocumentPosition?function(e,n){if(e===n)return un=!0,0;var r=n.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(n);return r?r&1||!jt.sortDetached&&n.compareDocumentPosition(e)===r?e===t||Yt(en,e)?-1:n===t||Yt(en,n)?1:Wt?mn.call(Wt,e)-mn.call(Wt,n):0:r&4?-1:1:e.compareDocumentPosition?-1:1}:function(e,n){var r,i=0;r=e.parentNode;var s=n.parentNode,o=[e],u=[n];if(e===n)return un=!0,0;if(!r||!s)return e===t?-1:n===t?1:r?-1:s?1:Wt?mn.call(Wt,e)-mn.call(Wt,n):0;if(r===s)return Tt(e,n);for(r=e;r=r.parentNode;)o.unshift(r);for(r=n;r=r.parentNode;)u.unshift(r);for(;o[i]===u[i];)i++;return i?Tt(o[i],u[i]):o[i]===en?-1:u[i]===en?1:0},t},bt.matches=function(e,t){return bt(e,null,null,t)},bt.matchesSelector=function(e,t){(e.ownerDocument||e)!==Vt&&Xt(e),t=t.replace(Tn,"='$1']");if(jt.matchesSelector&&Jt&&(!Qt||!Qt.test(t))&&(!Kt||!Kt.test(t)))try{var n=Gt.call(e,t);if(n||jt.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(r){}return 0<bt(t,Vt,null,[e]).length},bt.contains=function(e,t){return(e.ownerDocument||e)!==Vt&&Xt(e),Yt(e,t)},bt.attr=function(e,t){(e.ownerDocument||e)!==Vt&&Xt(e);var n=It.attrHandle[t.toLowerCase()],n=n&&ln.call(It.attrHandle,t.toLowerCase())?n(e,t,!Jt):void 0;return void 0===n?jt.attributes||!Jt?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null:n},bt.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},bt.uniqueSort=function(e){var t,n=[],r=0,i=0;un=!jt.detectDuplicates,Wt=!jt.sortStable&&e.slice(0),e.sort(an);if(un){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return e},qt=bt.getText=function(e){var t,n="",r=0;if(t=e.nodeType){if(1===t||9===t||11===t){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=qt(e)}else if(3===t||4===t)return e.nodeValue}else for(;t=e[r];r++)n+=qt(t);return n},It=bt.selectors={cacheLength:50,createPseudo:Et,match:kn,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Dn,Pn),e[3]=(e[4]||e[5]||"").replace(Dn,Pn),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||bt.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&bt.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return kn.CHILD.test(e[0])?null:(e[3]&&void 0!==e[4]?e[2]=e[4]:n&&Nn.test(n)&&(t=At(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Dn,Pn).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=rn[e+" "];return t||(t=RegExp("(^|[\\x20\\t\\r\\n\\f])"+e+"([\\x20\\t\\r\\n\\f]|$)"))&&rn(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){return r=bt.attr(r,e),null==r?"!="===t:t?(r+="","="===t?r===n:"!="===t?r!==n:"^="===t?n&&0===r.indexOf(n):"*="===t?n&&-1<r.indexOf(n):"$="===t?n&&r.slice(-n.length)===n:"~="===t?-1<(" "+r+" ").indexOf(n):"|="===t?r===n||r.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p;n=s!==o?"nextSibling":"previousSibling";var d=t.parentNode,v=u&&t.nodeName.toLowerCase();a=!a&&!u;if(d){if(s){for(;n;){for(l=t;l=l[n];)if(u?l.nodeName.toLowerCase()===v:1===l.nodeType)return!1;p=n="only"===e&&!p&&"nextSibling"}return!0}p=[o?d.firstChild:d.lastChild];if(o&&a){a=d[Zt]||(d[Zt]={}),f=a[e]||[],h=f[0]===tn&&f[1],c=f[0]===tn&&f[2];for(l=h&&d.childNodes[h];l=++h&&l&&l[n]||(c=h=0)||p.pop();)if(1===l.nodeType&&++c&&l===t){a[e]=[tn,h,c];break}}else if(a&&(f=(t[Zt]||(t[Zt]={}))[e])&&f[0]===tn)c=f[1];else for(;l=++h&&l&&l[n]||(c=h=0)||p.pop();)if((u?l.nodeName.toLowerCase()===v:1===l.nodeType)&&++c)if(a&&((l[Zt]||(l[Zt]={}))[e]=[tn,c]),l===t)break;return c-=i,c===r||0===c%r&&0<=c/r}}},PSEUDO:function(e,t){var n,r=It.pseudos[e]||It.setFilters[e.toLowerCase()]||bt.error("unsupported pseudo: "+e);return r[Zt]?r(t):1<r.length?(n=[e,e,"",t],It.setFilters.hasOwnProperty(e.toLowerCase())?Et(function(e,n){for(var i,s=r(e,t),o=s.length;o--;)i=mn.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:Et(function(e){var t=[],n=[],r=Ut(e.replace(wn,"$1"));return r[Zt]?Et(function(e,t,n,i){i=r(e,null,i,[]);for(var s=e.length;s--;)if(n=i[s])e[s]=!(t[s]=n)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:Et(function(e){return function(t){return 0<bt(e,t).length}}),contains:Et(function(e){return function(t){return-1<(t.textContent||t.innerText||qt(t)).indexOf(e)}}),lang:Et(function(e){return Cn.test(e||"")||bt.error("unsupported lang: "+e),e=e.replace(Dn,Pn).toLowerCase(),function(t){var n;do if(n=Jt?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(e){var t=yt.location&&yt.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===$t},focus:function(e){return e===Vt.activeElement&&(!Vt.hasFocus||Vt.hasFocus())&&!(!e.type&&!e.href&&!~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if("@"<e.nodeName||3===
e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!It.pseudos.empty(e)},header:function(e){return Mn.test(e.nodeName)},input:function(e){return On.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:kt(function(){return[0]}),last:kt(function(e,t){return[t-1]}),eq:kt(function(e,t,n){return[0>n?n+t:n]}),even:kt(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:kt(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:kt(function(e,t,n){for(t=0>n?n+t:n;0<=--t;)e.push(t);return e}),gt:kt(function(e,t,n){for(n=0>n?n+t:n;++n<t;)e.push(n);return e})}},It.pseudos.nth=It.pseudos.eq;for(Bt in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})It.pseudos[Bt]=Nt(Bt);for(Bt in{submit:!0,reset:!0})It.pseudos[Bt]=Ct(Bt);Lt.prototype=It.filters=It.pseudos,It.setFilters=new Lt,Ut=bt.compile=function(e,t){var n,r=[],i=[],s=on[e+" "];if(!s){t||(t=At(e));for(n=t.length;n--;)s=Ht(t[n]),s[Zt]?r.push(s):i.push(s);var o=0,u=0<r.length,a=0<i.length;n=function(e,t,n,s,f){var l,c,h=[],p=0,d="0",v=e&&[],m=null!=f,g=zt,y=e||a&&It.find.TAG("*",f&&t.parentNode||t),b=tn+=null==g?1:Math.random()||.1;m&&(zt=t!==Vt&&t,Ft=o);for(;null!=(f=y[d]);d++){if(a&&f){for(l=0;c=i[l++];)if(c(f,t,n)){s.push(f);break}m&&(tn=b,Ft=++o)}u&&((f=!c&&f)&&p--,e&&v.push(f))}p+=d;if(u&&d!==p){for(l=0;c=r[l++];)c(v,h,t,n);if(e){if(0<p)for(;d--;)!v[d]&&!h[d]&&(h[d]=hn.call(s));h=Dt(h)}dn.apply(s,h),m&&!e&&0<h.length&&1<p+r.length&&bt.uniqueSort(s)}return m&&(tn=b,zt=g),v},n=u?Et(n):n,s=on(e,n)}return s},jt.sortStable=Zt.split("").sort(an).join("")===Zt,jt.detectDuplicates=un,Xt(),jt.sortDetached=St(function(e){return e.compareDocumentPosition(Vt.createElement("div"))&1}),St(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||xt("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),(!jt.attributes||!St(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))&&xt("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),St(function(e){return null==e.getAttribute("disabled")})||xt("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(e,t,n){var r;if(!n)return(r=e.getAttributeNode(t))&&r.specified?r.value:!0===e[t]?t.toLowerCase():null}),rt.find=bt,rt.expr=bt.selectors,rt.expr[":"]=rt.expr.pseudos,rt.unique=bt.uniqueSort,rt.text=bt.getText,rt.isXMLDoc=bt.isXML,rt.contains=bt.contains;var Bn={};rt.Callbacks=function(e){var t;if("string"==typeof e){if(!(t=Bn[e])){t=e;var r=Bn[t]={};rt.each(t.match(st)||[],function(e,t){r[t]=!0}),t=r}}else t=rt.extend({},e);e=t;var i,s,o,u,a,f,l=[],c=!e.once&&[],h=function(t){s=e.memory&&t,o=!0,a=f||0,f=0,u=l.length;for(i=!0;l&&a<u;a++)if(!1===l[a].apply(t[0],t[1])&&e.stopOnFalse){s=!1;break}i=!1,l&&(c?c.length&&h(c.shift()):s?l=[]:p.disable())},p={add:function(){if(l){var t=l.length;(function n(t){rt.each(t,function(t,r){var i=rt.type(r);"function"===i?(!e.unique||!p.has(r))&&l.push(r):r&&r.length&&"string"!==i&&n(r)})})(arguments),i?u=l.length:s&&(f=t,h(s))}return this},remove:function(){return l&&rt.each(arguments,function(e,t){for(var n;-1<(n=rt.inArray(t,l,n));)l.splice(n,1),i&&(n<=u&&u--,n<=a&&a--)}),this},has:function(e){return e?-1<rt.inArray(e,l):!!l&&!!l.length},empty:function(){return l=[],u=0,this},disable:function(){return l=c=s=n,this},disabled:function(){return!l},lock:function(){return c=n,s||p.disable(),this},locked:function(){return!c},fireWith:function(e,t){return l&&(!o||c)&&(t=t||[],t=[e,t.slice?t.slice():t],i?c.push(t):h(t)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!o}};return p},rt.extend({Deferred:function(e){var t=[["resolve","done",rt.Callbacks("once memory"),"resolved"],["reject","fail",rt.Callbacks("once memory"),"rejected"],["notify","progress",rt.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return rt.Deferred(function(n){rt.each(t,function(t,s){var o=s[0],u=rt.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&rt.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?rt.extend(e,r):r}},i={};return r.pipe=r.then,rt.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=Y.call(arguments),r=n.length,i=1!==r||e&&rt.isFunction(e.promise)?r:0,s=1===i?e:rt.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=1<arguments.length?Y.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(1<r){u=Array(r),a=Array(r);for(f=Array(r);t<r;t++)n[t]&&rt.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}});var jn=rt,Fn={},In,qn,Rn,Un,zn,Wn,Xn,Vn,$n,Jn=W.createElement("div");Jn.setAttribute("className","t"),Jn.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",In=Jn.getElementsByTagName("*")||[];if((qn=Jn.getElementsByTagName("a")[0])&&qn.style&&In.length){Un=W.createElement("select"),Wn=Un.appendChild(W.createElement("option")),Rn=Jn.getElementsByTagName("input")[0],qn.style.cssText="top:1px;float:left;opacity:.5",Fn.getSetAttribute="t"!==Jn.className,Fn.leadingWhitespace=3===Jn.firstChild.nodeType,Fn.tbody=!Jn.getElementsByTagName("tbody").length,Fn.htmlSerialize=!!Jn.getElementsByTagName("link").length,Fn.style=/top/.test(qn.getAttribute("style")),Fn.hrefNormalized="/a"===qn.getAttribute("href"),Fn.opacity=/^0.5/.test(qn.style.opacity),Fn.cssFloat=!!qn.style.cssFloat,Fn.checkOn=!!Rn.value,Fn.optSelected=Wn.selected,Fn.enctype=!!W.createElement("form").enctype,Fn.html5Clone="<:nav></:nav>"!==W.createElement("nav").cloneNode(!0).outerHTML,Fn.inlineBlockNeedsLayout=!1,Fn.shrinkWrapBlocks=!1,Fn.pixelPosition=!1,Fn.deleteExpando=!0,Fn.noCloneEvent=!0,Fn.reliableMarginRight=!0,Fn.boxSizingReliable=!0,Rn.checked=!0,Fn.noCloneChecked=Rn.cloneNode(!0).checked,Un.disabled=!0,Fn.optDisabled=!Wn.disabled;try{delete Jn.test}catch(Kn){Fn.deleteExpando=!1}Rn=W.createElement("input"),Rn.setAttribute("value",""),Fn.input=""===Rn.getAttribute("value"),Rn.value="t",Rn.setAttribute("type","radio"),Fn.radioValue="t"===Rn.value,Rn.setAttribute("checked","t"),Rn.setAttribute("name","t"),zn=W.createDocumentFragment(),zn.appendChild(Rn),Fn.appendChecked=Rn.checked,Fn.checkClone=zn.cloneNode(!0).cloneNode(!0).lastChild.checked,Jn.attachEvent&&(Jn.attachEvent("onclick",function(){Fn.noCloneEvent=!1}),Jn.cloneNode(!0).click());for($n in{submit:!0,change:!0,focusin:!0})Jn.setAttribute(Xn="on"+$n,"t"),Fn[$n+"Bubbles"]=Xn in e||!1===Jn.attributes[Xn].expando;Jn.style.backgroundClip="content-box",Jn.cloneNode(!0).style.backgroundClip="",Fn.clearCloneStyle="content-box"===Jn.style.backgroundClip;for($n in rt(Fn))break;Fn.ownLast="0"!==$n,rt(function(){var t,n,r=W.getElementsByTagName("body")[0];r&&(t=W.createElement("div"),t.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",r.appendChild(t).appendChild(Jn),Jn.innerHTML="<table><tr><td></td><td>t</td></tr></table>",n=Jn.getElementsByTagName("td"),n[0].style.cssText="padding:0;margin:0;border:0;display:none",Vn=0===n[0].offsetHeight,n[0].style.display="",n[1].style.display="none",Fn.reliableHiddenOffsets=Vn&&0===n[0].offsetHeight,Jn.innerHTML="",Jn.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",rt.swap(r,null!=r.style.zoom?{zoom:1}:{},function(){Fn.boxSizing=4===Jn.offsetWidth}),e.getComputedStyle&&(Fn.pixelPosition="1%"!==(e.getComputedStyle(Jn,null)||{}).top,Fn.boxSizingReliable="4px"===(e.getComputedStyle(Jn,null)||{width:"4px"}).width,n=Jn.appendChild(W.createElement("div")),n.style.cssText=Jn.style.cssText="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",n.style.marginRight=n.style.width="0",Jn.style.width="1px",Fn.reliableMarginRight=!parseFloat((e.getComputedStyle(n,null)||{}).marginRight)),typeof Jn.style.zoom!==U&&(Jn.innerHTML="",Jn.style.cssText="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;width:1px;padding:1px;display:inline;zoom:1",Fn.inlineBlockNeedsLayout=3===Jn.offsetWidth,Jn.style.display="block",Jn.innerHTML="<div></div>",Jn.firstChild.style.width="5px",Fn.shrinkWrapBlocks=3!==Jn.offsetWidth,Fn.inlineBlockNeedsLayout&&(r.style.zoom=1)),r.removeChild(t),t=Jn=n=n=null)}),In=Un=zn=Wn=qn=Rn=null}jn.support=Fn;var Qn=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Gn=/([A-Z])/g;rt.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?rt.cache[e[rt.expando]]:e[rt.expando],!!e&&!u(e)},data:function(e,t,n){return i(e,t,n)},removeData:function(e,t){return s(e,t)},_data:function(e,t,n){return i(e,t,n,!0)},_removeData:function(e,t){return s(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&rt.noData[e.nodeName.toLowerCase()];return!t||!0!==t&&e.getAttribute("classid")===t}}),rt.fn.extend({data:function(e,t){var r,i,s=null,u=0,a=this[0];if(e===n){if(this.length&&(s=rt.data(a),1===a.nodeType&&!rt._data(a,"parsedAttrs"))){for(r=a.attributes;u<r.length;u++)i=r[u].name,0===i.indexOf("data-")&&(i=rt.camelCase(i.slice(5)),o(a,i,s[i]));rt._data(a,"parsedAttrs",!0)}return s}return"object"==typeof e?this.each(function(){rt.data(this,e)}):1<arguments.length?this.each(function(){rt.data(this,e,t)}):a?o(a,e,rt.data(a,e)):null},removeData:function(e){return this.each(function(){rt.removeData(this,e)})}}),rt.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=rt._data(e,t),n&&(!r||rt.isArray(n)?r=rt._data(e,t,rt.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=rt.queue(e,t),r=n.length,i=n.shift(),s=rt._queueHooks(e,t),o=function(){rt.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return rt._data(e,n)||rt._data(e,n,{empty:rt.Callbacks("once memory").add(function(){rt._removeData(e,t+"queue"),rt._removeData(e,n)})})}}),rt.fn.extend({queue:function(e,t){var r=2;return"string"!=typeof e&&(t=e,e="fx",r--),arguments.length<r?rt.queue(this[0],e):t===n?this:this.each(function(){var n=rt.queue(this,e,t);rt._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&rt.dequeue(this,e)})},dequeue:function(e){return this.each(function(){rt.dequeue(this,e)})},delay:function(e,t){return e=rt.fx?rt.fx.speeds[e]||e:e,this.queue(t||"fx",function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var r,i=1,s=rt.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=n);for(e=e||"fx";u--;)(r=rt._data(o[u],e+"queueHooks"))&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(t)}});var Yn,Zn,er=/[\t\r\n\f]/g,tr=/\r/g,nr=/^(?:input|select|textarea|button|object)$/i,rr=/^(?:a|area)$/i,ir=/^(?:checked|selected)$/i,sr=rt.support.getSetAttribute,or=rt.support.input;rt.fn.extend({attr:function(e,t){return rt.access(this,rt.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){rt.removeAttr(this,e)})},prop:function(e,t){return rt.access(this,rt.prop,e,t,1<arguments.length)},removeProp:function(e){return e=rt.propFix[e]||e,this.each(function(){try{this[e]=n,delete this[e]}catch(t){}})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length;t="string"==typeof e&&e;if(rt.isFunction(e))return this.each(function(t){rt(this).addClass(e.call(this,t,this.className))});if(t)for(t=(e||"").match(st)||[];o<u;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(er," "):" ")){for(s=0;i=t[s++];)0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=rt.trim(r)}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length;t=0===arguments.length||"string"==typeof e&&e;if(rt.isFunction(e))return this.each(function(t){rt(this).removeClass(e.call(this,t,this.className))});if(t)for(t=(e||"").match(st)||[];o<u;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(er," "):"")){for(s=0;i=t[s++];)for(;0<=r.indexOf(" "+i+" ");)r=r.replace(" "+i+" "," ");n.className=e?rt.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):rt.isFunction(e)?this.each(function(n){rt(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n)for(var t,r=0,i=rt(this),s=e.match(st)||[];t=s[r++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else if(n===U||"boolean"===n)this.className&&rt._data(this,"__className__",this.className),this.className=this.className||!1===e?"":rt._data(this,"__className__")||""})},hasClass:function(e){e=" "+e+" ";for(var t=0,n=this.length;t<n;t++)if(1===this[t].nodeType&&0<=(" "+this[t].className+" ").replace(er," ").indexOf(e))return!0;return!1},val:function(e){var t,r,i,s=this[0];if(arguments.length)return i=rt.isFunction(e),this.each(function(t){1===this.nodeType&&(t=i?e.call(this,t,rt(this).val()):e,null==t?t="":"number"==typeof t?t+="":rt.isArray(t)&&(t=rt.map(t,function(e){return null==e?"":e+""})),r=rt.valHooks[this.type]||rt.valHooks[this.nodeName.toLowerCase()],!r||!("set"in r)||r.set(this,t,"value")===n)&&(this.value=t)});if(s)return(r=rt.valHooks[s.type]||rt.valHooks[s.nodeName.toLowerCase()])&&"get"in r&&(t=r.get(s,"value"))!==n?t:(t=s.value,"string"==typeof t?t.replace(tr,""):null==t?"":t)}}),rt.extend({valHooks:{option:{get:function(e){var t=rt.find.attr(e,"value");return null!=t?t:e.text}},select:{get:function(e){for(var t,n=e.options,r=e.selectedIndex,i=(e="select-one"===e.type||0>r)?null:[],s=e?r+1:n.length,o=0>r?s:e?r:0;o<s;o++)if(t=n[o],(t.selected||o===r)&&(rt.support.optDisabled?!t.disabled:null===t.getAttribute("disabled"))&&(!t.parentNode.disabled||!rt.nodeName(t.parentNode,"optgroup"))){t=rt(t).val();if(e)return t;i.push(t)}return i},set:function(e,t){for(var n,r,i=e.options,s=rt.makeArray(t),o=i.length;o--;)if(r=i[o],r.selected=0<=rt.inArray(rt(r).val(),s))n=!0;return n||(e.selectedIndex=-1),s}}},attr:function(e,t,r){var i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o){if(typeof e.getAttribute===U)return rt.prop(e,t,r);if(1!==o||!rt.isXMLDoc(e))t=t.toLowerCase(),i=rt.attrHooks[t]||(rt.expr.match.bool.test(t)?Zn:Yn);if(r===n)return i&&"get"in i&&null!==(s=i.get(e,t))?s:(s=rt.find.attr(e,t),null==s?n:s);if(null!==r)return i&&"set"in i&&(s=i.set(e,r,t))!==n?s:(e.setAttribute(t,r+""),r);rt.removeAttr(e,t)}},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(st);if(s&&1===e.nodeType)for(;n=s[i++];)r=rt.propFix[n]||n,rt.expr.match.bool.test(n)?or&&sr||!ir.test(n)?e[r]=!1:e[rt.camelCase("default-"+n)]=e[r]=!1:rt.attr(e,n,""),e.removeAttribute(sr?n:r)},attrHooks:{type:{set:function(e,t){if(!rt.support.radioValue&&"radio"===t&&rt.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,r){var i,s,o;o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o){if(o=1!==o||!rt.isXMLDoc(e))t=rt.propFix[t]||t,s=rt.propHooks[t];return r!==n?s&&"set"in s&&(i=s.set(e,r,t))!==n?i:e[t]=r:s&&"get"in s&&null!==(i=s.get(e,t))?i:e[t]}},propHooks:{tabIndex:{get:function(e){var t=rt.find.attr(e,"tabindex");return t?parseInt(t,10):nr.test(e.nodeName)||rr.test(e.nodeName)&&e.href?0:-1}}}}),Zn={set:function(e,t,n){return!1===t?rt.removeAttr(e,n):or&&sr||!ir.test(n)?e.setAttribute(!sr&&rt.propFix[n]||n,n):e[rt.camelCase("default-"+n)]=e[n]=!0,n}},rt.each(rt.expr.match.bool.source.match(/\w+/g),function(e,t){var r=rt.expr.attrHandle[t]||rt.find.attr;rt.expr.attrHandle[t]=or&&sr||!ir.test(t)?function(e,t,i){var s=rt.expr.attrHandle[t];return e=i?n:(rt.expr.attrHandle[t]=n)!=r(e,t,i)?t.toLowerCase():null,rt.expr.attrHandle[t]=s,e}:function(e,t,r){return r?n:e[rt.camelCase("default-"+t)]?t.toLowerCase():null}});if(!or||!sr)rt.attrHooks.value={set:function(e,t,n){if(!rt.nodeName(e,"input"))return Yn&&Yn.set(e,t,n);e.defaultValue=t}};sr||(Yn={set:function(e,t,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=t+="","value"===r||t===e.getAttribute(r)?t:n}},rt.expr.attrHandle.id=rt.expr.attrHandle.name=rt.expr.attrHandle.coords=function(e,t,r){var i;return r?n:(i=e.getAttributeNode(t))&&""!==i.value?i.value:null},rt.valHooks.button={get:function(e,t){var r=e.getAttributeNode(t);return r&&r.specified?r.value:n},set:Yn.set},rt.attrHooks.contenteditable={set:function(e,t,n){Yn.set(e,""===t?!1:t,n)}},rt.each(["width","height"],function(e,t){rt.attrHooks[t]={set:function(e,n){if(""===n)return e.setAttribute(t,"auto"),n}}})),rt.support.hrefNormalized||rt.each(["href","src"],function(e,t){rt.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),rt.support.style||(rt.attrHooks.style={get:function(e){return e.style.cssText||n},set:function(e,t){return e.style.cssText=t+""}}),rt.support.optSelected||(rt.propHooks.selected={get:function(e){if(e=e.parentNode)e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex;return null}}),rt.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){rt.propFix[this.toLowerCase()]=this}),rt.support.enctype||(rt.propFix.enctype="encoding"),rt.each(["radio","checkbox"],function(){rt.valHooks[this]={set:function(e,t){if(rt.isArray(t))return e.checked=0<=rt.inArray(rt(e).val(),t)}},rt.support.checkOn||(rt.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var ur=/^(?:input|select|textarea)$/i,ar=/^key/,fr=/^(?:mouse|contextmenu)|click/,lr=/^(?:focusinfocus|focusoutblur)$/,cr=/^([^.]*)(?:\.(.+)|)$/;rt.event={global:{},add:function(e,t,r,i,s){var o,u,a,f,l,c,h,p,d;if(a=rt._data(e)){r.handler&&(f=r,r=f.handler,s=f.selector),r.guid||(r.guid=rt.guid++),(u=a.events)||(u=a.events={}),(l=a.handle)||(l=a.handle=function(e){return typeof rt===U||!!e&&rt.event.triggered===e.type?n:rt.event.dispatch.apply(l.elem,arguments)},l.elem=e),t=(t||"").match(st)||[""];for(a=t.length;a--;)if(o=cr.exec(t[a])||[],p=c=o[1],d=(o[2]||"").split(".").sort(),p)o=rt.event.special[p]||{},p=(s?o.delegateType:o.bindType)||p,o=rt.event.special[p]||{},c=rt.extend({type:p,origType:c,data:i,handler:r,guid:r.guid,selector:s,needsContext:s&&rt.expr.match.needsContext.test(s),namespace:d.join(".")},f),!(h=u[p])&&(h=u[p]=[],h.delegateCount=0,!o.setup||!1===o.setup.call(e,i,d,l))&&(e.addEventListener?e.addEventListener(p,l,!1):e.attachEvent&&e.attachEvent("on"+p,l)),o.add&&(o.add.call(e,c),c.handler.guid||(c.handler.guid=r.guid)),s?h.splice(h.delegateCount++,0,c):h.push(c),rt.event.global[p]=!0;e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=rt.hasData(e)&&rt._data(e);if(m&&(l=m.events)){t=(t||"").match(st)||[""];for(f=t.length;f--;)if(u=cr.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort(),p){c=rt.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=l[p]||[],u=u[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)");for(a=s=h.length;s--;)if(o=h[s],(i||v===o.origType)&&(!n||n.guid===o.guid)&&(!u||u.test(o.namespace))&&(!r||r===o.selector||"**"===r&&o.selector))h.splice(s,1),o.selector&&h.delegateCount--,c.remove&&c.remove.call(e,o);a&&!h.length&&((!c.teardown||!1===c.teardown.call(e,d,m.handle))&&rt.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)rt.event.remove(e,p+t[f],n,r,!0);rt.isEmptyObject(l)&&(delete m.handle,rt._removeData(e,"events"))}},trigger:function(t,r,i,s){var o,u,a,f,l,c,h=[i||W],p=tt.call(t,"type")?t.type:t;l=tt.call(t,"namespace")?t.namespace.split("."):[],a=o=i=i||W;if(3!==i.nodeType&&8!==i.nodeType&&!lr.test(p+rt.event.triggered))if(0<=p.indexOf(".")&&(l=p.split("."),p=l.shift(),l.sort()),u=0>p.indexOf(":")&&"on"+p,t=t[rt.expando]?t:new rt.Event(p,"object"==typeof t&&t),t.isTrigger=s?2:3,t.namespace=l.join("."),t.namespace_re=t.namespace?RegExp("(^|\\.)"+l.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=n,t.target||(t.target=i),r=null==r?[t]:rt.makeArray(r,[t]),l=rt.event.special[p]||{},s||!l.trigger||!1!==l.trigger.apply(i,r)){if(!s&&!l.noBubble&&!rt.isWindow(i)){f=l.delegateType||p,lr.test(f+p)||(a=a.parentNode);for(;a;a=a.parentNode)h.push(a),o=a;o===(i.ownerDocument||W)&&h.push(o.defaultView||o.parentWindow||e)}for(c=0;(a=h[c++])&&!t.isPropagationStopped();)t.type=1<c?f:l.bindType||p,(o=(rt._data(a,"events")||{})[t.type]&&rt._data(a,"handle"))&&o.apply(a,r),(o=u&&a[u])&&rt.acceptData(a)&&o.apply&&!1===o.apply(a,r)&&t.preventDefault();t.type=p;if(!s&&!t.isDefaultPrevented()&&(!l._default||!1===l._default.apply(h.pop(),r))&&rt.acceptData(i)&&u&&i[p]&&!rt.isWindow(i)){(o=i[u])&&(i[u]=null),rt.event.triggered=p;try{i[p]()}catch(d){}rt.event.triggered=n,o&&(i[u]=o)}return t.result}},dispatch:function(e){e=rt.event.fix(e);var t,r,i,s,o=[],u=Y.call(arguments);t=(rt._data(this,"events")||{})[e.type]||[];var a=rt.event.special[e.type]||{};u[0]=e,e.delegateTarget=this;if(!a.preDispatch||!1!==a.preDispatch.call(this,e)){o=rt.event.handlers.call(this,e,t);for(t=0;(i=o[t++])&&!e.isPropagationStopped();){e.currentTarget=i.elem;for(s=0;(r=i.handlers[s++])&&!e.isImmediatePropagationStopped();)if(!e.namespace_re||e.namespace_re.test(r.namespace))if(e.handleObj=r,e.data=r.data,r=((rt.event.special[r.origType]||{}).handle||r.handler).apply(i.elem,u),r!==n&&!1===(e.result=r))e.preventDefault(),e.stopPropagation()}return a.postDispatch&&a.postDispatch.call(this,e),e.result}},handlers:function(e,t){var r,i,s,o,u=[],a=t.delegateCount,f=e.target;if(a&&f.nodeType&&(!e.button||"click"!==e.type))for(;f!=this;f=f.parentNode||this)if(1===f.nodeType&&(!0!==f.disabled||"click"!==e.type)){s=[];for(o=0;o<a;o++)i=t[o],r=i.selector+" ",s[r]===n&&(s[r]=i.needsContext?0<=rt(r,this).index(f):rt.find(r,this,null,[f]).length),s[r]&&s.push(i);s.length&&u.push({elem:f,handlers:s})}return a<t.length&&u.push({elem:this,handlers:t.slice(a)}),u},fix:function(e){if(e[rt.expando])return e;var t,n,r;t=e.type;var i=e,s=this.fixHooks[t];s||(this.fixHooks[t]=s=fr.test(t)?this.mouseHooks:ar.test(t)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new rt.Event(i);for(t=r.length;t--;)n=r[t],e[n]=i[n];return e.target||(e.target=i.srcElement||W),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,i):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var r,i,s=t.button,o=t.fromElement;return null==e.pageX&&null!=t.clientX&&(r=e.target.ownerDocument||W,i=r.documentElement,r=r.body,e.pageX=t.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&o&&(e.relatedTarget=o===e.target?t.toElement:o),!e.which&&s!==n&&(e.which=s&1?1:s&2?3:s&4?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==l()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===l()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(rt.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return rt.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==n&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){e=rt.extend(new rt.Event,n,{type:e,isSimulated:!0,originalEvent:{}}),r?rt.event.trigger(e,null,t):rt.event.dispatch.call(t,e),e.isDefaultPrevented()&&n.preventDefault()}},rt.removeEvent=W.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){t="on"+t,e.detachEvent&&(typeof e[t]===U&&(e[t]=null),e.detachEvent(t,n))},rt.Event=function(e,t){if(!(this instanceof rt.Event))return new rt.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||!1===e.returnValue||e.getPreventDefault&&e.getPreventDefault()?a:f):this.type=e,t&&rt.extend(this,t),this.timeStamp=e&&e.timeStamp||rt.now(),this[rt.expando]=!0},rt.Event.prototype={isDefaultPrevented:f,isPropagationStopped:f,isImmediatePropagationStopped:f,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=a,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=a,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=a,this.stopPropagation()}},rt.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){rt.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=e.relatedTarget,i=e.handleObj;if(!r||r!==this&&!rt.contains(this,r))e.type=i.origType,n=i.handler.apply(this,arguments),e.type=t;return n}}}),rt.support.submitBubbles||(rt.event.special.submit={setup:function(){if(rt.nodeName(this,"form"))return!1;rt.event.add(this,"click._submit keypress._submit",function(e){e=e.target,(e=rt.nodeName(e,"input")||rt.nodeName(e,"button")?e.form:n)&&!rt._data(e,"submitBubbles")&&(rt.event.add(e,"submit._submit",function(e){e._submit_bubble=!0}),rt._data(e,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&rt.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(rt.nodeName(this,"form"))return!1;rt.event.remove(this,"._submit")}}),rt.support.changeBubbles||(rt.event.special.change={setup:function(){if(ur.test(this.nodeName)){if("checkbox"===this.type||"radio"===this.type)rt.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),rt.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),rt.event.simulate("change",this,e,!0)});return!1}rt.event.add(this,"beforeactivate._change",function(e){e=e.target,ur.test(e.nodeName)&&!rt._data(e,"changeBubbles")&&(rt.event.add(e,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&rt.event.simulate("change",this.parentNode,e,!0)}),rt._data(e,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return rt.event.remove(this,"._change"),!ur.test(this.nodeName)}}),rt.support.focusinBubbles||rt.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){rt.event.simulate(t,e.target,rt.event.fix(e),!0)};rt.event.special[t]={setup:function(){0===n++&&W.addEventListener(e,r,!0)},teardown:function(){0===--n&&W.removeEventListener(e,r,!0)}}}),rt.fn.extend({on:function(e,t,r,i,s){var o,u;if("object"==typeof e){"string"!=typeof t&&(r=r||t,t=n);for(o in e)this.on(o,t,r,e[o],s);return this}null==r&&null==i?(i=t,r=t=n):null==i&&("string"==typeof t?(i=r,r=n):(i=r,r=t,t=n));if(!1===i)i=f;else if(!i)return this;return 1===s&&(u=i,i=function(e){return rt().off(e),u.apply(this,arguments)},i.guid=u.guid||(u.guid=rt.guid++)),this.each(function(){rt.event.add(this,e,i,r,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,r){var i;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,rt(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}if(!1===t||"function"==typeof t)r=t,t=n;return!1===r&&(r=f),this.each(function(){rt.event.remove(this,e,r,t)})},trigger:function(e,t){return this.each(function(){rt.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return rt.event.trigger(e,t,n,!0)}});var hr=/^.[^:#\[\.,]*$/,pr=/^(?:parents|prev(?:Until|All))/,dr=rt.expr.match.needsContext,vr={children:!0,contents:!0,next:!0,prev:!0};rt.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(rt(e).filter(function(){for(t=0;t<i;t++)if(rt.contains(r[t],this))return!0}));for(t=0;t<i;t++)rt.find(e,r[t],n);return n=this.pushStack(1<i?rt.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t,n=rt(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(rt.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(h(this,e||[],!0))},filter:function(e){return this.pushStack(h(this,e||[],!1))},is:function(e){return!!h(this,"string"==typeof e&&dr.test(e)?rt(e):e||[],!1).length},closest:function(e,t){for(var n,r=0,i=this.length,s=[],o=dr.test(e)||"string"!=typeof e?rt(e,t||this.context):0;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(o?-1<o.index(n):1===n.nodeType&&rt.find.matchesSelector(n,e))){s.push(n);break}return this.pushStack(1<s.length?rt.unique(s):s)},index:function(e){return e?"string"==typeof e?rt.inArray(this[0],rt(e)):rt.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?rt(e,t):rt.makeArray(e&&e.nodeType?[e]:e),n=rt.merge(this.get(),n);return this.pushStack(rt.unique(n))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),rt.each({parent:function(e){return(e=e.parentNode)&&11!==e.nodeType?e:null},parents:function(e){return rt.dir(e,"parentNode")},parentsUntil:function(e,t,n){return rt.dir(e,"parentNode",n)},next:function(e){return c(e,"nextSibling")},prev:function(e){return c(e,"previousSibling")},nextAll:function(e){return rt.dir(e,"nextSibling")},prevAll:function(e){return rt.dir(e,"previousSibling")},nextUntil:function(e,t,n){return rt.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return rt.dir(e,"previousSibling",n)},siblings:function(e){return rt.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return rt.sibling(e.firstChild)},contents:function(e){return rt.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:rt.merge([],e.childNodes)}},function(e,t){rt.fn[e]=function(n,r){var i=rt.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=rt.filter(r,i)),1<this.length&&(vr[e]||(i=rt.unique(i)),pr.test(e)&&(i=i.reverse())),this.pushStack(i)}}),rt.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?rt.find.matchesSelector(r,e)?[r]:[]:rt.find.matches(e,rt.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,t,r){var i=[];for(e=e[t];e&&9!==e.nodeType&&(r===n||1!==e.nodeType||!rt(e).is(r));)1===e.nodeType&&i.push(e),e=e[t];return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var mr="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gr=/ jQuery\d+="(?:null|\d+)"/g,yr=RegExp("<(?:"+mr+")[\\s/>]","i"),br=/^\s+/,wr=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Er=/<([\w:]+)/,Sr=/<tbody/i,xr=/<|&#?\w+;/,Tr=/<(?:script|style|link)/i,Nr=/^(?:checkbox|radio)$/i,Cr=/checked\s*(?:[^=]|=\s*.checked.)/i,kr=/^$|\/(?:java|ecma)script/i,Lr=/^true\/(.*)/,Ar=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Or={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>"
,"</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:rt.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},Mr=p(W).appendChild(W.createElement("div"));Or.optgroup=Or.option,Or.tbody=Or.tfoot=Or.colgroup=Or.caption=Or.thead,Or.th=Or.td,rt.fn.extend({text:function(e){return rt.access(this,function(e){return e===n?rt.text(this):this.empty().append((this[0]&&this[0].ownerDocument||W).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&d(this,e).appendChild(e)})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=d(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,r=e?rt.filter(e,this):this,i=0;null!=(n=r[i]);i++)!t&&1===n.nodeType&&rt.cleanData(b(n)),n.parentNode&&(t&&rt.contains(n.ownerDocument,n)&&g(b(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&rt.cleanData(b(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&rt.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return rt.clone(this,e,t)})},html:function(e){return rt.access(this,function(e){var t=this[0]||{},r=0,i=this.length;if(e===n)return 1===t.nodeType?t.innerHTML.replace(gr,""):n;if("string"==typeof e&&!Tr.test(e)&&(rt.support.htmlSerialize||!yr.test(e))&&(rt.support.leadingWhitespace||!br.test(e))&&!Or[(Er.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(wr,"<$1></$2>");try{for(;r<i;r++)t=this[r]||{},1===t.nodeType&&(rt.cleanData(b(t,!1)),t.innerHTML=e);t=0}catch(s){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=rt.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),rt(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=Q.apply([],e);var r,i,s,o,u=0,a=this.length,f=this,l=a-1,c=e[0],h=rt.isFunction(c);if(h||!(1>=a||"string"!=typeof c||rt.support.checkClone||!Cr.test(c)))return this.each(function(r){var i=f.eq(r);h&&(e[0]=c.call(this,r,i.html())),i.domManip(e,t,n)});if(a&&(o=rt.buildFragment(e,this[0].ownerDocument,!1,!n&&this),r=o.firstChild,1===o.childNodes.length&&(o=r),r)){s=rt.map(b(o,"script"),v);for(i=s.length;u<a;u++)r=o,u!==l&&(r=rt.clone(r,!0,!0),i&&rt.merge(s,b(r,"script"))),t.call(this[u],r,u);if(i){o=s[s.length-1].ownerDocument,rt.map(s,m);for(u=0;u<i;u++)if(r=s[u],kr.test(r.type||"")&&!rt._data(r,"globalEval")&&rt.contains(o,r))r.src?rt._evalUrl(r.src):rt.globalEval((r.text||r.textContent||r.innerHTML||"").replace(Ar,""))}o=r=null}return this}}),rt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){rt.fn[e]=function(e){for(var n=0,r=[],i=rt(e),s=i.length-1;n<=s;n++)e=n===s?this:this.clone(!0),rt(i[n])[t](e),G.apply(r,e.get());return this.pushStack(r)}}),rt.extend({clone:function(e,t,n){var r,i,s,o,u,a=rt.contains(e.ownerDocument,e);rt.support.html5Clone||rt.isXMLDoc(e)||!yr.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(Mr.innerHTML=e.outerHTML,Mr.removeChild(s=Mr.firstChild));if((!rt.support.noCloneEvent||!rt.support.noCloneChecked)&&(1===e.nodeType||11===e.nodeType)&&!rt.isXMLDoc(e)){r=b(s),u=b(e);for(o=0;null!=(i=u[o]);++o)if(r[o]){var f=r[o],l=void 0,c=void 0,h=void 0;if(1===f.nodeType){l=f.nodeName.toLowerCase();if(!rt.support.noCloneEvent&&f[rt.expando]){h=rt._data(f);for(c in h.events)rt.removeEvent(f,c,h.handle);f.removeAttribute(rt.expando)}if("script"===l&&f.text!==i.text)v(f).text=i.text,m(f);else if("object"===l)f.parentNode&&(f.outerHTML=i.outerHTML),rt.support.html5Clone&&i.innerHTML&&!rt.trim(f.innerHTML)&&(f.innerHTML=i.innerHTML);else if("input"===l&&Nr.test(i.type))f.defaultChecked=f.checked=i.checked,f.value!==i.value&&(f.value=i.value);else if("option"===l)f.defaultSelected=f.selected=i.defaultSelected;else if("input"===l||"textarea"===l)f.defaultValue=i.defaultValue}}}if(t)if(n){u=u||b(e),r=r||b(s);for(o=0;null!=(i=u[o]);o++)y(i,r[o])}else y(e,s);return r=b(s,"script"),0<r.length&&g(r,!a&&b(e,"script")),s},buildFragment:function(e,t,n,r){for(var i,s,o,u,a,f,l=e.length,c=p(t),h=[],d=0;d<l;d++)if((s=e[d])||0===s)if("object"===rt.type(s))rt.merge(h,s.nodeType?[s]:s);else if(xr.test(s)){o=o||c.appendChild(t.createElement("div")),u=(Er.exec(s)||["",""])[1].toLowerCase(),f=Or[u]||Or._default,o.innerHTML=f[1]+s.replace(wr,"<$1></$2>")+f[2];for(i=f[0];i--;)o=o.lastChild;!rt.support.leadingWhitespace&&br.test(s)&&h.push(t.createTextNode(br.exec(s)[0]));if(!rt.support.tbody)for(i=(s="table"===u&&!Sr.test(s)?o.firstChild:"<table>"===f[1]&&!Sr.test(s)?o:0)&&s.childNodes.length;i--;)rt.nodeName(a=s.childNodes[i],"tbody")&&!a.childNodes.length&&s.removeChild(a);rt.merge(h,o.childNodes);for(o.textContent="";o.firstChild;)o.removeChild(o.firstChild);o=c.lastChild}else h.push(t.createTextNode(s));o&&c.removeChild(o),rt.support.appendChecked||rt.grep(b(h,"input"),w);for(d=0;s=h[d++];)if((!r||-1===rt.inArray(s,r))&&(e=rt.contains(s.ownerDocument,s),o=b(c.appendChild(s),"script"),e&&g(o),n))for(i=0;s=o[i++];)kr.test(s.type||"")&&n.push(s);return c},cleanData:function(e,t){for(var n,r,i,s,o=0,u=rt.expando,a=rt.cache,f=rt.support.deleteExpando,l=rt.event.special;null!=(n=e[o]);o++)if(t||rt.acceptData(n))if(s=(i=n[u])&&a[i]){if(s.events)for(r in s.events)l[r]?rt.event.remove(n,r):rt.removeEvent(n,r,s.handle);a[i]&&(delete a[i],f?delete n[u]:typeof n.removeAttribute!==U?n.removeAttribute(u):n[u]=null,K.push(i))}},_evalUrl:function(e){return rt.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),rt.fn.extend({wrapAll:function(e){if(rt.isFunction(e))return this.each(function(t){rt(this).wrapAll(e.call(this,t))});if(this[0]){var t=rt(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return rt.isFunction(e)?this.each(function(t){rt(this).wrapInner(e.call(this,t))}):this.each(function(){var t=rt(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=rt.isFunction(e);return this.each(function(n){rt(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){rt.nodeName(this,"body")||rt(this).replaceWith(this.childNodes)}).end()}});var _r,Dr,Pr,Hr=/alpha\([^)]*\)/i,Br=/opacity\s*=\s*([^)]*)/,jr=/^(top|right|bottom|left)$/,Fr=/^(none|table(?!-c[ea]).+)/,Ir=/^margin/,qr=RegExp("^("+it+")(.*)$","i"),Rr=RegExp("^("+it+")(?!px)[a-z%]+$","i"),Ur=RegExp("^([+-])=("+it+")","i"),zr={BODY:"block"},Wr={position:"absolute",visibility:"hidden",display:"block"},Xr={letterSpacing:0,fontWeight:400},Vr=["Top","Right","Bottom","Left"],$r=["Webkit","O","Moz","ms"];rt.fn.extend({css:function(e,t){return rt.access(this,function(e,t,r){var i,s={},o=0;if(rt.isArray(t)){i=Dr(e);for(r=t.length;o<r;o++)s[t[o]]=rt.css(e,t[o],!1,i);return s}return r!==n?rt.style(e,t,r):rt.css(e,t)},e,t,1<arguments.length)},show:function(){return x(this,!0)},hide:function(){return x(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){S(this)?rt(this).show():rt(this).hide()})}}),rt.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Pr(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":rt.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&!!e.style){var s,o,u,a=rt.camelCase(t),f=e.style;t=rt.cssProps[a]||(rt.cssProps[a]=E(f,a)),u=rt.cssHooks[t]||rt.cssHooks[a];if(r===n)return u&&"get"in u&&(s=u.get(e,!1,i))!==n?s:f[t];o=typeof r,"string"===o&&(s=Ur.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(rt.css(e,t)),o="number");if(!(null==r||"number"===o&&isNaN(r)))if("number"===o&&!rt.cssNumber[a]&&(r+="px"),!rt.support.clearCloneStyle&&""===r&&0===t.indexOf("background")&&(f[t]="inherit"),!u||!("set"in u)||(r=u.set(e,r,i))!==n)try{f[t]=r}catch(l){}}},css:function(e,t,r,i){var s,o;return o=rt.camelCase(t),t=rt.cssProps[o]||(rt.cssProps[o]=E(e.style,o)),(o=rt.cssHooks[t]||rt.cssHooks[o])&&"get"in o&&(s=o.get(e,!0,r)),s===n&&(s=Pr(e,t,i)),"normal"===s&&t in Xr&&(s=Xr[t]),""===r||r?(e=parseFloat(s),!0===r||rt.isNumeric(e)?e||0:s):s}}),e.getComputedStyle?(Dr=function(t){return e.getComputedStyle(t,null)},Pr=function(e,t,r){var i,s=(r=r||Dr(e))?r.getPropertyValue(t)||r[t]:n,o=e.style;return r&&(""===s&&!rt.contains(e.ownerDocument,e)&&(s=rt.style(e,t)),Rr.test(s)&&Ir.test(t)&&(e=o.width,t=o.minWidth,i=o.maxWidth,o.minWidth=o.maxWidth=o.width=s,s=r.width,o.width=e,o.minWidth=t,o.maxWidth=i)),s}):W.documentElement.currentStyle&&(Dr=function(e){return e.currentStyle},Pr=function(e,t,r){var i,s,o=(r=r||Dr(e))?r[t]:n,u=e.style;null==o&&u&&u[t]&&(o=u[t]);if(Rr.test(o)&&!jr.test(t)){r=u.left;if(s=(i=e.runtimeStyle)&&i.left)i.left=e.currentStyle.left;u.left="fontSize"===t?"1em":o,o=u.pixelLeft+"px",u.left=r,s&&(i.left=s)}return""===o?"auto":o}),rt.each(["height","width"],function(e,t){rt.cssHooks[t]={get:function(e,n,r){if(n)return 0===e.offsetWidth&&Fr.test(rt.css(e,"display"))?rt.swap(e,Wr,function(){return C(e,t,r)}):C(e,t,r)},set:function(e,n,r){var i=r&&Dr(e);return T(e,n,r?N(e,t,r,rt.support.boxSizing&&"border-box"===rt.css(e,"boxSizing",!1,i),i):0)}}}),rt.support.opacity||(rt.cssHooks.opacity={get:function(e,t){return Br.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=rt.isNumeric(t)?"alpha(opacity="+100*t+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if((1<=t||""===t)&&""===rt.trim(s.replace(Hr,""))&&n.removeAttribute)if(n.removeAttribute("filter"),""===t||r&&!r.filter)return;n.filter=Hr.test(s)?s.replace(Hr,i):s+" "+i}}),rt(function(){rt.support.reliableMarginRight||(rt.cssHooks.marginRight={get:function(e,t){if(t)return rt.swap(e,{display:"inline-block"},Pr,[e,"marginRight"])}}),!rt.support.pixelPosition&&rt.fn.position&&rt.each(["top","left"],function(e,t){rt.cssHooks[t]={get:function(e,n){if(n)return n=Pr(e,t),Rr.test(n)?rt(e).position()[t]+"px":n}}})}),rt.expr&&rt.expr.filters&&(rt.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!rt.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||rt.css(e,"display"))},rt.expr.filters.visible=function(e){return!rt.expr.filters.hidden(e)}),rt.each({margin:"",padding:"",border:"Width"},function(e,t){rt.cssHooks[e+t]={expand:function(n){var r=0,i={};for(n="string"==typeof n?n.split(" "):[n];4>r;r++)i[e+Vr[r]+t]=n[r]||n[r-2]||n[0];return i}},Ir.test(e)||(rt.cssHooks[e+t].set=T)});var Jr=/%20/g,Kr=/\[\]$/,Qr=/\r?\n/g,Gr=/^(?:submit|button|image|reset|file)$/i,Yr=/^(?:input|select|textarea|keygen)/i;rt.fn.extend({serialize:function(){return rt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=rt.prop(this,"elements");return e?rt.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!rt(this).is(":disabled")&&Yr.test(this.nodeName)&&!Gr.test(e)&&(this.checked||!Nr.test(e))}).map(function(e,t){var n=rt(this).val();return null==n?null:rt.isArray(n)?rt.map(n,function(e){return{name:t.name,value:e.replace(Qr,"\r\n")}}):{name:t.name,value:n.replace(Qr,"\r\n")}}).get()}}),rt.param=function(e,t){var r,i=[],s=function(e,t){t=rt.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};t===n&&(t=rt.ajaxSettings&&rt.ajaxSettings.traditional);if(rt.isArray(e)||e.jquery&&!rt.isPlainObject(e))rt.each(e,function(){s(this.name,this.value)});else for(r in e)A(r,e[r],t,s);return i.join("&").replace(Jr,"+")},rt.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){rt.fn[t]=function(e,n){return 0<arguments.length?this.on(t,null,e,n):this.trigger(t)}}),rt.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Zr,ei,ti=rt.now(),ni=/\?/,ri=/#.*$/,ii=/([?&])_=[^&]*/,si=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,oi=/^(?:GET|HEAD)$/,ui=/^\/\//,ai=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,fi=rt.fn.load,li={},ci={},hi="*/".concat("*");try{ei=z.href}catch(pi){ei=W.createElement("a"),ei.href="",ei=ei.href}Zr=ai.exec(ei.toLowerCase())||[],rt.fn.load=function(e,t,r){if("string"!=typeof e&&fi)return fi.apply(this,arguments);var i,s,o,u=this,a=e.indexOf(" ");return 0<=a&&(i=e.slice(a,e.length),e=e.slice(0,a)),rt.isFunction(t)?(r=t,t=n):t&&"object"==typeof t&&(o="POST"),0<u.length&&rt.ajax({url:e,type:o,dataType:"html",data:t}).done(function(e){s=arguments,u.html(i?rt("<div>").append(rt.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){u.each(r,s||[e.responseText,t,e])}),this},rt.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){rt.fn[t]=function(e){return this.on(t,e)}}),rt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ei,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Zr[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":hi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":rt.parseJSON,"text xml":rt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?_(_(e,rt.ajaxSettings),t):_(rt.ajaxSettings,e)},ajaxPrefilter:O(li),ajaxTransport:O(ci),ajax:function(e,t){function r(e,t,r,i){var s,c,y,b;b=t;if(2!==w){w=2,a&&clearTimeout(a),l=n,u=i||"",S.readyState=0<e?4:0,i=200<=e&&300>e||304===e;if(r){y=h;for(var E=S,x,T,N,C,k=y.contents,L=y.dataTypes;"*"===L[0];)L.shift(),T===n&&(T=y.mimeType||E.getResponseHeader("Content-Type"));if(T)for(C in k)if(k[C]&&k[C].test(T)){L.unshift(C);break}if(L[0]in r)N=L[0];else{for(C in r){if(!L[0]||y.converters[C+" "+L[0]]){N=C;break}x||(x=C)}N=N||x}N?(N!==L[0]&&L.unshift(N),y=r[N]):y=void 0}e:{r=h,x=y,T=S,N=i;var A,O,M,E={},k=r.dataTypes.slice();if(k[1])for(O in r.converters)E[O.toLowerCase()]=r.converters[O];for(C=k.shift();C;)if(r.responseFields[C]&&(T[r.responseFields[C]]=x),!M&&N&&r.dataFilter&&(x=r.dataFilter(x,r.dataType)),M=C,C=k.shift())if("*"===C)C=M;else if("*"!==M&&M!==C){O=E[M+" "+C]||E["* "+C];if(!O)for(A in E)if(y=A.split(" "),y[1]===C&&(O=E[M+" "+y[0]]||E["* "+y[0]])){!0===O?O=E[A]:!0!==E[A]&&(C=y[0],k.unshift(y[1]));break}if(!0!==O)if(O&&r["throws"])x=O(x);else try{x=O(x)}catch(_){y={state:"parsererror",error:O?_:"No conversion from "+M+" to "+C};break e}}y={state:"success",data:x}}if(i)h.ifModified&&((b=S.getResponseHeader("Last-Modified"))&&(rt.lastModified[o]=b),(b=S.getResponseHeader("etag"))&&(rt.etag[o]=b)),204===e||"HEAD"===h.type?b="nocontent":304===e?b="notmodified":(b=y.state,s=y.data,c=y.error,i=!c);else if(c=b,e||!b)b="error",0>e&&(e=0);S.status=e,S.statusText=(t||b)+"",i?v.resolveWith(p,[s,b,S]):v.rejectWith(p,[S,b,c]),S.statusCode(g),g=n,f&&d.trigger(i?"ajaxSuccess":"ajaxError",[S,h,i?s:c]),m.fireWith(p,[S,b]),f&&(d.trigger("ajaxComplete",[S,h]),--rt.active||rt.event.trigger("ajaxStop"))}}"object"==typeof e&&(t=e,e=n),t=t||{};var i,s,o,u,a,f,l,c,h=rt.ajaxSetup({},t),p=h.context||h,d=h.context&&(p.nodeType||p.jquery)?rt(p):rt.event,v=rt.Deferred(),m=rt.Callbacks("once memory"),g=h.statusCode||{},y={},b={},w=0,E="canceled",S={readyState:0,getResponseHeader:function(e){var t;if(2===w){if(!c)for(c={};t=si.exec(u);)c[t[1].toLowerCase()]=t[2];t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===w?u:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return w||(e=b[n]=b[n]||e,y[e]=t),this},overrideMimeType:function(e){return w||(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>w)for(t in e)g[t]=[g[t],e[t]];else S.always(e[S.status]);return this},abort:function(e){return e=e||E,l&&l.abort(e),r(0,e),this}};v.promise(S).complete=m.add,S.success=S.done,S.error=S.fail,h.url=((e||h.url||ei)+"").replace(ri,"").replace(ui,Zr[1]+"//"),h.type=t.method||t.type||h.method||h.type,h.dataTypes=rt.trim(h.dataType||"*").toLowerCase().match(st)||[""],null==h.crossDomain&&(i=ai.exec(h.url.toLowerCase()),h.crossDomain=!(!i||i[1]===Zr[1]&&i[2]===Zr[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(Zr[3]||("http:"===Zr[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=rt.param(h.data,h.traditional)),M(li,h,t,S);if(2===w)return S;(f=h.global)&&0===rt.active++&&rt.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!oi.test(h.type),o=h.url,h.hasContent||(h.data&&(o=h.url+=(ni.test(o)?"&":"?")+h.data,delete h.data),!1===h.cache&&(h.url=ii.test(o)?o.replace(ii,"$1_="+ti++):o+(ni.test(o)?"&":"?")+"_="+ti++)),h.ifModified&&(rt.lastModified[o]&&S.setRequestHeader("If-Modified-Since",rt.lastModified[o]),rt.etag[o]&&S.setRequestHeader("If-None-Match",rt.etag[o])),(h.data&&h.hasContent&&!1!==h.contentType||t.contentType)&&S.setRequestHeader("Content-Type",h.contentType),S.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+hi+"; q=0.01":""):h.accepts["*"]);for(s in h.headers)S.setRequestHeader(s,h.headers[s]);if(!h.beforeSend||!1!==h.beforeSend.call(p,S,h)&&2!==w){E="abort";for(s in{success:1,error:1,complete:1})S[s](h[s]);if(l=M(ci,h,t,S)){S.readyState=1,f&&d.trigger("ajaxSend",[S,h]),h.async&&0<h.timeout&&(a=setTimeout(function(){S.abort("timeout")},h.timeout));try{w=1,l.send(y,r)}catch(x){if(!(2>w))throw x;r(-1,x)}}else r(-1,"No Transport");return S}return S.abort()},getJSON:function(e,t,n){return rt.get(e,t,n,"json")},getScript:function(e,t){return rt.get(e,n,t,"script")}}),rt.each(["get","post"],function(e,t){rt[t]=function(e,r,i,s){return rt.isFunction(r)&&(s=s||i,i=r,r=n),rt.ajax({url:e,type:t,dataType:s,data:r,success:i})}}),rt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return rt.globalEval(e),e}}}),rt.ajaxPrefilter("script",function(e){e.cache===n&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),rt.ajaxTransport("script",function(e){if(e.crossDomain){var t,r=W.head||rt("head")[0]||W.documentElement;return{send:function(n,i){t=W.createElement("script"),t.async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,n){if(n||!t.readyState||/loaded|complete/.test(t.readyState))t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,n||i(200,"success")},r.insertBefore(t,r.firstChild)},abort:function(){t&&t.onload(n,!0)}}}});var di=[],vi=/(=)\?(?=&|$)|\?\?/;rt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=di.pop()||rt.expando+"_"+ti++;return this[e]=!0,e}}),rt.ajaxPrefilter("json jsonp",function(t,r,i){var s,o,u,a=!1!==t.jsonp&&(vi.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&vi.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return s=t.jsonpCallback=rt.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(vi,"$1"+s):!1!==t.jsonp&&(t.url+=(ni.test(t.url)?"&":"?")+t.jsonp+"="+s),t.converters["script json"]=function(){return u||rt.error(s+" was not called"),u[0]},t.dataTypes[0]="json",o=e[s],e[s]=function(){u=arguments},i.always(function(){e[s]=o,t[s]&&(t.jsonpCallback=r.jsonpCallback,di.push(s)),u&&rt.isFunction(o)&&o(u[0]),u=o=n}),"script"});var mi,gi,yi=0,bi=e.ActiveXObject&&function(){for(var e in mi)mi[e](n,!0)};rt.ajaxSettings.xhr=e.ActiveXObject?function(){var t;if(!(t=!this.isLocal&&D()))e:{try{t=new e.ActiveXObject("Microsoft.XMLHTTP");break e}catch(n){}t=void 0}return t}:D,gi=rt.ajaxSettings.xhr(),rt.support.cors=!!gi&&"withCredentials"in gi,(gi=rt.support.ajax=!!gi)&&rt.ajaxTransport(function(t){if(!t.crossDomain||rt.support.cors){var r;return{send:function(i,s){var o,u,a=t.xhr();t.username?a.open(t.type,t.url,t.async,t.username,t.password):a.open(t.type,t.url,t.async);if(t.xhrFields)for(u in t.xhrFields)a[u]=t.xhrFields[u];t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),!t.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(t.hasContent&&t.data||null),r=function(e,i){var u,f,l,c;try{if(r&&(i||4===a.readyState))if(r=n,o&&(a.onreadystatechange=rt.noop,bi&&delete mi[o]),i)4!==a.readyState&&a.abort();else{c={},u=a.status,f=a.getAllResponseHeaders(),"string"==typeof a.responseText&&(c.text=a.responseText);try{l=a.statusText}catch(h){l=""}!u&&t.isLocal&&!t.crossDomain?u=c.text?200:404:1223===u&&(u=204)}}catch(p){i||s(-1,p)}c&&s(u,l,c,f)},t.async?4===a.readyState?setTimeout(r):(o=++yi,bi&&(mi||(mi={},rt(e).unload(bi)),mi[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(n,!0)}}}});var wi,Ei,Si=/^(?:toggle|show|hide)$/,xi=RegExp("^(?:([+-])=|)("+it+")([a-z%]*)$","i"),Ti=/queueHooks$/,Ni=[function(e,t,n){var r,i,s,o,u,a=this,f={},l=e.style,c=e.nodeType&&S(e),h=rt._data(e,"fxshow");n.queue||(o=rt._queueHooks(e,"fx"),null==o.unqueued&&(o.unqueued=0,u=o.empty.fire,o.empty.fire=function(){o.unqueued||u()}),o.unqueued++,a.always(function(){a.always(function(){o.unqueued--,rt.queue(e,"fx").length||o.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[l.overflow,l.overflowX,l.overflowY],"inline"===rt.css(e,"display")&&"none"===rt.css(e,"float")&&(!rt.support.inlineBlockNeedsLayout||"inline"===k(e.nodeName)?l.display="inline-block":l.zoom=1)),n.overflow&&(l.overflow="hidden",rt.support.shrinkWrapBlocks||a.always(function(){l.overflow=n.overflow[0],l.overflowX=n.overflow[1],l.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],Si.exec(i)&&(delete t[r],s=s||"toggle"===i,i!==(c?"hide":"show")))f[r]=h&&h[r]||rt.style(e,r);if(!rt.isEmptyObject(f))for(r in h?"hidden"in h&&(c=h.hidden):h=rt._data(e,"fxshow",{}),s&&(h.hidden=!c),c?rt(e).show():a.done(function(){rt(e).hide()}),a.done(function(){var t;rt._removeData(e,"fxshow");for(t in f)rt.style(e,t,f[t])}),f)t=H(c?h[r]:0,r,a),r in h||(h[r]=t.start,c&&(t.end=t.start,t.start="width"===r||"height"===r?1:0))}],Ci={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=xi.exec(t),s=i&&i[3]||(rt.cssNumber[e]?"":"px"),o=(rt.cssNumber[e]||"px"!==s&&+r)&&xi.exec(rt.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,rt.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&1!==u&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};rt.Animation=rt.extend(B,{tweener:function(e,t){rt.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,r=0,i=e.length;r<i;r++)n=e[r],Ci[n]=Ci[n]||[],Ci[n].unshift(t)},prefilter:function(e,t){t?Ni.unshift(e):Ni.push(e)}}),rt.Tween=j,j.prototype={constructor:j,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(rt.cssNumber[n]?"":"px")},cur:function(){var e=j.propHooks[this.prop];return e&&e.get?e.get(this):j.propHooks._default.get(this)},run:function(e){var t,n=j.propHooks[this.prop];return this.pos=this.options.duration?t=rt.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):j.propHooks._default.set(this),this}},j.prototype.init.prototype=j.prototype,j.propHooks={_default:{get:function(e){return null==e.elem[e.prop]||!!e.elem.style&&null!=e.elem.style[e.prop]?(e=rt.css(e.elem,e.prop,""),!e||"auto"===e?0:e):e.elem[e.prop]},set:function(e){rt.fx.step[e.prop]?rt.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[rt.cssProps[e.prop]]||rt.cssHooks[e.prop])?rt.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},j.propHooks.scrollTop=j.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},rt.each(["toggle","show","hide"],function(e,t){var n=rt.fn[t];rt.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(F(t,!0),e,r,i)}}),rt.fn.extend({fadeTo:function(e,t,n,r){return this.filter(S).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=rt.isEmptyObject(e),s=rt.speed(t,n,r);return t=function(){var t=B(this,rt.extend({},e),s);(i||rt._data(this,"finish"))&&t.stop(!0)},t.finish=t,i||!1===s.queue?this.each(t):this.queue(s.queue,t)},stop:function(e,t,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=t,t=e,e=n),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",s=rt.timers,o=rt._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Ti.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem===this&&(null==e||s[n].queue===e)&&(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&rt.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=rt._data(this),r=n[e+"queue"];t=n[e+"queueHooks"];var i=rt.timers,s=r?r.length:0;n.finish=!0,rt.queue(this,e,[]),t&&t.stop&&t.stop.call(this,!0);for(t=i.length;t--;)i[t].elem===this&&i[t].queue===e&&(i[t].anim.stop(!0),i.splice(t,1));for(t=0;t<s;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),rt.each({slideDown:F("show"),slideUp:F("hide"),slideToggle:F("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){rt.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),rt.speed=function(e,t,n){var r=e&&"object"==typeof e?rt.extend({},e):{complete:n||!n&&t||rt.isFunction(e)&&e,duration:e,easing:n&&t||t&&!rt.isFunction(t)&&t};r.duration=rt.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in rt.fx.speeds?rt.fx.speeds[r.duration]:rt.fx.speeds._default;if(null==r.queue||!0===r.queue)r.queue="fx";return r.old=r.complete,r.complete=function(){rt.isFunction(r.old)&&r.old.call(this),r.queue&&rt.dequeue(this,r.queue)},r},rt.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},rt.timers=[],rt.fx=j.prototype.init,rt.fx.tick=function(){var e,t=rt.timers,r=0;for(wi=rt.now();r<t.length;r++)e=t[r],!e()&&t[r]===e&&t.splice(r--,1);t.length||rt.fx.stop(),wi=n},rt.fx.timer=function(e){e()&&rt.timers.push(e)&&rt.fx.start()},rt.fx.interval=13,rt.fx.start=function(){Ei||(Ei=setInterval(rt.fx.tick,rt.fx.interval))},rt.fx.stop=function(){clearInterval(Ei),Ei=null},rt.fx.speeds={slow:600,fast:200,_default:400},rt.fx.step={},rt.expr&&rt.expr.filters&&(rt.expr.filters.animated=function(e){return rt.grep(rt.timers,function(t){return e===t.elem}).length}),rt.fn.offset=function(e){if(arguments.length)return e===n?this:this.each(function(t){rt.offset.setOffset(this,e,t)});var t,r,i={top:0,left:0},s=(r=this[0])&&r.ownerDocument;if(s)return t=s.documentElement,rt.contains(t,r)?(typeof r.getBoundingClientRect!==U&&(i=r.getBoundingClientRect()),r=I(s),{top:i.top+(r.pageYOffset||t.scrollTop)-(t.clientTop||0),left:i.left+(r.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):i},rt.offset={setOffset:function(e,t,n){var r=rt.css(e,"position");"static"===r&&(e.style.position="relative");var i=rt(e),s=i.offset(),o=rt.css(e,"top"),u=rt.css(e,"left"),a={},f={};("absolute"===r||"fixed"===r)&&-1<rt.inArray("auto",[o,u])?(f=i.position(),r=f.top,u=f.left):(r=parseFloat(o)||0,u=parseFloat(u)||0),rt.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(a.top=t.top-s.top+r),null!=t.left&&(a.left=t.left-s.left+u),"using"in t?t.using.call(e,a):i.css(a)}},rt.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===rt.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),rt.nodeName(e[0],"html")||(n=e.offset()),n.top+=rt.css(e[0],"borderTopWidth",!0),n.left+=rt.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-rt.css(r,"marginTop",!0),left:t.left-n.left-rt.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||X;e&&!rt.nodeName(e,"html")&&"static"===rt.css(e,"position");)e=e.offsetParent;return e||X})}}),rt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var r=/Y/.test(t);rt.fn[e]=function(i){return rt.access(this,function(e,i,s){var o=I(e);if(s===n)return o?t in o?o[t]:o.document.documentElement[i]:e[i];o?o.scrollTo(r?rt(o).scrollLeft():s,r?s:rt(o).scrollTop()):e[i]=s},e,i,arguments.length,null)}}),rt.each({Height:"height",Width:"width"},function(e,t){rt.each({padding:"inner"+e,content:t,"":"outer"+e},function(r,i){rt.fn[i]=function(i,s){var o=arguments.length&&(r||"boolean"!=typeof i),u=r||(!0===i||!0===s?"margin":"border");return rt.access(this,function(t,r,i){return rt.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):i===n?rt.css(t,r,u):rt.style(t,r,i,u)},t,o?i:n,o,null)}})}),rt.fn.size=function(){return this.length},rt.fn.andSelf=rt.fn.addBack,t.jQuery=rt})(window,ChemDoodle.lib),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(ChemDoodle.lib.jQuery)}(function(e){function t(t){var r=t||window.event,i=s.call(arguments,1),f=0,l=0,c=0,h=0;t=e.event.fix(r),t.type="mousewheel","detail"in r&&(c=-1*r.detail),"wheelDelta"in r&&(c=r.wheelDelta),"wheelDeltaY"in r&&(c=r.wheelDeltaY),"wheelDeltaX"in r&&(l=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(l=-1*c,c=0),f=0===c?l:c,"deltaY"in r&&(f=c=-1*r.deltaY),"deltaX"in r&&(l=r.deltaX,0===c&&(f=-1*l));if(0!==c||0!==l){1===r.deltaMode?(r=e.data(this,"mousewheel-line-height"),f*=r,c*=r,l*=r):2===r.deltaMode&&(r=e.data(this,"mousewheel-page-height"),f*=r,c*=r,l*=r),h=Math.max(Math.abs(c),Math.abs(l));if(!a||h<a)a=h,120===a&&(o=!0,a/=40);return o&&(f/=40,l/=40,c/=40),f=Math[1<=f?"floor":"ceil"](f/a),l=Math[1<=l?"floor":"ceil"](l/a),c=Math[1<=c?"floor":"ceil"](c/a),t.deltaX=l,t.deltaY=c,t.deltaFactor=a,t.deltaMode=0,i.unshift(t,f,l,c),u&&clearTimeout(u),u=setTimeout(n,200),(e.event.dispatch||e.event.handle).apply(this,i)}}function n(){o=a=null}var r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],i="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],s=Array.prototype.slice,o,u,a;if(e.event.fixHooks)for(var f=r.length;f;)e.event.fixHooks[r[--f]]=e.event.mouseHooks;var l=e.event.special.mousewheel={version:"3.1.8",setup:function(){if(this.addEventListener)for(var n=i.length;n;)this.addEventListener(i[--n],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",l.getLineHeight(this)),e.data(this,"mousewheel-page-height",l.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var e=i.length;e;)this.removeEventListener(i[--e],t,!1);else this.onmousewheel=null},getLineHeight:function(t){return parseInt(e(t)["offsetParent"in e.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(t){return e(t).height()}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),function(e,t){"object"==typeof exports?module.exports=t(global):"function"==typeof define&&define.amd?define([],function(){return t(e)}):t(e)}(ChemDoodle.lib,function(e){function t(e){return o=e}function n(){return o="undefined"!=typeof Float32Array?Float32Array:Array}var r={};if("undefined"!=typeof Float32Array){var i=new Float32Array(1),s=new Int32Array(i.buffer
);r.invsqrt=function(e){i[0]=e,s[0]=1597463007-(s[0]>>1);var t=i[0];return t*(1.5-.5*e*t*t)}}else r.invsqrt=function(e){return 1/Math.sqrt(e)};var o=null;n();var u={create:function(e){var t=new o(3);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):t[0]=t[1]=t[2]=0,t},createFrom:function(e,t,n){var r=new o(3);return r[0]=e,r[1]=t,r[2]=n,r},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},equal:function(e,t){return e===t||1e-6>Math.abs(e[0]-t[0])&&1e-6>Math.abs(e[1]-t[1])&&1e-6>Math.abs(e[2]-t[2])},add:function(e,t,n){return!n||e===n?(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e):(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n)},subtract:function(e,t,n){return!n||e===n?(e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],e):(n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n)},multiply:function(e,t,n){return!n||e===n?(e[0]*=t[0],e[1]*=t[1],e[2]*=t[2],e):(n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n)},negate:function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},scale:function(e,t,n){return!n||e===n?(e[0]*=t,e[1]*=t,e[2]*=t,e):(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n)},normalize:function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=Math.sqrt(n*n+r*r+i*i);return s?1===s?(t[0]=n,t[1]=r,t[2]=i,t):(s=1/s,t[0]=n*s,t[1]=r*s,t[2]=i*s,t):(t[0]=0,t[1]=0,t[2]=0,t)},cross:function(e,t,n){n||(n=e);var r=e[0],i=e[1];e=e[2];var s=t[0],o=t[1];return t=t[2],n[0]=i*t-e*o,n[1]=e*s-r*t,n[2]=r*o-i*s,n},length:function(e){var t=e[0],n=e[1];return e=e[2],Math.sqrt(t*t+n*n+e*e)},squaredLength:function(e){var t=e[0],n=e[1];return e=e[2],t*t+n*n+e*e},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},direction:function(e,t,n){n||(n=e);var r=e[0]-t[0],i=e[1]-t[1];return e=e[2]-t[2],t=Math.sqrt(r*r+i*i+e*e),t?(t=1/t,n[0]=r*t,n[1]=i*t,n[2]=e*t,n):(n[0]=0,n[1]=0,n[2]=0,n)},lerp:function(e,t,n,r){return r||(r=e),r[0]=e[0]+n*(t[0]-e[0]),r[1]=e[1]+n*(t[1]-e[1]),r[2]=e[2]+n*(t[2]-e[2]),r},dist:function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}},a=null,f=new o(4);u.unproject=function(e,t,n,r,i){i||(i=e),a||(a=v.create());var s=a;return f[0]=2*(e[0]-r[0])/r[2]-1,f[1]=2*(e[1]-r[1])/r[3]-1,f[2]=2*e[2]-1,f[3]=1,v.multiply(n,t,s),v.inverse(s)?(v.multiplyVec4(s,f),0===f[3]?null:(i[0]=f[0]/f[3],i[1]=f[1]/f[3],i[2]=f[2]/f[3],i)):null};var l=u.createFrom(1,0,0),c=u.createFrom(0,1,0),h=u.createFrom(0,0,1),p=u.create();u.rotationTo=function(e,t,n){n||(n=m.create());var r=u.dot(e,t);if(1<=r)m.set(g,n);else if(-0.999999>r)u.cross(l,e,p),1e-6>u.length(p)&&u.cross(c,e,p),1e-6>u.length(p)&&u.cross(h,e,p),u.normalize(p),m.fromAngleAxis(Math.PI,p,n);else{var r=Math.sqrt(2*(1+r)),i=1/r;u.cross(e,t,p),n[0]=p[0]*i,n[1]=p[1]*i,n[2]=p[2]*i,n[3]=.5*r,m.normalize(n)}return 1<n[3]?n[3]=1:-1>n[3]&&(n[3]=-1),n},u.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+"]"};var d={create:function(e){var t=new o(9);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8]):t[0]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=0,t},createFrom:function(e,t,n,r,i,s,u,a,f){var l=new o(9);return l[0]=e,l[1]=t,l[2]=n,l[3]=r,l[4]=i,l[5]=s,l[6]=u,l[7]=a,l[8]=f,l},determinant:function(e){var t=e[3],n=e[4],r=e[5],i=e[6],s=e[7],o=e[8];return e[0]*(o*n-r*s)+e[1]*(-o*t+r*i)+e[2]*(s*t-n*i)},inverse:function(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=e[6],f=e[7],l=e[8],c=l*o-u*f,h=-l*s+u*a,p=f*s-o*a,v=n*c+r*h+i*p;return v?(v=1/v,t||(t=d.create()),t[0]=c*v,t[1]=(-l*r+i*f)*v,t[2]=(u*r-i*o)*v,t[3]=h*v,t[4]=(l*n-i*a)*v,t[5]=(-u*n+i*s)*v,t[6]=p*v,t[7]=(-f*n+r*a)*v,t[8]=(o*n-r*s)*v,t):null},multiply:function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=e[4],a=e[5],f=e[6],l=e[7];e=e[8];var c=t[0],h=t[1],p=t[2],d=t[3],v=t[4],m=t[5],g=t[6],y=t[7];return t=t[8],n[0]=c*r+h*o+p*f,n[1]=c*i+h*u+p*l,n[2]=c*s+h*a+p*e,n[3]=d*r+v*o+m*f,n[4]=d*i+v*u+m*l,n[5]=d*s+v*a+m*e,n[6]=g*r+y*o+t*f,n[7]=g*i+y*u+t*l,n[8]=g*s+y*a+t*e,n},multiplyVec2:function(e,t,n){n||(n=t);var r=t[0];return t=t[1],n[0]=r*e[0]+t*e[3]+e[6],n[1]=r*e[1]+t*e[4]+e[7],n},multiplyVec3:function(e,t,n){n||(n=t);var r=t[0],i=t[1];return t=t[2],n[0]=r*e[0]+i*e[3]+t*e[6],n[1]=r*e[1]+i*e[4]+t*e[7],n[2]=r*e[2]+i*e[5]+t*e[8],n},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},equal:function(e,t){return e===t||1e-6>Math.abs(e[0]-t[0])&&1e-6>Math.abs(e[1]-t[1])&&1e-6>Math.abs(e[2]-t[2])&&1e-6>Math.abs(e[3]-t[3])&&1e-6>Math.abs(e[4]-t[4])&&1e-6>Math.abs(e[5]-t[5])&&1e-6>Math.abs(e[6]-t[6])&&1e-6>Math.abs(e[7]-t[7])&&1e-6>Math.abs(e[8]-t[8])},identity:function(e){return e||(e=d.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},transpose:function(e,t){if(!t||e===t){var n=e[1],r=e[2],i=e[5];return e[1]=e[3],e[2]=e[6],e[3]=n,e[5]=e[7],e[6]=r,e[7]=i,e}return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t},toMat4:function(e,t){return t||(t=v.create()),t[15]=1,t[14]=0,t[13]=0,t[12]=0,t[11]=0,t[10]=e[8],t[9]=e[7],t[8]=e[6],t[7]=0,t[6]=e[5],t[5]=e[4],t[4]=e[3],t[3]=0,t[2]=e[2],t[1]=e[1],t[0]=e[0],t},str:function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+"]"}},v={create:function(e){var t=new o(16);return e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t},createFrom:function(e,t,n,r,i,s,u,a,f,l,c,h,p,d,v,m){var g=new o(16);return g[0]=e,g[1]=t,g[2]=n,g[3]=r,g[4]=i,g[5]=s,g[6]=u,g[7]=a,g[8]=f,g[9]=l,g[10]=c,g[11]=h,g[12]=p,g[13]=d,g[14]=v,g[15]=m,g},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},equal:function(e,t){return e===t||1e-6>Math.abs(e[0]-t[0])&&1e-6>Math.abs(e[1]-t[1])&&1e-6>Math.abs(e[2]-t[2])&&1e-6>Math.abs(e[3]-t[3])&&1e-6>Math.abs(e[4]-t[4])&&1e-6>Math.abs(e[5]-t[5])&&1e-6>Math.abs(e[6]-t[6])&&1e-6>Math.abs(e[7]-t[7])&&1e-6>Math.abs(e[8]-t[8])&&1e-6>Math.abs(e[9]-t[9])&&1e-6>Math.abs(e[10]-t[10])&&1e-6>Math.abs(e[11]-t[11])&&1e-6>Math.abs(e[12]-t[12])&&1e-6>Math.abs(e[13]-t[13])&&1e-6>Math.abs(e[14]-t[14])&&1e-6>Math.abs(e[15]-t[15])},identity:function(e){return e||(e=v.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},transpose:function(e,t){if(!t||e===t){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],u=e[11];return e[1]=e[4],e[2]=e[8],e[3]=e[12],e[4]=n,e[6]=e[9],e[7]=e[13],e[8]=r,e[9]=s,e[11]=e[14],e[12]=i,e[13]=o,e[14]=u,e}return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t},determinant:function(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],f=e[8],l=e[9],c=e[10],h=e[11],p=e[12],d=e[13],v=e[14];return e=e[15],p*l*u*i-f*d*u*i-p*o*c*i+s*d*c*i+f*o*v*i-s*l*v*i-p*l*r*a+f*d*r*a+p*n*c*a-t*d*c*a-f*n*v*a+t*l*v*a+p*o*r*h-s*d*r*h-p*n*u*h+t*d*u*h+s*n*v*h-t*o*v*h-f*o*r*e+s*l*r*e+f*n*u*e-t*l*u*e-s*n*c*e+t*o*c*e},inverse:function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=e[6],f=e[7],l=e[8],c=e[9],h=e[10],p=e[11],d=e[12],v=e[13],m=e[14],g=e[15],y=n*u-r*o,b=n*a-i*o,w=n*f-s*o,E=r*a-i*u,S=r*f-s*u,x=i*f-s*a,T=l*v-c*d,N=l*m-h*d,C=l*g-p*d,k=c*m-h*v,L=c*g-p*v,A=h*g-p*m,O=y*A-b*L+w*k+E*C-S*N+x*T;return O?(O=1/O,t[0]=(u*A-a*L+f*k)*O,t[1]=(-r*A+i*L-s*k)*O,t[2]=(v*x-m*S+g*E)*O,t[3]=(-c*x+h*S-p*E)*O,t[4]=(-o*A+a*C-f*N)*O,t[5]=(n*A-i*C+s*N)*O,t[6]=(-d*x+m*w-g*b)*O,t[7]=(l*x-h*w+p*b)*O,t[8]=(o*L-u*C+f*T)*O,t[9]=(-n*L+r*C-s*T)*O,t[10]=(d*S-v*w+g*y)*O,t[11]=(-l*S+c*w-p*y)*O,t[12]=(-o*k+u*N-a*T)*O,t[13]=(n*k-r*N+i*T)*O,t[14]=(-d*E+v*b-m*y)*O,t[15]=(l*E-c*b+h*y)*O,t):null},toRotationMat:function(e,t){return t||(t=v.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},toMat3:function(e,t){return t||(t=d.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},toInverseMat3:function(e,t){var n=e[0],r=e[1],i=e[2],s=e[4],o=e[5],u=e[6],a=e[8],f=e[9],l=e[10],c=l*o-u*f,h=-l*s+u*a,p=f*s-o*a,v=n*c+r*h+i*p;return v?(v=1/v,t||(t=d.create()),t[0]=c*v,t[1]=(-l*r+i*f)*v,t[2]=(u*r-i*o)*v,t[3]=h*v,t[4]=(l*n-i*a)*v,t[5]=(-u*n+i*s)*v,t[6]=p*v,t[7]=(-f*n+r*a)*v,t[8]=(o*n-r*s)*v,t):null},multiply:function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2],o=e[3],u=e[4],a=e[5],f=e[6],l=e[7],c=e[8],h=e[9],p=e[10],d=e[11],v=e[12],m=e[13],g=e[14];e=e[15];var y=t[0],b=t[1],w=t[2],E=t[3];return n[0]=y*r+b*u+w*c+E*v,n[1]=y*i+b*a+w*h+E*m,n[2]=y*s+b*f+w*p+E*g,n[3]=y*o+b*l+w*d+E*e,y=t[4],b=t[5],w=t[6],E=t[7],n[4]=y*r+b*u+w*c+E*v,n[5]=y*i+b*a+w*h+E*m,n[6]=y*s+b*f+w*p+E*g,n[7]=y*o+b*l+w*d+E*e,y=t[8],b=t[9],w=t[10],E=t[11],n[8]=y*r+b*u+w*c+E*v,n[9]=y*i+b*a+w*h+E*m,n[10]=y*s+b*f+w*p+E*g,n[11]=y*o+b*l+w*d+E*e,y=t[12],b=t[13],w=t[14],E=t[15],n[12]=y*r+b*u+w*c+E*v,n[13]=y*i+b*a+w*h+E*m,n[14]=y*s+b*f+w*p+E*g,n[15]=y*o+b*l+w*d+E*e,n},multiplyVec3:function(e,t,n){n||(n=t);var r=t[0],i=t[1];return t=t[2],n[0]=e[0]*r+e[4]*i+e[8]*t+e[12],n[1]=e[1]*r+e[5]*i+e[9]*t+e[13],n[2]=e[2]*r+e[6]*i+e[10]*t+e[14],n},multiplyVec4:function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2];return t=t[3],n[0]=e[0]*r+e[4]*i+e[8]*s+e[12]*t,n[1]=e[1]*r+e[5]*i+e[9]*s+e[13]*t,n[2]=e[2]*r+e[6]*i+e[10]*s+e[14]*t,n[3]=e[3]*r+e[7]*i+e[11]*s+e[15]*t,n},translate:function(e,t,n){var r=t[0],i=t[1];t=t[2];var s,o,u,a,f,l,c,h,p,d,v,m;return!n||e===n?(e[12]=e[0]*r+e[4]*i+e[8]*t+e[12],e[13]=e[1]*r+e[5]*i+e[9]*t+e[13],e[14]=e[2]*r+e[6]*i+e[10]*t+e[14],e[15]=e[3]*r+e[7]*i+e[11]*t+e[15],e):(s=e[0],o=e[1],u=e[2],a=e[3],f=e[4],l=e[5],c=e[6],h=e[7],p=e[8],d=e[9],v=e[10],m=e[11],n[0]=s,n[1]=o,n[2]=u,n[3]=a,n[4]=f,n[5]=l,n[6]=c,n[7]=h,n[8]=p,n[9]=d,n[10]=v,n[11]=m,n[12]=s*r+f*i+p*t+e[12],n[13]=o*r+l*i+d*t+e[13],n[14]=u*r+c*i+v*t+e[14],n[15]=a*r+h*i+m*t+e[15],n)},scale:function(e,t,n){var r=t[0],i=t[1];return t=t[2],!n||e===n?(e[0]*=r,e[1]*=r,e[2]*=r,e[3]*=r,e[4]*=i,e[5]*=i,e[6]*=i,e[7]*=i,e[8]*=t,e[9]*=t,e[10]*=t,e[11]*=t,e):(n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7]*i,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n)},rotate:function(e,t,n,r){var i=n[0],s=n[1];n=n[2];var o=Math.sqrt(i*i+s*s+n*n),u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C;return o?(1!==o&&(o=1/o,i*=o,s*=o,n*=o),u=Math.sin(t),a=Math.cos(t),f=1-a,t=e[0],o=e[1],l=e[2],c=e[3],h=e[4],p=e[5],d=e[6],v=e[7],m=e[8],g=e[9],y=e[10],b=e[11],w=i*i*f+a,E=s*i*f+n*u,S=n*i*f-s*u,x=i*s*f-n*u,T=s*s*f+a,N=n*s*f+i*u,C=i*n*f+s*u,i=s*n*f-i*u,s=n*n*f+a,r?e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]):r=e,r[0]=t*w+h*E+m*S,r[1]=o*w+p*E+g*S,r[2]=l*w+d*E+y*S,r[3]=c*w+v*E+b*S,r[4]=t*x+h*T+m*N,r[5]=o*x+p*T+g*N,r[6]=l*x+d*T+y*N,r[7]=c*x+v*T+b*N,r[8]=t*C+h*i+m*s,r[9]=o*C+p*i+g*s,r[10]=l*C+d*i+y*s,r[11]=c*C+v*i+b*s,r):null},rotateX:function(e,t,n){var r=Math.sin(t);t=Math.cos(t);var i=e[4],s=e[5],o=e[6],u=e[7],a=e[8],f=e[9],l=e[10],c=e[11];return n?e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[4]=i*t+a*r,n[5]=s*t+f*r,n[6]=o*t+l*r,n[7]=u*t+c*r,n[8]=i*-r+a*t,n[9]=s*-r+f*t,n[10]=o*-r+l*t,n[11]=u*-r+c*t,n},rotateY:function(e,t,n){var r=Math.sin(t);t=Math.cos(t);var i=e[0],s=e[1],o=e[2],u=e[3],a=e[8],f=e[9],l=e[10],c=e[11];return n?e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=i*t+a*-r,n[1]=s*t+f*-r,n[2]=o*t+l*-r,n[3]=u*t+c*-r,n[8]=i*r+a*t,n[9]=s*r+f*t,n[10]=o*r+l*t,n[11]=u*r+c*t,n},rotateZ:function(e,t,n){var r=Math.sin(t);t=Math.cos(t);var i=e[0],s=e[1],o=e[2],u=e[3],a=e[4],f=e[5],l=e[6],c=e[7];return n?e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=i*t+a*r,n[1]=s*t+f*r,n[2]=o*t+l*r,n[3]=u*t+c*r,n[4]=i*-r+a*t,n[5]=s*-r+f*t,n[6]=o*-r+l*t,n[7]=u*-r+c*t,n},frustum:function(e,t,n,r,i,s,o){o||(o=v.create());var u=t-e,a=r-n,f=s-i;return o[0]=2*i/u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*i/a,o[6]=0,o[7]=0,o[8]=(t+e)/u,o[9]=(r+n)/a,o[10]=-(s+i)/f,o[11]=-1,o[12]=0,o[13]=0,o[14]=-(2*s*i)/f,o[15]=0,o},perspective:function(e,t,n,r,i){return e=n*Math.tan(e*Math.PI/360),t*=e,v.frustum(-t,t,-e,e,n,r,i)},ortho:function(e,t,n,r,i,s,o){o||(o=v.create());var u=t-e,a=r-n,f=s-i;return o[0]=2/u,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/a,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/f,o[11]=0,o[12]=-(e+t)/u,o[13]=-(r+n)/a,o[14]=-(s+i)/f,o[15]=1,o},lookAt:function(e,t,n,r){r||(r=v.create());var i,s,o,u,a,f,l,c,h=e[0],p=e[1];return e=e[2],o=n[0],u=n[1],s=n[2],l=t[0],n=t[1],i=t[2],h===l&&p===n&&e===i?v.identity(r):(t=h-l,n=p-n,l=e-i,c=1/Math.sqrt(t*t+n*n+l*l),t*=c,n*=c,l*=c,i=u*l-s*n,s=s*t-o*l,o=o*n-u*t,(c=Math.sqrt(i*i+s*s+o*o))?(c=1/c,i*=c,s*=c,o*=c):o=s=i=0,u=n*o-l*s,a=l*i-t*o,f=t*s-n*i,(c=Math.sqrt(u*u+a*a+f*f))?(c=1/c,u*=c,a*=c,f*=c):f=a=u=0,r[0]=i,r[1]=u,r[2]=t,r[3]=0,r[4]=s,r[5]=a,r[6]=n,r[7]=0,r[8]=o,r[9]=f,r[10]=l,r[11]=0,r[12]=-(i*h+s*p+o*e),r[13]=-(u*h+a*p+f*e),r[14]=-(t*h+n*p+l*e),r[15]=1,r)},fromRotationTranslation:function(e,t,n){n||(n=v.create());var r=e[0],i=e[1],s=e[2],o=e[3],u=r+r,a=i+i,f=s+s;e=r*u;var l=r*a,r=r*f,c=i*a,i=i*f,s=s*f,u=o*u,a=o*a,o=o*f;return n[0]=1-(c+s),n[1]=l+o,n[2]=r-a,n[3]=0,n[4]=l-o,n[5]=1-(e+s),n[6]=i+u,n[7]=0,n[8]=r+a,n[9]=i-u,n[10]=1-(e+c),n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n},str:function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+"]"}},m={create:function(e){var t=new o(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},createFrom:function(e,t,n,r){var i=new o(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},equal:function(e,t){return e===t||1e-6>Math.abs(e[0]-t[0])&&1e-6>Math.abs(e[1]-t[1])&&1e-6>Math.abs(e[2]-t[2])&&1e-6>Math.abs(e[3]-t[3])},identity:function(e){return e||(e=m.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}},g=m.identity();m.calculateW=function(e,t){var n=e[0],r=e[1],i=e[2];return!t||e===t?(e[3]=-Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e):(t[0]=n,t[1]=r,t[2]=i,t[3]=-Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t)},m.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},m.inverse=function(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],n=(n=n*n+r*r+i*i+s*s)?1/n:0;return!t||e===t?(e[0]*=-n,e[1]*=-n,e[2]*=-n,e[3]*=n,e):(t[0]=-e[0]*n,t[1]=-e[1]*n,t[2]=-e[2]*n,t[3]=e[3]*n,t)},m.conjugate=function(e,t){return!t||e===t?(e[0]*=-1,e[1]*=-1,e[2]*=-1,e):(t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t)},m.length=function(e){var t=e[0],n=e[1],r=e[2];return e=e[3],Math.sqrt(t*t+n*n+r*r+e*e)},m.normalize=function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=e[3],o=Math.sqrt(n*n+r*r+i*i+s*s);return 0===o?(t[0]=0,t[1]=0,t[2]=0,t[3]=0,t):(o=1/o,t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=s*o,t)},m.add=function(e,t,n){return!n||e===n?(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e[3]+=t[3],e):(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n)},m.multiply=function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2];e=e[3];var o=t[0],u=t[1],a=t[2];return t=t[3],n[0]=r*t+e*o+i*a-s*u,n[1]=i*t+e*u+s*o-r*a,n[2]=s*t+e*a+r*u-i*o,n[3]=e*t-r*o-i*u-s*a,n},m.multiplyVec3=function(e,t,n){n||(n=t);var r=t[0],i=t[1],s=t[2];t=e[0];var o=e[1],u=e[2];e=e[3];var a=e*r+o*s-u*i,f=e*i+u*r-t*s,l=e*s+t*i-o*r,r=-t*r-o*i-u*s;return n[0]=a*e+r*-t+f*-u-l*-o,n[1]=f*e+r*-o+l*-t-a*-u,n[2]=l*e+r*-u+a*-o-f*-t,n},m.scale=function(e,t,n){return!n||e===n?(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e):(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n)},m.toMat3=function(e,t){t||(t=d.create());var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,u=r+r,a=i+i,f=n*o,l=n*u,n=n*a,c=r*u,r=r*a,i=i*a,o=s*o,u=s*u,s=s*a;return t[0]=1-(c+i),t[1]=l+s,t[2]=n-u,t[3]=l-s,t[4]=1-(f+i),t[5]=r+o,t[6]=n+u,t[7]=r-o,t[8]=1-(f+c),t},m.toMat4=function(e,t){t||(t=v.create());var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,u=r+r,a=i+i,f=n*o,l=n*u,n=n*a,c=r*u,r=r*a,i=i*a,o=s*o,u=s*u,s=s*a;return t[0]=1-(c+i),t[1]=l+s,t[2]=n-u,t[3]=0,t[4]=l-s,t[5]=1-(f+i),t[6]=r+o,t[7]=0,t[8]=n+u,t[9]=r-o,t[10]=1-(f+c),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},m.slerp=function(e,t,n,r){r||(r=e);var i=e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],s,o;return 1<=Math.abs(i)?(r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3]),r):(s=Math.acos(i),o=Math.sqrt(1-i*i),.001>Math.abs(o)?(r[0]=.5*e[0]+.5*t[0],r[1]=.5*e[1]+.5*t[1],r[2]=.5*e[2]+.5*t[2],r[3]=.5*e[3]+.5*t[3],r):(i=Math.sin((1-n)*s)/o,n=Math.sin(n*s)/o,r[0]=e[0]*i+t[0]*n,r[1]=e[1]*i+t[1]*n,r[2]=e[2]*i+t[2]*n,r[3]=e[3]*i+t[3]*n,r))},m.fromRotationMatrix=function(e,t){t||(t=m.create());var n=e[0]+e[4]+e[8],r;if(0<n)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[7]-e[5])*r,t[1]=(e[2]-e[6])*r,t[2]=(e[3]-e[1])*r;else{r=m.fromRotationMatrix.s_iNext=m.fromRotationMatrix.s_iNext||[1,2,0],n=0,e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);var i=r[n],s=r[i];r=Math.sqrt(e[3*n+n]-e[3*i+i]-e[3*s+s]+1),t[n]=.5*r,r=.5/r,t[3]=(e[3*s+i]-e[3*i+s])*r,t[i]=(e[3*i+n]+e[3*n+i])*r,t[s]=(e[3*s+n]+e[3*n+s])*r}return t},d.toQuat4=m.fromRotationMatrix;var y=d.create();m.fromAxes=function(e,t,n,r){return y[0]=t[0],y[3]=t[1],y[6]=t[2],y[1]=n[0],y[4]=n[1],y[7]=n[2],y[2]=e[0],y[5]=e[1],y[8]=e[2],m.fromRotationMatrix(y,r)},m.identity=function(e){return e||(e=m.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},m.fromAngleAxis=function(e,t,n){n||(n=m.create()),e*=.5;var r=Math.sin(e);return n[3]=Math.cos(e),n[0]=r*t[0],n[1]=r*t[1],n[2]=r*t[2],n},m.toAngleAxis=function(e,t){t||(t=e);var n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];return 0<n?(t[3]=2*Math.acos(e[3]),n=r.invsqrt(n),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n):(t[3]=0,t[0]=1,t[1]=0,t[2]=0),t},m.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"};var b={create:function(e){var t=new o(2);return e?(t[0]=e[0],t[1]=e[1]):(t[0]=0,t[1]=0),t},createFrom:function(e,t){var n=new o(2);return n[0]=e,n[1]=t,n},add:function(e,t,n){return n||(n=t),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n},subtract:function(e,t,n){return n||(n=t),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n},multiply:function(e,t,n){return n||(n=t),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n},divide:function(e,t,n){return n||(n=t),n[0]=e[0]/t[0],n[1]=e[1]/t[1],n},scale:function(e,t,n){return n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n},dist:function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},set:function(e,t){return t[0]=e[0],t[1]=e[1],t},equal:function(e,t){return e===t||1e-6>Math.abs(e[0]-t[0])&&1e-6>Math.abs(e[1]-t[1])},negate:function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t},normalize:function(e,t){t||(t=e);var n=e[0]*e[0]+e[1]*e[1];return 0<n?(n=Math.sqrt(n),t[0]=e[0]/n,t[1]=e[1]/n):t[0]=t[1]=0,t},cross:function(e,t,n){return e=e[0]*t[1]-e[1]*t[0],n?(n[0]=n[1]=0,n[2]=e,n):e},length:function(e){var t=e[0];return e=e[1],Math.sqrt(t*t+e*e)},squaredLength:function(e){var t=e[0];return e=e[1],t*t+e*e},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]},direction:function(e,t,n){n||(n=e);var r=e[0]-t[0];return e=e[1]-t[1],t=r*r+e*e,t?(t=1/Math.sqrt(t),n[0]=r*t,n[1]=e*t,n):(n[0]=0,n[1]=0,n[2]=0,n)},lerp:function(e,t,n,r){return r||(r=e),r[0]=e[0]+n*(t[0]-e[0]),r[1]=e[1]+n*(t[1]-e[1]),r},str:function(e){return"["+e[0]+", "+e[1]+"]"}},w={create:function(e){var t=new o(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},createFrom:function(e,t,n,r){var i=new o(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},equal:function(e,t){return e===t||1e-6>Math.abs(e[0]-t[0])&&1e-6>Math.abs(e[1]-t[1])&&1e-6>Math.abs(e[2]-t[2])&&1e-6>Math.abs(e[3]-t[3])},identity:function(e){return e||(e=w.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},transpose:function(e,t){if(!t||e===t){var n=e[1];return e[1]=e[2],e[2]=n,e}return t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t},determinant:function(e){return e[0]*e[3]-e[2]*e[1]},inverse:function(e,t){t||(t=e);var n=e[0],r=e[1],i=e[2],s=e[3],o=n*s-i*r;return o?(o=1/o,t[0]=s*o,t[1]=-r*o,t[2]=-i*o,t[3]=n*o,t):null},multiply:function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2];return e=e[3],n[0]=r*t[0]+i*t[2],n[1]=r*t[1]+i*t[3],n[2]=s*t[0]+e*t[2],n[3]=s*t[1]+e*t[3],n},rotate:function(e,t,n){n||(n=e);var r=e[0],i=e[1],s=e[2];e=e[3];var o=Math.sin(t);return t=Math.cos(t),n[0]=r*t+i*o,n[1]=r*-o+i*t,n[2]=s*t+e*o,n[3]=s*-o+e*t,n},multiplyVec2:function(e,t,n){n||(n=t);var r=t[0];return t=t[1],n[0]=r*e[0]+t*e[1],n[1]=r*e[2]+t*e[3],n},scale:function(e,t,n){n||(n=e);var r=e[1],i=e[2],s=e[3],o=t[0];return t=t[1],n[0]=e[0]*o,n[1]=r*t,n[2]=i*o,n[3]=s*t,n},str:function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"}},E={create:function(e){var t=new o(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t},createFrom:function(e,t,n,r){var i=new o(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i},add:function(e,t,n){return n||(n=t),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},subtract:function(e,t,n){return n||(n=t),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n},multiply:function(e,t,n){return n||(n=t),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n[3]=e[3]*t[3],n},divide:function(e,t,n){return n||(n=t),n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n[3]=e[3]/t[3],n},scale:function(e,t,n){return n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},set:function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},equal:function(e,t){return e===t||1e-6>Math.abs(e[0]-t[0])&&1e-6>Math.abs(e[1]-t[1])&&1e-6>Math.abs(e[2]-t[2])&&1e-6>Math.abs(e[3]-t[3])},negate:function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},length:function(e){var t=e[0],n=e[1],r=e[2];return e=e[3],Math.sqrt(t*t+n*n+r*r+e*e)},squaredLength:function(e){var t=e[0],n=e[1],r=e[2];return e=e[3],t*t+n*n+r*r+e*e},lerp:function(e,t,n,r){return r||(r=e),r[0]=e[0]+n*(t[0]-e[0]),r[1]=e[1]+n*(t[1]-e[1]),r[2]=e[2]+n*(t[2]-e[2]),r[3]=e[3]+n*(t[3]-e[3]),r},str:function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"}};return e&&(e.glMatrixArrayType=o,e.MatrixArray=o,e.setMatrixArrayType=t,e.determineMatrixArrayType=n,e.glMath=r,e.vec2=b,e.vec3=u,e.vec4=E,e.mat2=w,e.mat3=d,e.mat4=v,e.quat4=m),{glMatrixArrayType:o,MatrixArray:o,setMatrixArrayType:t,determineMatrixArrayType:n,glMath:r,vec2:b,vec3:u,vec4:E,mat2:w,mat3:d,mat4:v,quat4:m}}),ChemDoodle.animations=function(e){var t={};return e.requestAnimFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)},t.requestInterval=function(t,n){function r(){(new Date).getTime()-i>=n&&(t.call(),i=(new Date).getTime()),s.value=e.requestAnimFrame(r)}if(!e.requestAnimationFrame&&!e.webkitRequestAnimationFrame&&(!e.mozRequestAnimationFrame||!e.mozCancelRequestAnimationFrame)&&!e.oRequestAnimationFrame&&!e.msRequestAnimationFrame)return e.setInterval(t,n);var i=(new Date).getTime(),s={};return s.value=e.requestAnimFrame(r),s},t.clearRequestInterval=function(t){e.cancelAnimationFrame?e.cancelAnimationFrame(t.value):e.webkitCancelAnimationFrame?e.webkitCancelAnimationFrame(t.value):e.webkitCancelRequestAnimationFrame?e.webkitCancelRequestAnimationFrame(t.value):e.mozCancelRequestAnimationFrame?e.mozCancelRequestAnimationFrame(t.value):e.oCancelRequestAnimationFrame?e.oCancelRequestAnimationFrame(t.value):e.msCancelRequestAnimationFrame?e.msCancelRequestAnimationFrame(t.value):clearInterval(t)},t.requestTimeout=function(t,n){function r(){(new Date).getTime()-i>=n?t.call():s.value=e.requestAnimFrame(r)}if(!e.requestAnimationFrame&&!e.webkitRequestAnimationFrame&&(!e.mozRequestAnimationFrame||!e.mozCancelRequestAnimationFrame)&&!e.oRequestAnimationFrame&&!e.msRequestAnimationFrame)return e.setTimeout(t,n);var i=(new Date).getTime(),s={};return s.value=e.requestAnimFrame(r),s},t.clearRequestTimeout=function(t){e.cancelAnimationFrame?e.cancelAnimationFrame(t.value):e.webkitCancelAnimationFrame?e.webkitCancelAnimationFrame(t.value):e.webkitCancelRequestAnimationFrame?e.webkitCancelRequestAnimationFrame(t.value):e.mozCancelRequestAnimationFrame?e.mozCancelRequestAnimationFrame(t.value):e.oCancelRequestAnimationFrame?e.oCancelRequestAnimationFrame(t.value):e.msCancelRequestAnimationFrame?e.msCancelRequestAnimationFrame(t.value):clearTimeout(t)},t}(window),ChemDoodle.extensions=function(e,t,n){return{stringStartsWith:function(e,t){return e.slice(0,t.length)===t},vec3AngleFrom:function(e,r){var i=t.length(e),s=t.length(r),i=t.dot(e,r)/i/s;return n.acos(i)},contextHashTo:function(t,n,r,i,s,o,u){var a=0,f=(new e.Point(n,r)).distance(new e.Point(i,s)),l=!1,c=n,h=r;n=i-n;for(r=s-r;a<f;){if(l){if(a+u>f){t.moveTo(i,s);break}var p=u/f,c=c+p*n,h=h+p*r;t.moveTo(c,h),a+=u}else{if(a+o>f){t.lineTo(i,s);break}p=o/f,c+=p*n,h+=p*r,t.lineTo(c,h),a+=o}l=!l}},contextRoundRect:function(e,t,n,r,i,s){e.beginPath(),e.moveTo(t+s,n),e.lineTo(t+r-s,n),e.quadraticCurveTo(t+r,n,t+r,n+s),e.lineTo(t+r,n+i-s),e.quadraticCurveTo(t+r,n+i,t+r-s,n+i),e.lineTo(t+s,n+i),e.quadraticCurveTo(t,n+i,t,n+i-s),e.lineTo(t,n+s),e.quadraticCurveTo(t,n,t+s,n),e.closePath()},contextEllipse:function(e,t,n,r,i){var s=.5522848*(r/2),o=.5522848*(i/2),u=t+r,a=n+i;r=t+r/2,i=n+i/2,e.beginPath(),e.moveTo(t,i),e.bezierCurveTo(t,i-o,r-s,n,r,n),e.bezierCurveTo(r+s,n,u,i-o,u,i),e.bezierCurveTo(u,i+o,r+s,a,r,a),e.bezierCurveTo(r-s,a,t,i+o,t,i),e.closePath()},getFontString:function(e,t,n,r){var i=[];n&&i.push("bold "),r&&i.push("italic "),i.push(e+"px "),e=0;for(n=t.length;e<n;e++)r=t[e],-1!==r.indexOf(" ")&&(r='"'+r+'"'),i.push((0!==e?",":"")+r);return i.join("")}}}(ChemDoodle.structures,ChemDoodle.lib.vec3,Math),ChemDoodle.math=function(e,t,n,r,i){var s={},o={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return s.angleBetweenLargest=function(e){if(0===e.length)return{angle:0,largest:2*i.PI};if(1===e.length)return{angle:e[0]+i.PI,largest:2*i.PI};for(var t=0,n=0,r=0,s=e.length-1;r<s;r++){var o=e[r+1]-e[r];o>t&&(t=o,n=(e[r+1]+e[r])/2)}return r=e[0]+2*i.PI-e[e.length-1],r>t&&(n=e[0]-r/2,t=r,0>n&&(n+=2*i.PI)),{angle:n,largest:t}},s.isBetween=function(e,t,n){if(t>n){var r=t;t=n,n=r}return e>=t&&e<=n},r(document).ready(function(){e&&e.iChemLabs&&e.iChemLabs.checkForUpdates&&e.iChemLabs.checkForUpdates({})}),s.getRGB=function(e,n){var r=[0,0,0];o[e.toLowerCase()]&&(e=o[e.toLowerCase()]);if("#"===e.charAt(0))return 4===e.length&&(e="#"+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)+e.charAt(3)+e.charAt(3)),[parseInt(e.substring(1,3),16)/255*n,parseInt(e.substring(3,5),16)/255*n,parseInt(e.substring(5,7),16)/255*n];if(t.stringStartsWith(e,"rgb")){var i=e.replace(/rgb\(|\)/g,"").split(",");return 3!==i.length?r:[parseInt(i[0])/255*n,parseInt(i[1])/255*n,parseInt(i[2])/255*n]}return r},s.idx2color=function(e){e=e.toString(16);for(var t=0,n=6-e.length;t<n;t++)e="0"+e;return"#"+e},s.distanceFromPointToLineInclusive=function(e,t,r){var o=t.distance(r);return r=t.angle(r),r=i.PI/2-r,r=t.angle(e)+r,e=t.distance(e),e=new n.Point(e*i.cos(r),-e*i.sin(r)),s.isBetween(-e.y,0,o)?i.abs(e.x):-1},s.calculateDistanceInterior=function(e,t,n){if(this.isBetween(t.x,n.x,n.x+n.w)&&this.isBetween(t.y,n.y,n.y+n.w))return e.distance(t);var r=[];r.push({x1:n.x,y1:n.y,x2:n.x+n.w,y2:n.y}),r.push({x1:n.x,y1:n.y+n.h,x2:n.x+n.w,y2:n.y+n.h}),r.push({x1:n.x,y1:n.y,x2:n.x,y2:n.y+n.h}),r.push({x1:n.x+n.w,y1:n.y,x2:n.x+n.w,y2:n.y+n.h}),n=[];for(var s=0;4>s;s++){var o=r[s];(o=this.intersectLines(t.x,t.y,e.x,e.y,o.x1,o.y1,o.x2,o.y2))&&n.push(o)}if(0===n.length)return 0;s=t=0;for(r=n.length;s<r;s++){var o=n[s],u=e.x-o.x,o=e.y-o.y;t=i.max(t,i.sqrt(u*u+o*o))}return t},s.intersectLines=function(e,t,n,r,i,s,o,u){n-=e,r-=t,o-=i,u-=s;var a=r*o-n*u;return 0===a?!1:(o=(u*(e-i)-o*(t-s))/a,i=(r*(e-i)-n*(t-s))/a,0<=i&&1>=i&&0<=o&&1>=o?{x:e+o*n,y:t+o*r}:!1)},s.hsl2rgb=function(e,t,n){var r=function(e,t,n){return 0>n?n+=1:1<n&&(n-=1),n<1/6?e+6*(t-e)*n:.5>n?t:n<2/3?e+6*(t-e)*(2/3-n):e};if(0===t)n=t=e=n;else{var i=.5>n?n*(1+t):n+t-n*t,s=2*n-i;n=r(s,i,e+1/3),t=r(s,i,e),e=r(s,i,e-1/3)}return[255*n,255*t,255*e]},s.isPointInPoly=function(e,t){for(var n=!1,r=-1,i=e.length,s=i-1;++r<i;s=r)(e[r].y<=t.y&&t.y<e[s].y||e[s].y<=t.y&&t.y<e[r].y)&&t.x<(e[s].x-e[r].x)*(t.y-e[r].y)/(e[s].y-e[r].y)+e[r].x&&(n=!n);return n},s.clamp=function(e,t,n){return e<t?t:e>n?n:e},s.rainbowAt=function(e,t,n){1>n.length?n.push("#000000","#FFFFFF"):2>n.length&&n.push("#FFFFFF");var r=t/(n.length-1);return t=i.floor(e/r),e=(e-t*r)/r,r=s.getRGB(n[t],1),n=s.getRGB(n[t+1],1),"rgb("+[255*(r[0]+(n[0]-r[0])*e),255*(r[1]+(n[1]-r[1])*e),255*(r[2]+(n[2]-r[2])*e)].join()+")"},s.angleBounds=function(e,t,n){for(var r=2*i.PI;0>e;)e+=r;for(;e>r;)e-=r;return n&&e>i.PI&&(e=2*i.PI-e),t&&(e=180*e/i.PI),e},s}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.lib.jQuery,Math),function(e,t){e.Bounds=function(){};var n=e.Bounds.prototype;n.minX=n.minY=n.minZ=Infinity,n.maxX=n.maxY=n.maxZ=-Infinity,n.expand=function(n,r,i,s){n instanceof e.Bounds?(this.minX=t.min(this.minX,n.minX),this.minY=t.min(this.minY,n.minY),this.maxX=t.max(this.maxX,n.maxX),this.maxY=t.max(this.maxY,n.maxY),Infinity!==n.maxZ&&(this.minZ=t.min(this.minZ,n.minZ),this.maxZ=t.max(this.maxZ,n.maxZ))):(this.minX=t.min(this.minX,n),this.maxX=t.max(this.maxX,n),this.minY=t.min(this.minY,r),this.maxY=t.max(this.maxY,r),void 0!==i&&void 0!==s&&(this.minX=t.min(this.minX,i),this.maxX=t.max(this.maxX,i),this.minY=t.min(this.minY,s),this.maxY=t.max(this.maxY,s)))},n.expand3D=function(e,n,r,i,s,o){this.minX=t.min(this.minX,e),this.maxX=t.max(this.maxX,e),this.minY=t.min(this.minY,n),this.maxY=t.max(this.maxY,n),this.minZ=t.min(this.minZ,r),this.maxZ=t.max(this.maxZ,r),void 0!==i&&void 0!==s&&void 0!==o&&(this.minX=t.min(this.minX,i),this.maxX=t.max(this.maxX,i),this.minY=t.min(this.minY,s),this.maxY=t.max(this.maxY,s),this.minZ=t.min(this.minZ,o),this.maxZ=t.max(this.maxZ,o))}}(ChemDoodle.math,Math),function(){var e={subtract:function(e,t){return{x:e.x-t.x,y:e.y-t.y}},dotProduct:function(e,t){return e
.x*t.x+e.y*t.y},square:function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},scale:function(e,t){return{x:e.x*t,y:e.y*t}}},t=Math.pow(2,-65),n=function(t,n){for(var s=[],o=n.length-1,u=2*o-1,a=[],f=[],c=[],p=[],d=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],v=0;v<=o;v++)a[v]=e.subtract(n[v],t);for(v=0;v<=o-1;v++)f[v]=e.subtract(n[v+1],n[v]),f[v]=e.scale(f[v],3);for(v=0;v<=o-1;v++)for(var m=0;m<=o;m++)c[v]||(c[v]=[]),c[v][m]=e.dotProduct(f[v],a[m]);for(v=0;v<=u;v++)p[v]||(p[v]=[]),p[v].y=0,p[v].x=parseFloat(v)/u;u=o-1;for(a=0;a<=o+u;a++){v=Math.max(0,a-u);for(f=Math.min(a,o);v<=f;v++)m=a-v,p[v+m].y+=c[m][v]*d[m][v]}o=n.length-1,p=r(p,2*o-1,s,0),u=e.subtract(t,n[0]),c=e.square(u);for(v=d=0;v<p;v++)u=e.subtract(t,i(n,o,s[v],null,null)),u=e.square(u),u<c&&(c=u,d=s[v]);return u=e.subtract(t,n[o]),u=e.square(u),u<c&&(c=u,d=1),{location:d,distance:c}},r=function(e,n,s,o){var u=[],a=[],f=[],c=[],p=0,d,v;v=0==e[0].y?0:0<e[0].y?1:-1;for(var m=1;m<=n;m++)d=0==e[m].y?0:0<e[m].y?1:-1,d!=v&&p++,v=d;switch(p){case 0:return 0;case 1:if(64<=o)return s[0]=(e[0].x+e[n].x)/2,1;var g,y,b,p=e[0].y-e[n].y;d=e[n].x-e[0].x,v=e[0].x*e[n].y-e[n].x*e[0].y,m=g=0;for(y=1;y<n;y++)b=p*e[y].x+d*e[y].y+v,b>g?g=b:b<m&&(m=b);b=d,y=0*b-1*p,g=(1*(v-g)-0*b)*(1/y),b=d,y=0*b-1*p,p=(1*(v-m)-0*b)*(1/y),d=Math.min(g,p);if(Math.max(g,p)-d<t)return f=e[n].x-e[0].x,c=e[n].y-e[0].y,s[0]=0+1*(f*(e[0].y-0)-c*(e[0].x-0))*(1/(0*f-1*c)),1}i(e,n,.5,u,a),e=r(u,n,f,o+1),n=r(a,n,c,o+1);for(o=0;o<e;o++)s[o]=f[o];for(o=0;o<n;o++)s[o+e]=c[o];return e+n},i=function(e,t,n,r,i){for(var s=[[]],o=0;o<=t;o++)s[0][o]=e[o];for(e=1;e<=t;e++)for(o=0;o<=t-e;o++)s[e]||(s[e]=[]),s[e][o]||(s[e][o]={}),s[e][o].x=(1-n)*s[e-1][o].x+n*s[e-1][o+1].x,s[e][o].y=(1-n)*s[e-1][o].y+n*s[e-1][o+1].y;if(null!=r)for(o=0;o<=t;o++)r[o]=s[o][0];if(null!=i)for(o=0;o<=t;o++)i[o]=s[t-o][o];return s[t][0]},s={},o=function(e,t){var n,r=e.length-1;n=s[r];if(!n){n=[];var i=function(e){return function(){return e}},o=function(){return function(e){return e}},u=function(){return function(e){return 1-e}},a=function(e){return function(t){for(var n=1,r=0;r<e.length;r++)n*=e[r](t);return n}};n.push(new function(){return function(e){return Math.pow(e,r)}});for(var f=1;f<r;f++){for(var l=[new i(r)],c=0;c<r-f;c++)l.push(new o);for(c=0;c<f;c++)l.push(new u);n.push(new a(l))}n.push(new function(){return function(e){return Math.pow(1-e,r)}}),s[r]=n}for(u=o=i=0;u<e.length;u++)i+=e[u].x*n[u](t),o+=e[u].y*n[u](t);return{x:i,y:o}},u=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},a=function(e,t,n){for(var r=o(e,t),i=0,s=0<n?1:-1,a=null;i<Math.abs(n);)t+=.005*s,a=o(e,t),i+=u(a,r),r=a;return{point:a,location:t}},f=function(e,t){var n=o(e,t),r=o(e.slice(0,e.length-1),t),i=r.y-n.y,n=r.x-n.x;return 0==i?Infinity:Math.atan(i/n)};ChemDoodle.math.jsBezier={distanceFromCurve:n,gradientAtPoint:f,gradientAtPointAlongCurveFrom:function(e,t,n){return t=a(e,t,n),1<t.location&&(t.location=1),0>t.location&&(t.location=0),f(e,t.location)},nearestPointOnCurve:function(e,t){var r=n(e,t);return{point:i(t,t.length-1,r.location,null,null),location:r.location}},pointOnCurve:o,pointAlongCurveFrom:function(e,t,n){return a(e,t,n).point},perpendicularToCurveAt:function(e,t,n,r){return t=a(e,t,null==r?0:r),e=f(e,t.location),r=Math.atan(-1/e),e=n/2*Math.sin(r),n=n/2*Math.cos(r),[{x:t.point.x+n,y:t.point.y+e},{x:t.point.x-n,y:t.point.y-e}]},locationAlongCurveFrom:function(e,t,n){return a(e,t,n).location},getLength:function(e){for(var t=o(e,0),n=0,r=0,i=null;1>r;)r+=.005,i=o(e,r),n+=u(i,t),t=i;return n}}}(ChemDoodle.math),ChemDoodle.featureDetection=function(e,t,n,r){var i={supports_canvas:function(){return!!n.createElement("canvas").getContext},supports_canvas_text:function(){return i.supports_canvas()?"function"==typeof n.createElement("canvas").getContext("2d").fillText:!1},supports_webgl:function(){var e=n.createElement("canvas");try{if(e.getContext("webgl")||e.getContext("experimental-webgl"))return!0}catch(t){}return!1},supports_xhr2:function(){return t.support.cors},supports_touch:function(){return"ontouchstart"in r&&navigator.userAgent.match(/iPhone|iPad|iPod|Android|BlackBerry|BB10/i)},supports_gesture:function(){return"ongesturestart"in r}};return i}(ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document,window),ChemDoodle.SYMBOLS="H He Li Be B C N O F Ne Na Mg Al Si P S Cl Ar K Ca Sc Ti V Cr Mn Fe Co Ni Cu Zn Ga Ge As Se Br Kr Rb Sr Y Zr Nb Mo Tc Ru Rh Pd Ag Cd In Sn Sb Te I Xe Cs Ba La Ce Pr Nd Pm Sm Eu Gd Tb Dy Ho Er Tm Yb Lu Hf Ta W Re Os Ir Pt Au Hg Tl Pb Bi Po At Rn Fr Ra Ac Th Pa U Np Pu Am Cm Bk Cf Es Fm Md No Lr Rf Db Sg Bh Hs Mt Ds Rg Cn Uut Uuq Uup Uuh Uus Uuo".split(" "),ChemDoodle.ELEMENT=function(){function e(e,t,n,r,i,s,o,u,a){this.symbol=e,this.name=t,this.atomicNumber=n,this.addH=r,this.jmolColor=this.pymolColor=i,this.covalentRadius=s,this.vdWRadius=o,this.valency=u,this.mass=a}var t=[];return t.H=new e("H","Hydrogen",1,!1,"#FFFFFF",.31,1.2,1,1),t.He=new e("He","Helium",2,!1,"#D9FFFF",.28,1.4,0,4),t.Li=new e("Li","Lithium",3,!1,"#CC80FF",1.28,1.82,1,7),t.Be=new e("Be","Beryllium",4,!1,"#C2FF00",.96,0,2,9),t.B=new e("B","Boron",5,!0,"#FFB5B5",.84,0,3,11),t.C=new e("C","Carbon",6,!0,"#909090",.76,1.7,4,12),t.N=new e("N","Nitrogen",7,!0,"#3050F8",.71,1.55,3,14),t.O=new e("O","Oxygen",8,!0,"#FF0D0D",.66,1.52,2,16),t.F=new e("F","Fluorine",9,!0,"#90E050",.57,1.47,1,19),t.Ne=new e("Ne","Neon",10,!1,"#B3E3F5",.58,1.54,0,20),t.Na=new e("Na","Sodium",11,!1,"#AB5CF2",1.66,2.27,1,23),t.Mg=new e("Mg","Magnesium",12,!1,"#8AFF00",1.41,1.73,0,24),t.Al=new e("Al","Aluminum",13,!1,"#BFA6A6",1.21,0,0,27),t.Si=new e("Si","Silicon",14,!0,"#F0C8A0",1.11,2.1,4,28),t.P=new e("P","Phosphorus",15,!0,"#FF8000",1.07,1.8,3,31),t.S=new e("S","Sulfur",16,!0,"#FFFF30",1.05,1.8,2,32),t.Cl=new e("Cl","Chlorine",17,!0,"#1FF01F",1.02,1.75,1,35),t.Ar=new e("Ar","Argon",18,!1,"#80D1E3",1.06,1.88,0,40),t.K=new e("K","Potassium",19,!1,"#8F40D4",2.03,2.75,0,39),t.Ca=new e("Ca","Calcium",20,!1,"#3DFF00",1.76,0,0,40),t.Sc=new e("Sc","Scandium",21,!1,"#E6E6E6",1.7,0,0,45),t.Ti=new e("Ti","Titanium",22,!1,"#BFC2C7",1.6,0,1,48),t.V=new e("V","Vanadium",23,!1,"#A6A6AB",1.53,0,1,51),t.Cr=new e("Cr","Chromium",24,!1,"#8A99C7",1.39,0,2,52),t.Mn=new e("Mn","Manganese",25,!1,"#9C7AC7",1.39,0,3,55),t.Fe=new e("Fe","Iron",26,!1,"#E06633",1.32,0,2,56),t.Co=new e("Co","Cobalt",27,!1,"#F090A0",1.26,0,1,59),t.Ni=new e("Ni","Nickel",28,!1,"#50D050",1.24,1.63,1,58),t.Cu=new e("Cu","Copper",29,!1,"#C88033",1.32,1.4,0,63),t.Zn=new e("Zn","Zinc",30,!1,"#7D80B0",1.22,1.39,0,64),t.Ga=new e("Ga","Gallium",31,!1,"#C28F8F",1.22,1.87,0,69),t.Ge=new e("Ge","Germanium",32,!1,"#668F8F",1.2,0,4,74),t.As=new e("As","Arsenic",33,!0,"#BD80E3",1.19,1.85,3,75),t.Se=new e("Se","Selenium",34,!0,"#FFA100",1.2,1.9,2,80),t.Br=new e("Br","Bromine",35,!0,"#A62929",1.2,1.85,1,79),t.Kr=new e("Kr","Krypton",36,!1,"#5CB8D1",1.16,2.02,0,84),t.Rb=new e("Rb","Rubidium",37,!1,"#702EB0",2.2,0,0,85),t.Sr=new e("Sr","Strontium",38,!1,"#00FF00",1.95,0,0,88),t.Y=new e("Y","Yttrium",39,!1,"#94FFFF",1.9,0,0,89),t.Zr=new e("Zr","Zirconium",40,!1,"#94E0E0",1.75,0,0,90),t.Nb=new e("Nb","Niobium",41,!1,"#73C2C9",1.64,0,1,93),t.Mo=new e("Mo","Molybdenum",42,!1,"#54B5B5",1.54,0,2,98),t.Tc=new e("Tc","Technetium",43,!1,"#3B9E9E",1.47,0,3,0),t.Ru=new e("Ru","Ruthenium",44,!1,"#248F8F",1.46,0,2,102),t.Rh=new e("Rh","Rhodium",45,!1,"#0A7D8C",1.42,0,1,103),t.Pd=new e("Pd","Palladium",46,!1,"#006985",1.39,1.63,0,106),t.Ag=new e("Ag","Silver",47,!1,"#C0C0C0",1.45,1.72,0,107),t.Cd=new e("Cd","Cadmium",48,!1,"#FFD98F",1.44,1.58,0,114),t.In=new e("In","Indium",49,!1,"#A67573",1.42,1.93,0,115),t.Sn=new e("Sn","Tin",50,!1,"#668080",1.39,2.17,4,120),t.Sb=new e("Sb","Antimony",51,!1,"#9E63B5",1.39,0,3,121),t.Te=new e("Te","Tellurium",52,!0,"#D47A00",1.38,2.06,2,130),t.I=new e("I","Iodine",53,!0,"#940094",1.39,1.98,1,127),t.Xe=new e("Xe","Xenon",54,!1,"#429EB0",1.4,2.16,0,132),t.Cs=new e("Cs","Cesium",55,!1,"#57178F",2.44,0,0,133),t.Ba=new e("Ba","Barium",56,!1,"#00C900",2.15,0,0,138),t.La=new e("La","Lanthanum",57,!1,"#70D4FF",2.07,0,0,139),t.Ce=new e("Ce","Cerium",58,!1,"#FFFFC7",2.04,0,0,140),t.Pr=new e("Pr","Praseodymium",59,!1,"#D9FFC7",2.03,0,0,141),t.Nd=new e("Nd","Neodymium",60,!1,"#C7FFC7",2.01,0,0,142),t.Pm=new e("Pm","Promethium",61,!1,"#A3FFC7",1.99,0,0,0),t.Sm=new e("Sm","Samarium",62,!1,"#8FFFC7",1.98,0,0,152),t.Eu=new e("Eu","Europium",63,!1,"#61FFC7",1.98,0,0,153),t.Gd=new e("Gd","Gadolinium",64,!1,"#45FFC7",1.96,0,0,158),t.Tb=new e("Tb","Terbium",65,!1,"#30FFC7",1.94,0,0,159),t.Dy=new e("Dy","Dysprosium",66,!1,"#1FFFC7",1.92,0,0,164),t.Ho=new e("Ho","Holmium",67,!1,"#00FF9C",1.92,0,0,165),t.Er=new e("Er","Erbium",68,!1,"#00E675",1.89,0,0,166),t.Tm=new e("Tm","Thulium",69,!1,"#00D452",1.9,0,0,169),t.Yb=new e("Yb","Ytterbium",70,!1,"#00BF38",1.87,0,0,174),t.Lu=new e("Lu","Lutetium",71,!1,"#00AB24",1.87,0,0,175),t.Hf=new e("Hf","Hafnium",72,!1,"#4DC2FF",1.75,0,0,180),t.Ta=new e("Ta","Tantalum",73,!1,"#4DA6FF",1.7,0,1,181),t.W=new e("W","Tungsten",74,!1,"#2194D6",1.62,0,2,184),t.Re=new e("Re","Rhenium",75,!1,"#267DAB",1.51,0,3,187),t.Os=new e("Os","Osmium",76,!1,"#266696",1.44,0,2,192),t.Ir=new e("Ir","Iridium",77,!1,"#175487",1.41,0,3,193),t.Pt=new e("Pt","Platinum",78,!1,"#D0D0E0",1.36,1.75,0,195),t.Au=new e("Au","Gold",79,!1,"#FFD123",1.36,1.66,1,197),t.Hg=new e("Hg","Mercury",80,!1,"#B8B8D0",1.32,1.55,0,202),t.Tl=new e("Tl","Thallium",81,!1,"#A6544D",1.45,1.96,0,205),t.Pb=new e("Pb","Lead",82,!1,"#575961",1.46,2.02,4,208),t.Bi=new e("Bi","Bismuth",83,!1,"#9E4FB5",1.48,0,3,209),t.Po=new e("Po","Polonium",84,!1,"#AB5C00",1.4,0,2,0),t.At=new e("At","Astatine",85,!0,"#754F45",1.5,0,1,0),t.Rn=new e("Rn","Radon",86,!1,"#428296",1.5,0,0,0),t.Fr=new e("Fr","Francium",87,!1,"#420066",2.6,0,0,0),t.Ra=new e("Ra","Radium",88,!1,"#007D00",2.21,0,0,0),t.Ac=new e("Ac","Actinium",89,!1,"#70ABFA",2.15,0,0,0),t.Th=new e("Th","Thorium",90,!1,"#00BAFF",2.06,0,0,232),t.Pa=new e("Pa","Protactinium",91,!1,"#00A1FF",2,0,0,231),t.U=new e("U","Uranium",92,!1,"#008FFF",1.96,1.86,0,238),t.Np=new e("Np","Neptunium",93,!1,"#0080FF",1.9,0,0,0),t.Pu=new e("Pu","Plutonium",94,!1,"#006BFF",1.87,0,0,0),t.Am=new e("Am","Americium",95,!1,"#545CF2",1.8,0,0,0),t.Cm=new e("Cm","Curium",96,!1,"#785CE3",1.69,0,0,0),t.Bk=new e("Bk","Berkelium",97,!1,"#8A4FE3",0,0,0,0),t.Cf=new e("Cf","Californium",98,!1,"#A136D4",0,0,0,0),t.Es=new e("Es","Einsteinium",99,!1,"#B31FD4",0,0,0,0),t.Fm=new e("Fm","Fermium",100,!1,"#B31FBA",0,0,0,0),t.Md=new e("Md","Mendelevium",101,!1,"#B30DA6",0,0,0,0),t.No=new e("No","Nobelium",102,!1,"#BD0D87",0,0,0,0),t.Lr=new e("Lr","Lawrencium",103,!1,"#C70066",0,0,0,0),t.Rf=new e("Rf","Rutherfordium",104,!1,"#CC0059",0,0,0,0),t.Db=new e("Db","Dubnium",105,!1,"#D1004F",0,0,0,0),t.Sg=new e("Sg","Seaborgium",106,!1,"#D90045",0,0,0,0),t.Bh=new e("Bh","Bohrium",107,!1,"#E00038",0,0,0,0),t.Hs=new e("Hs","Hassium",108,!1,"#E6002E",0,0,0,0),t.Mt=new e("Mt","Meitnerium",109,!1,"#EB0026",0,0,0,0),t.Ds=new e("Ds","Darmstadtium",110,!1,"#000000",0,0,0,0),t.Rg=new e("Rg","Roentgenium",111,!1,"#000000",0,0,0,0),t.Cn=new e("Cn","Copernicium",112,!1,"#000000",0,0,0,0),t.Uut=new e("Uut","Ununtrium",113,!1,"#000000",0,0,0,0),t.Uuq=new e("Uuq","Ununquadium",114,!1,"#000000",0,0,0,0),t.Uup=new e("Uup","Ununpentium",115,!1,"#000000",0,0,0,0),t.Uuh=new e("Uuh","Ununhexium",116,!1,"#000000",0,0,0,0),t.Uus=new e("Uus","Ununseptium",117,!1,"#000000",0,0,0,0),t.Uuo=new e("Uuo","Ununoctium",118,!1,"#000000",0,0,0,0),t.H.pymolColor="#E6E6E6",t.C.pymolColor="#33FF33",t.N.pymolColor="#3333FF",t.O.pymolColor="#FF4D4D",t.F.pymolColor="#B3FFFF",t.S.pymolColor="#E6C640",t}(ChemDoodle.SYMBOLS),ChemDoodle.RESIDUE=function(){function e(e,t,n,r,i,s){this.symbol=e,this.name=t,this.polar=n,this.aminoColor=r,this.shapelyColor=i,this.acidity=s}var t=[];return t.Ala=new e("Ala","Alanine",!1,"#C8C8C8","#8CFF8C",0),t.Arg=new e("Arg","Arginine",!0,"#145AFF","#00007C",1),t.Asn=new e("Asn","Asparagine",!0,"#00DCDC","#FF7C70",0),t.Asp=new e("Asp","Aspartic Acid",!0,"#E60A0A","#A00042",-1),t.Cys=new e("Cys","Cysteine",!0,"#E6E600","#FFFF70",0),t.Gln=new e("Gln","Glutamine",!0,"#00DCDC","#FF4C4C",0),t.Glu=new e("Glu","Glutamic Acid",!0,"#E60A0A","#660000",-1),t.Gly=new e("Gly","Glycine",!1,"#EBEBEB","#FFFFFF",0),t.His=new e("His","Histidine",!0,"#8282D2","#7070FF",1),t.Ile=new e("Ile","Isoleucine",!1,"#0F820F","#004C00",0),t.Leu=new e("Leu","Leucine",!1,"#0F820F","#455E45",0),t.Lys=new e("Lys","Lysine",!0,"#145AFF","#4747B8",1),t.Met=new e("Met","Methionine",!1,"#E6E600","#B8A042",0),t.Phe=new e("Phe","Phenylalanine",!1,"#3232AA","#534C52",0),t.Pro=new e("Pro","Proline",!1,"#DC9682","#525252",0),t.Ser=new e("Ser","Serine",!0,"#FA9600","#FF7042",0),t.Thr=new e("Thr","Threonine",!0,"#FA9600","#B84C00",0),t.Trp=new e("Trp","Tryptophan",!0,"#B45AB4","#4F4600",0),t.Tyr=new e("Tyr","Tyrosine",!0,"#3232AA","#8C704C",0),t.Val=new e("Val","Valine",!1,"#0F820F","#FF8CFF",0),t.Asx=new e("Asx","Asparagine/Aspartic Acid",!0,"#FF69B4","#FF00FF",0),t.Glx=new e("Glx","Glutamine/Glutamic Acid",!0,"#FF69B4","#FF00FF",0),t["*"]=new e("*","Other",!1,"#BEA06E","#FF00FF",0),t.A=new e("A","Adenine",!1,"#BEA06E","#A0A0FF",0),t.G=new e("G","Guanine",!1,"#BEA06E","#FF7070",0),t.I=new e("I","",!1,"#BEA06E","#80FFFF",0),t.C=new e("C","Cytosine",!1,"#BEA06E","#FF8C4B",0),t.T=new e("T","Thymine",!1,"#BEA06E","#A0FFA0",0),t.U=new e("U","Uracil",!1,"#BEA06E","#FF8080",0),t}(),function(e){e.Queue=function(){this.queue=[]},e=e.Queue.prototype,e.queueSpace=0,e.getSize=function(){return this.queue.length-this.queueSpace},e.isEmpty=function(){return 0===this.queue.length},e.enqueue=function(e){this.queue.push(e)},e.dequeue=function(){var e;return this.queue.length&&(e=this.queue[this.queueSpace],2*++this.queueSpace>=this.queue.length&&(this.queue=this.queue.slice(this.queueSpace),this.queueSpace=0)),e},e.getOldestElement=function(){var e;return this.queue.length&&(e=this.queue[this.queueSpace]),e}}(ChemDoodle.structures),function(e,t){e.Point=function(e,t){this.x=e?e:0,this.y=t?t:0};var n=e.Point.prototype;n.sub=function(e){this.x-=e.x,this.y-=e.y},n.add=function(e){this.x+=e.x,this.y+=e.y},n.distance=function(e){var n=e.x-this.x;return e=e.y-this.y,t.sqrt(n*n+e*e)},n.angleForStupidCanvasArcs=function(e){var n=e.x-this.x;e=e.y-this.y;for(var r=0,r=0===n?0===e?0:0<e?t.PI/2:3*t.PI/2:0===e?0<n?0:t.PI:0>n?t.atan(e/n)+t.PI:0>e?t.atan(e/n)+2*t.PI:t.atan(e/n);0>r;)r+=2*t.PI;return r%=2*t.PI},n.angle=function(e){var n=e.x-this.x;e=this.y-e.y;for(var r=0,r=0===n?0===e?0:0<e?t.PI/2:3*t.PI/2:0===e?0<n?0:t.PI:0>n?t.atan(e/n)+t.PI:0>e?t.atan(e/n)+2*t.PI:t.atan(e/n);0>r;)r+=2*t.PI;return r%=2*t.PI}}(ChemDoodle.structures,Math),function(e,t){var n=/[ ,]+/,r=/\-+/,i=["Helvetica","Arial","Dialog"];t.Query=function(e){this.type=e,this.elements={v:[],not:!1},this.saturation=this.hydrogens=this.connectivityNoH=this.connectivity=this.chirality=this.charge=void 0,this.orders={v:[],not:!1},this.cache=this.ringCount=this.aromatic=this.stereo=void 0},t.Query.TYPE_ATOM=0,t.Query.TYPE_BOND=1;var s=t.Query.prototype;s.parseRange=function(e){var t=[];e=e.split(n);for(var i=0,s=e.length;i<s;i++){var u=e[i],a=!1,f=!1;"-"===u.charAt(0)&&(a=!0,u=u.substring(1)),-1!=u.indexOf("--")&&(f=!0),-1!=u.indexOf("-")?(u=u.split(r),a={x:parseInt(u[0])*(a?-1:1),y:parseInt(u[1])*(f?-1:1)},a.y<a.x&&(f=a.y,a.y=a.x,a.x=f),t.push(a)):t.push({x:parseInt(u)*(a?-1:1)})}return t},s.draw=function(t,n,r){this.cache||(this.cache=this.toString());var s=this.cache,o=void 0,u=s.indexOf("(");-1!=u&&(s=this.cache.substring(0,u),o=this.cache.substring(u,this.cache.length)),t.textAlign="center",t.textBaseline="middle",t.font=e.getFontString(12,i,!0,!1),u=t.measureText(s).width,t.fillStyle=n.backgroundColor,t.fillRect(r.x-u/2,r.y-6,u,12),t.fillStyle="black",t.fillText(s,r.x,r.y),o&&(t.font=e.getFontString(10,i,!1,!0),u=t.measureText(o).width,t.fillStyle=n.backgroundColor,t.fillRect(r.x-u/2,r.y+6,u,11),t.fillStyle="black",t.fillText(o,r.x,r.y+11))},s.outputRange=function(e){for(var t=!1,n=[],r=0,i=e.length;r<i;r++){t&&n.push(",");var t=!0,s=e[r];s.y?(n.push(s.x),n.push("-"),n.push(s.y)):n.push(s.x)}return n.join("")},s.toString=function(){var e=[],n=[];return this.type===t.Query.TYPE_ATOM?(!this.elements||0===this.elements.v.length?e.push("[a]"):(this.elements.not&&e.push("!"),e.push("["),e.push(this.elements.v.join(",")),e.push("]")),this.chirality&&n.push((this.chirality.not?"!":"")+"@="+this.chirality.v),this.aromatic&&n.push((this.aromatic.not?"!":"")+"A"),this.charge&&n.push((this.charge.not?"!":"")+"C="+this.outputRange(this.charge.v)),this.hydrogens&&n.push((this.hydrogens.not?"!":"")+"H="+this.outputRange(this.hydrogens.v)),this.ringCount&&n.push((this.ringCount.not?"!":"")+"R="+this.outputRange(this.ringCount.v)),this.saturation&&n.push((this.saturation.not?"!":"")+"S"),this.connectivity&&n.push((this.connectivity.not?"!":"")+"X="+this.outputRange(this.connectivity.v)),this.connectivityNoH&&n.push((this.connectivityNoH.not?"!":"")+"x="+this.outputRange(this.connectivityNoH.v))):this.type===t.Query.TYPE_BOND&&(!this.orders||0===this.orders.v.length?e.push("[a]"):(this.orders.not&&e.push("!"),e.push("["),e.push(this.orders.v.join(",")),e.push("]")),this.stereo&&n.push((this.stereo.not?"!":"")+"@="+this.stereo.v),this.aromatic&&n.push((this.aromatic.not?"!":"")+"A"),this.ringCount&&n.push((this.ringCount.not?"!":"")+"R="+this.outputRange(this.ringCount.v))),0<n.length&&(e.push("("),e.push(n.join(",")),e.push(")")),e.join("")}}(ChemDoodle.extensions,ChemDoodle.structures,Math),function(e,t,n,r,i,s){r.Atom=function(t,n,r,i){this.label=t?t.replace(/\s/g,""):"C",e[this.label]||(this.label="C"),this.x=n?n:0,this.y=r?r:0,this.z=i?i:0},r=r.Atom.prototype=new r.Point(0,0),r.charge=0,r.numLonePair=0,r.numRadical=0,r.mass=-1,r.coordinationNumber=0,r.bondNumber=0,r.angleOfLeastInterference=0,r.isHidden=!1,r.altLabel=void 0,r.isLone=!1,r.isHover=!1,r.isSelected=!1,r.add3D=function(e){this.x+=e.x,this.y+=e.y,this.z+=e.z},r.sub3D=function(e){this.x-=e.x,this.y-=e.y,this.z-=e.z},r.distance3D=function(e){var t=e.x-this.x,n=e.y-this.y;return e=e.z-this.z,i.sqrt(t*t+n*n+e*e)},r.draw=function(e,r){if(this.isLassoed){var s=e.createRadialGradient(this.x-1,this.y-1,0,this.x,this.y,7);s.addColorStop(0,"rgba(212, 99, 0, 0)"),s.addColorStop(.7,"rgba(212, 99, 0, 0.8)"),e.fillStyle=s,e.beginPath(),e.arc(this.x,this.y,5,0,2*i.PI,!1),e.fill()}if(!this.query){this.textBounds=[],this.specs&&(r=this.specs);var u=t.getFontString(r.atoms_font_size_2D,r.atoms_font_families_2D,r.atoms_font_bold_2D,r.atoms_font_italic_2D);e.font=u,e.fillStyle=this.getElementColor(r.atoms_useJMOLColors,r.atoms_usePYMOLColors,r.atoms_color,2),"H"===this.label&&r.atoms_HBlack_2D&&(e.fillStyle="black");var a;if(this.isLone&&!r.atoms_displayAllCarbonLabels_2D||r.atoms_circles_2D)e.beginPath(),e.arc(this.x,this.y,r.atoms_circleDiameter_2D/2,0,2*i.PI,!1),e.fill(),0<r.atoms_circleBorderWidth_2D&&(e.lineWidth=r.atoms_circleBorderWidth_2D,e.strokeStyle="black",e.stroke());else if(this.isLabelVisible(r))if(e.textAlign="center",e.textBaseline="middle",void 0!==this.altLabel){e.fillText(this.altLabel,this.x,this.y);var f=e.measureText(this.altLabel).width;this.textBounds.push({x:this.x-f/2,y:this.y-r.atoms_font_size_2D/2+1,w:f,h:r.atoms_font_size_2D-2})}else{e.fillText(this.label,this.x,this.y),f=e.measureText(this.label).width,this.textBounds.push({x:this.x-f/2,y:this.y-r.atoms_font_size_2D/2+1,w:f,h:r.atoms_font_size_2D-2});var l=0;-1!==this.mass&&(s=e.font,e.font=t.getFontString(.7*r.atoms_font_size_2D,r.atoms_font_families_2D,r.atoms_font_bold_2D,r.atoms_font_italic_2D),l=e.measureText(this.mass).width,e.fillText(this.mass,this.x-l-.5,this.y-r.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x-f/2-l-.5,y:this.y-1.7*r.atoms_font_size_2D/2+1,w:l,h:r.atoms_font_size_2D/2-1}),e.font=s);var s=f/2,c=this.getImplicitHydrogenCount();if(r.atoms_implicitHydrogens_2D&&0<c){a=0;var p=e.measureText("H").width,d=!0;if(1<c){var v=f/2+p/2,m=0,g=t.getFontString(.8*r.atoms_font_size_2D,r.atoms_font_families_2D,r.atoms_font_bold_2D,r.atoms_font_italic_2D);e.font=g;var y=e.measureText(c).width;1===this.bondNumber?this.angleOfLeastInterference>i.PI/2&&this.angleOfLeastInterference<3*i.PI/2&&(v=-f/2-y-p/2-l/2,d=!1,a=i.PI):this.angleOfLeastInterference<=i.PI/4||(this.angleOfLeastInterference<3*i.PI/4?(v=0,m=.9*-r.atoms_font_size_2D,0!==this.charge&&(m-=.3*r.atoms_font_size_2D),d=!1,a=i.PI/2):this.angleOfLeastInterference<=5*i.PI/4?(v=-f/2-y-p/2-l/2,d=!1,a=i.PI):this.angleOfLeastInterference<7*i.PI/4&&(v=0,m=.9*r.atoms_font_size_2D,d=!1,a=3*i.PI/2)),e.font=u,e.fillText("H",this.x+v,this.y+m),e.font=g,e.fillText(c,this.x+v+p/2+y/2,this.y+m+.3*r.atoms_font_size_2D),this.textBounds.push({x:this.x+v-p/2,y:this.y+m-r.atoms_font_size_2D/2+1,w:p,h:r.atoms_font_size_2D-2}),this.textBounds.push({x:this.x+v+p/2,y:this.y+m+.3*r.atoms_font_size_2D-r.atoms_font_size_2D/2+1,w:y,h:.8*r.atoms_font_size_2D-2})}else v=f/2+p/2,m=0,1===this.bondNumber?this.angleOfLeastInterference>i.PI/2&&this.angleOfLeastInterference<3*i.PI/2&&(v=-f/2-p/2-l/2,d=!1,a=i.PI):this.angleOfLeastInterference<=i.PI/4||(this.angleOfLeastInterference<3*i.PI/4?(v=0,m=.9*-r.atoms_font_size_2D,d=!1,a=i.PI/2):this.angleOfLeastInterference<=5*i.PI/4?(v=-f/2-p/2-l/2,d=!1,a=i.PI):this.angleOfLeastInterference<7*i.PI/4&&(v=0,m=.9*r.atoms_font_size_2D,d=!1,a=3*i.PI/2)),e.fillText("H",this.x+v,this.y+m),this.textBounds.push({x:this.x+v-p/2,y:this.y+m-r.atoms_font_size_2D/2+1,w:p,h:r.atoms_font_size_2D-2});d&&(s+=p)}0!==this.charge&&(u=this.charge.toFixed(0),u="1"===u?"+":"-1"===u?"–":t.stringStartsWith(u,"-")?u.substring(1)+"–":u+"+",f=e.measureText(u).width,s+=f/2,e.textAlign="center",e.textBaseline="middle",e.font=t.getFontString(i.floor(.8*r.atoms_font_size_2D),r.atoms_font_families_2D,r.atoms_font_bold_2D,r.atoms_font_italic_2D),e.fillText(u,this.x+s-1,this.y-r.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x+s-f/2-1,y:this.y-1.8*r.atoms_font_size_2D/2+5,w:f,h:r.atoms_font_size_2D/2-1}))}if(0<this.numLonePair||0<this.numRadical){e.fillStyle="black",c=this.angles.slice(0),s=this.angleOfLeastInterference,u=this.largestAngle,void 0!==a&&(c.push(a),c.sort(),u=n.angleBetweenLargest(c),s=u.angle%(2*i.PI),u=u.largest),f=[];for(l=0;l<this.numLonePair;l++)f.push({t:2});for(l=0;l<this.numRadical;l++)f.push({t:1});if(void 0===a&&i.abs(u-2*i.PI/c.length)<i.PI/60){c=i.ceil(f.length/c.length),l=0;for(p=f.length;l<p;l+=c,s+=u)this.drawElectrons(e,r,f.slice(l,i.min(f.length,l+c)),s,u,a)}else this.drawElectrons(e,r,f,s,u,a)}}},r.drawElectrons=function(e,t,n,r,s,o){o=s/(n.length+(0===this.bonds.length&&void 0===o?0:1)),s=r-s/2+o;for(var u=0;u<n.length;u++){var a=n[u];r=s+u*o;var f=this.x+Math.cos(r)*t.atoms_lonePairDistance_2D,l=this.y-Math.sin(r)*t.atoms_lonePairDistance_2D;2===a.t?(a=r+Math.PI/2,r=Math.cos(a)*t.atoms_lonePairSpread_2D/2,a=-Math.sin(a)*t.atoms_lonePairSpread_2D/2,e.beginPath(),e.arc(f+r,l+a,t.atoms_lonePairDiameter_2D,0,2*i.PI,!1),e.fill(),e.beginPath(),e.arc(f-r,l-a,t.atoms_lonePairDiameter_2D,0,2*i.PI,!1),e.fill()):1===a.t&&(e.beginPath(),e.arc(f,l,t.atoms_lonePairDiameter_2D,0,2*i.PI,!1),e.fill())}},r.drawDecorations=function(e){if(this.isHover||this.isSelected)e.strokeStyle=this.isHover?"#885110":"#0060B2",e.lineWidth=1.2,e.beginPath(),e.arc(this.x,this.y,this.isHover?7:15,0,2*i.PI,!1),e.stroke();this.isOverlap&&(e.strokeStyle="#C10000",e.lineWidth=1.2,e.beginPath(),e.arc(this.x,this.y,7,0,2*i.PI,!1),e.stroke())},r.render=function(t,n,r){this.specs&&(n=this.specs);var i=s.translate(t.modelViewMatrix,[this.x,this.y,this.z],[]),o=n.atoms_useVDWDiameters_3D?e[this.label].vdWRadius*n.atoms_vdwMultiplier_3D:n.atoms_sphereDiameter_3D/2;0===o&&(o=1),s.scale(i,[o,o,o]),r||(r=n.atoms_color,n.atoms_useJMOLColors?r=e[this.label].jmolColor:n.atoms_usePYMOLColors&&(r=e[this.label].pymolColor),t.material.setDiffuseColor(r)),t.setMatrixUniforms(i),t.drawElements(t.TRIANGLES,(this.renderAsStar?t.starBuffer:t.sphereBuffer).vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)},r.renderHighlight=function(t,n){if(this.isSelected||this.isHover){this.specs&&(n=this.specs);var r=s.translate(t.modelViewMatrix,[this.x,this.y,this.z],[]),i=n.atoms_useVDWDiameters_3D?e[this.label].vdWRadius*n.atoms_vdwMultiplier_3D:n.atoms_sphereDiameter_3D/2;0===i&&(i=1),i*=1.3,s.scale(r,[i,i,i]),t.setMatrixUniforms(r),t.material.setDiffuseColor(this.isHover?"#885110":"#0060B2"),t.drawElements(t.TRIANGLES,(this.renderAsStar?t.starBuffer:t.sphereBuffer).vertexIndexBuffer.numItems,t.UNSIGNED_SHORT,0)}},r.isLabelVisible=function(e){return e.atoms_displayAllCarbonLabels_2D||"C"!==this.label||this.altLabel||-1!==this.mass||0!==this.charge||e.atoms_showAttributedCarbons_2D&&(0!==this.numRadical||0!==this.numLonePair)||this.isHidden&&e.atoms_showHiddenCarbons_2D||e.atoms_displayTerminalCarbonLabels_2D&&1===this.bondNumber?!0:!1},r.getImplicitHydrogenCount=function(){if("H"===this.label||!e[this.label]||!e[this.label].addH)return 0;var t=e[this.label].valency,n=t-this.coordinationNumber;return 0<this.numRadical&&(n=i.max(0,n-this.numRadical)),0<this.charge?(t=4-t,n=this.charge<=t?n+this.charge:4-this.coordinationNumber-this.charge+t):n+=this.charge,0>n?0:i.floor(n)},r.getBounds=function(){var e=new n.Bounds;e.expand(this.x,this.y);if(this.textBounds)for(var t=0,r=this.textBounds.length;t<r;t++){var i=this.textBounds[t];e.expand(i.x,i.y,i.x+i.w,i.y+i.h)}return e},r.getBounds3D=function(){var e=new n.Bounds;return e.expand3D(this.x,this.y,this.z),e},r.getElementColor=function(t,n,r){return t?r=e[this.label].jmolColor:n&&(r=e[this.label].pymolColor),r}}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,Math,ChemDoodle.lib.mat4),function(e,t,n,r,i,s,o){n.Bond=function(e,t,n){this.a1=e,this.a2=t,this.bondOrder=void 0!==n?n:1},n.Bond.STEREO_NONE="none",n.Bond.STEREO_PROTRUDING="protruding",n.Bond.STEREO_RECESSED="recessed",n.Bond.STEREO_AMBIGUOUS="ambiguous",e=n.Bond.prototype,e.stereo=n.Bond.STEREO_NONE,e.isHover=!1,e.ring=void 0,e.getCenter=function(){return new n.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)},e.getLength=function(){return this.a1.distance(this.a2)},e.getLength3D=function(){return this.a1.distance3D(this.a2)},e.contains=function(e){return e===this.a1||e===this.a2},e.getNeighbor=function(e){if(e===this.a1)return this.a2;if(e===this.a2)return this.a1},e.draw=function(e,s){if(this.a1.x!==this.a2.x||this.a1.y!==this.a2.y){this.specs&&(s=this.specs);var o=this.a1.x,u=this.a2.x,a=this.a1.y,f=this.a2.y,c=this.a1.distance(this.a2),p=u-o,d=f-a;if(this.a1.isLassoed&&this.a2.isLassoed){var v=e.createLinearGradient(o,a,u,f);v.addColorStop(0,"rgba(212, 99, 0, 0)"),v.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),v.addColorStop(1,"rgba(212, 99, 0, 0)");var m=2.5,g=this.a1.angle(this.a2)+i.PI/2,y=i.cos(g),g=i.sin(g),b=o-y*m,w=a+g*m,E=o+y*m,S=a-g*m,x=u+y*m,T=f-g*m,y=u-y*m,g=f+g*m;e.fillStyle=v,e.beginPath(),e.moveTo(b,w),e.lineTo(E,S),e.lineTo(x,T),e.lineTo(y,g),e.closePath(),e.fill()}if(s.atoms_display&&!s.atoms_circles_2D&&this.a1.isLabelVisible(s)&&this.a1.textBounds){m=y=0;for(b=this.a1.textBounds.length;m<b;m++)y=Math.max(y,r.calculateDistanceInterior(this.a1,this.a2,this.a1.textBounds[m]));y+=s.bonds_atomLabelBuffer_2D,y/=c,o+=p*y,a+=d*y}if(s.atoms_display&&!s.atoms_circles_2D&&this.a2.isLabelVisible(s)&&this.a2.textBounds){m=y=0;for(b=this.a2.textBounds.length;m<b;m++)y=Math.max(y,r.calculateDistanceInterior(this.a2,this.a1,this.a2.textBounds[m]));y+=s.bonds_atomLabelBuffer_2D,y/=c,u-=p*y,f-=d*y}s.bonds_clearOverlaps_2D&&(y=o+.15*p,g=a+.15*d,m=u-.15*p,c=f-.15*d,e.strokeStyle=s.backgroundColor,e.lineWidth=s.bonds_width_2D+2*s.bonds_overlapClearWidth_2D,e.lineCap="round",e.beginPath(),e.moveTo(y,g),e.lineTo(m,c),e.closePath(),e.stroke()),e.strokeStyle=s.bonds_color,e.fillStyle=s.bonds_color,e.lineWidth=s.bonds_width_2D,e.lineCap=s.bonds_ends_2D;if(s.bonds_useJMOLColors||s.bonds_usePYMOLColors)y=e.createLinearGradient(o,a,u,f),g=this.a1.getElementColor(s.bonds_useJMOLColors,s.bonds_usePYMOLColors,s.atoms_color,2),m=this.a2.getElementColor(s.bonds_useJMOLColors,s.bonds_usePYMOLColors,s.atoms_color,2),y.addColorStop(0,g),s.bonds_colorGradient||(y.addColorStop(.5,g),y.addColorStop(.51,m)),y.addColorStop(1,m),e.strokeStyle=y,e.fillStyle=y;if(s.bonds_lewisStyle_2D&&0===this.bondOrder%1)this.drawLewisStyle(e,s,o,a,u,f);else switch(this.query?1:this.bondOrder){case 0:u-=o,f-=a,u=i.sqrt(u*u+f*f),f=i.floor(u/s.bonds_dotSize_2D),u=(u-(f-1)*s.bonds_dotSize_2D)/2,1===f%2?u+=s.bonds_dotSize_2D/4:(u-=s.bonds_dotSize_2D/4,f+=2),f/=2,d=this.a1.angle(this.a2),y=o+u*Math.cos(d),g=a-u*Math.sin(d),e.beginPath();for(m=0;m<f;m++)e.arc(y,g,s.bonds_dotSize_2D/2,0,2*i.PI,!1),y+=2*s.bonds_dotSize_2D*Math.cos(d),g-=2*s.bonds_dotSize_2D*Math.sin(d);e.fill();break;case.5:e.beginPath(),e.moveTo(o,a),t.contextHashTo(e,o,a,u,f,s.bonds_hashSpacing_2D,s.bonds_hashSpacing_2D),e.stroke();break;case 1:if(!!this.query||this.stereo!==n.Bond.STEREO_PROTRUDING&&this.stereo!==n.Bond.STEREO_RECESSED){if(!this.query&&this.stereo===n.Bond.STEREO_AMBIGUOUS){e.beginPath(),e.moveTo(o,a),u=i.floor(i.sqrt(p*p+d*d)/s.bonds_wavyLength_2D),g=this.a1.angle(this.a2)+i.PI/2,y=i.cos(g),g=i.sin(g),f=p/u,d/=u,m=0;for(b=u;m<b;m++)o+=f,a+=d,u=s.bonds_wavyLength_2D*y+o-.5*f,c=s.bonds_wavyLength_2D*-g+a-.5*d,p=s.bonds_wavyLength_2D*-y+o-.5*f,w=s.bonds_wavyLength_2D*g+a-.5*d,0===m%2?e.quadraticCurveTo(u,c,o,a):e.quadraticCurveTo(p,w,o,a);e.stroke();break}e.beginPath(),e.moveTo(o,a),e.lineTo(u,f),e.stroke(),this.query&&this.query.draw(e,s,this.getCenter())}else d=s.bonds_width_2D/2,m=this.a1.distance(this.a2)*s.bonds_wedgeThickness_2D/2,g=this.a1.angle(this.a2)+i.PI/2,y=i.cos(g),g=i.sin(g),b=o-y*d,w=a+g*d,E=o+y*d,S=a-g*d,x=u+y*m,T=f-g*m,y=u-y*m,g=f+g*m,e.beginPath(),e.moveTo(b,w),e.lineTo(E,S),e.lineTo(x,T),e.lineTo(y,g),e.closePath(),this.stereo===n.Bond.STEREO_PROTRUDING?e.fill():(e.save(),e.clip(),e.lineWidth=2*m,e.lineCap="butt",e.beginPath(),e.moveTo(o,a),t.contextHashTo(e,o,a,u,f,s.bonds_hashWidth_2D,s.bonds_hashSpacing_2D),e.stroke(),e.restore());break;case 1.5:case 2:this.stereo===n.Bond.STEREO_AMBIGUOUS?(m=this.a1.distance(this.a2)*s.bonds_saturationWidth_2D/2,g=this.a1.angle(this.a2)+i.PI/2,y=i.cos(g),g=i.sin(g),b=o-y*m,w=a+g*m,E=o+y*m,S=a-g*m,x=u+y*m,T=f-g*m,y=u-y*m,g=f+g*m,e.beginPath(),e.moveTo(b,w),e.lineTo(x,T),e.moveTo(E,S),e.lineTo(y,g),e.stroke()):!s.bonds_symmetrical_2D&&(this.ring||"C"===this.a1.label&&"C"===this.a2.label)?(e.beginPath(),e.moveTo(o,a),e.lineTo(u,f),y=0,c=this.a1.distance(this.a2),d=this.a1.angle(this.a2),g=d+i.PI/2,m=c*s.bonds_saturationWidth_2D,p=s.bonds_saturationAngle_2D,p<i.PI/2&&(y=-(m/i.tan(p))),i.abs(y)<c/2&&(p=o-i.cos(d)*y,o=u+i.cos(d)*y,u=a+i.sin(d)*y,a=f-i.sin(d)*y,y=i.cos(g),g=i.sin(g),b=p-y*m,w=u+g*m,E=p+y*m,S=u-g*m,x=o-y*m,T=a+g*m,y=o+y*m,g=a-g*m,!this.ring||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>i.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<-i.PI?(e.moveTo(b,w),2===this.bondOrder?e.lineTo(x,T):t.contextHashTo(e,b,w,x,T,s.bonds_hashSpacing_2D,s.bonds_hashSpacing_2D)):(e.moveTo(E,S),2===this.bondOrder?e.lineTo(y,g):t.contextHashTo(e,E,S,y,g,s.bonds_hashSpacing_2D,s.bonds_hashSpacing_2D)),e.stroke())):(m=this.a1.distance(this.a2)*s.bonds_saturationWidth_2D/2,g=this.a1.angle(this.a2)+i.PI/2,y=i.cos(g),g=i.sin(g),b=o-y*m,w=a+g*m,E=o+y*m,S=a-g*m,x=u+y*m,T=f-g*m,y=u-y*m,g=f+g*m,e.beginPath(),e.moveTo(b,w),e.lineTo(y,g),e.moveTo(E,S),2===this.bondOrder?e.lineTo(x,T):t.contextHashTo(e,E,S,x,T,s.bonds_hashSpacing_2D,s.bonds_hashSpacing_2D),e.stroke());break;case 3:m=this.a1.distance(this.a2)*s.bonds_saturationWidth_2D,g=this.a1.angle(this.a2)+i.PI/2,y=i.cos(g),g=i.sin(g),b=o-y*m,w=a+g*m,E=o+y*m,S=a-g*m,x=u+y*m,T=f-g*m,y=u-y*m,g=f+g*m,e.beginPath(),e.moveTo(b,w),e.lineTo(y,g),e.moveTo(E,S),e.lineTo(x,T),e.moveTo(o,a),e.lineTo(u,f),e.stroke()}}},e.drawDecorations=function(e){if(this.isHover||this.isSelected){var t=2*i.PI,n=(this.a1.angleForStupidCanvasArcs(this.a2)+i.PI/2)%t;e.strokeStyle=this.isHover?"#885110":"#0060B2",e.lineWidth=1.2,e.beginPath();var r=(n+i.PI)%t,r=r%(2*i.PI);e.arc(this.a1.x,this.a1.y,7,n,r,!1),e.stroke(),e.beginPath(),n+=i.PI,r=(n+i.PI)%t,e.arc(this.a2.x,this.a2.y,7,n,r,!1),e.stroke()}},e.drawLewisStyle=function(e,t,n,r,s,o){var u=this.a1.angle(this.a2),a=u+i.PI/2;s-=n,o-=r,s=i.sqrt(s*s+o*o)/(this.bondOrder+1),o=s*i.cos(u),u=-s*i.sin(u),n+=o,r+=u;for(s=0;s<this.bondOrder;s++){var f=t.atoms_lonePairSpread_2D/2,l=n-i.cos(a)*f,c=r+i.sin(a)*f,p=n+i.cos(a)*f,f=r-i.sin(a)*f;e.beginPath(),e.arc(l-t.atoms_lonePairDiameter_2D/2,c-t.atoms_lonePairDiameter_2D/2,t.atoms_lonePairDiameter_2D,0,2*i.PI,!1),e.fill(),e.beginPath(),e.arc(p-t.atoms_lonePairDiameter_2D/2
,f-t.atoms_lonePairDiameter_2D/2,t.atoms_lonePairDiameter_2D,0,2*i.PI,!1),e.fill(),n+=o,r+=u}},e.render=function(e,n,r){this.specs&&(n=this.specs);var u=this.a1.distance3D(this.a2);if(0!==u){var a=n.bonds_cylinderDiameter_3D/2,f=n.bonds_color,l,c=s.translate(e.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),p,d=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],v=[0,1,0],m=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(v=[0,0,1],this.a2.y<this.a1.y&&(m=i.PI)):(m=t.vec3AngleFrom(v,d),v=o.cross(v,d,[]));var y=n.bonds_useJMOLColors,b=n.bonds_usePYMOLColors;if(y||b)f=this.a1.getElementColor(y,b,f),l=this.a2.getElementColor(y,b,n.bonds_color),f!=l&&(p=s.translate(e.modelViewMatrix,[this.a2.x,this.a2.y,this.a2.z],[]));var y=[0],w;if(r){n.bonds_showBondOrders_3D&&1<this.bondOrder&&(y=[n.bonds_cylinderDiameter_3D],w=[0,0,1],r=s.inverse(e.rotationMatrix,[]),s.multiplyVec3(r,w),w=o.cross(d,w,[]),o.normalize(w));var a=1,E=n.bonds_pillSpacing_3D,d=n.bonds_pillHeight_3D;0==this.bondOrder&&(n.bonds_renderAsLines_3D?d=E:(d=n.bonds_pillDiameter_3D,d<n.bonds_cylinderDiameter_3D&&(d/=2),a=d/2,u/=a,E/=a/2)),r=d+E;var b=i.floor(u/r),S=(E+n.bonds_pillDiameter_3D+(u-r*b))/2,x=b;p&&(x=i.floor(b/2)),u=0;for(E=y.length;u<E;u++){var T=s.set(c,[]);0!==y[u]&&s.translate(T,o.scale(w,y[u],[])),0!==m&&s.rotate(T,m,v),1!=a&&s.scale(T,[a,a,a]),f&&e.material.setDiffuseColor(f),s.translate(T,[0,S,0]);for(var N=0;N<x;N++)n.bonds_renderAsLines_3D?0==this.bondOrder?(e.setMatrixUniforms(T),e.drawArrays(e.POINTS,0,1)):(s.scale(T,[1,d,1]),e.setMatrixUniforms(T),e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems),s.scale(T,[1,1/d,1])):(e.setMatrixUniforms(T),0==this.bondOrder?e.drawElements(e.TRIANGLES,e.sphereBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0):e.drawElements(e.TRIANGLES,e.pillBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)),s.translate(T,[0,r,0]);if(p){var C,k;n.bonds_renderAsLines_3D?(C=d,C/=2,k=0):(C=2/3,k=(1-C)/2),0!=b%2&&(s.scale(T,[1,C,1]),e.setMatrixUniforms(T),n.bonds_renderAsLines_3D?0==this.bondOrder?e.drawArrays(e.POINTS,0,1):e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):0==this.bondOrder?e.drawElements(e.TRIANGLES,e.sphereBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0):e.drawElements(e.TRIANGLES,e.pillBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0),s.translate(T,[0,r*(1+k),0]),s.scale(T,[1,1/C,1])),s.set(p,T),0!==y[u]&&s.translate(T,o.scale(w,y[u],[])),s.rotate(T,m+i.PI,v),1!=a&&s.scale(T,[a,a,a]),l&&e.material.setDiffuseColor(l),s.translate(T,[0,S,0]);for(N=0;N<x;N++)n.bonds_renderAsLines_3D?0==this.bondOrder?(e.setMatrixUniforms(T),e.drawArrays(e.POINTS,0,1)):(s.scale(T,[1,d,1]),e.setMatrixUniforms(T),e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems),s.scale(T,[1,1/d,1])):(e.setMatrixUniforms(T),0==this.bondOrder?e.drawElements(e.TRIANGLES,e.sphereBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0):e.drawElements(e.TRIANGLES,e.pillBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)),s.translate(T,[0,r,0]);0!=b%2&&(s.scale(T,[1,C,1]),e.setMatrixUniforms(T),n.bonds_renderAsLines_3D?0==this.bondOrder?e.drawArrays(e.POINTS,0,1):e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):0==this.bondOrder?e.drawElements(e.TRIANGLES,e.sphereBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0):e.drawElements(e.TRIANGLES,e.pillBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0),s.translate(T,[0,r*(1+k),0]),s.scale(T,[1,1/C,1]))}}}else{if(n.bonds_showBondOrders_3D){switch(this.bondOrder){case 1.5:y=[-n.bonds_cylinderDiameter_3D];break;case 2:y=[-n.bonds_cylinderDiameter_3D,n.bonds_cylinderDiameter_3D];break;case 3:y=[-1.2*n.bonds_cylinderDiameter_3D,0,1.2*n.bonds_cylinderDiameter_3D]}1<this.bondOrder&&(w=[0,0,1],r=s.inverse(e.rotationMatrix,[]),s.multiplyVec3(r,w),w=o.cross(d,w,[]),o.normalize(w))}else switch(this.bondOrder){case 0:a*=.25;break;case.5:case 1.5:a*=.5}p&&(u/=2),a=[a,u,a],u=0;for(E=y.length;u<E;u++)T=s.set(c,[]),0!==y[u]&&s.translate(T,o.scale(w,y[u],[])),0!==m&&s.rotate(T,m,v),s.scale(T,a),f&&e.material.setDiffuseColor(f),e.setMatrixUniforms(T),n.bonds_renderAsLines_3D?e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):e.drawArrays(e.TRIANGLE_STRIP,0,e.cylinderBuffer.vertexPositionBuffer.numItems),p&&(s.set(p,T),0!==y[u]&&s.translate(T,o.scale(w,y[u],[])),s.rotate(T,m+i.PI,v),s.scale(T,a),l&&e.material.setDiffuseColor(l),e.setMatrixUniforms(T),n.bonds_renderAsLines_3D?e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):e.drawArrays(e.TRIANGLE_STRIP,0,e.cylinderBuffer.vertexPositionBuffer.numItems))}}},e.renderHighlight=function(e,n){if(this.isSelected||this.isHover){this.specs&&(n=this.specs),this.specs&&(n=this.specs);var r=this.a1.distance3D(this.a2);if(0!==r){var u=n.bonds_cylinderDiameter_3D/1.2,a=s.translate(e.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),f=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],l=[0,1,0],c=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(f=[0,0,1],this.a2.y<this.a1.y&&(c=i.PI)):(c=t.vec3AngleFrom(l,f),f=o.cross(l,f,[])),r=[u,r,u],0!==c&&s.rotate(a,c,f),s.scale(a,r),e.setMatrixUniforms(a),e.material.setDiffuseColor(this.isHover?"#885110":"#0060B2"),e.drawArrays(e.TRIANGLE_STRIP,0,e.cylinderBuffer.vertexPositionBuffer.numItems)}}},e.renderPicker=function(e,n){this.specs&&(n=this.specs);var r=this.a1.distance3D(this.a2);if(0!==r){var u=n.bonds_cylinderDiameter_3D/2,a=s.translate(e.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),f=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],l=[0,1,0],c=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(l=[0,0,1],this.a2.y<this.a1.y&&(c=i.PI)):(c=t.vec3AngleFrom(l,f),l=o.cross(l,f,[]));var p=[0],d;if(n.bonds_showBondOrders_3D)if(n.bonds_renderAsLines_3D){switch(this.bondOrder){case 1.5:case 2:p=[-n.bonds_cylinderDiameter_3D,n.bonds_cylinderDiameter_3D];break;case 3:p=[-1.2*n.bonds_cylinderDiameter_3D,0,1.2*n.bonds_cylinderDiameter_3D]}if(1<this.bondOrder){d=[0,0,1];var v=s.inverse(e.rotationMatrix,[]);s.multiplyVec3(v,d),d=o.cross(f,d,[]),o.normalize(d)}}else switch(this.bondOrder){case 1.5:case 2:u*=3;break;case 3:u*=3.4}else switch(this.bondOrder){case 0:u*=.25;break;case.5:case 1.5:u*=.5}r=[u,r,u],u=0;for(f=p.length;u<f;u++)v=s.set(a,[]),0!==p[u]&&s.translate(v,o.scale(d,p[u],[])),0!==c&&s.rotate(v,c,l),s.scale(v,r),e.setMatrixUniforms(v),n.bonds_renderAsLines_3D?e.drawArrays(e.LINES,0,e.lineBuffer.vertexPositionBuffer.numItems):e.drawArrays(e.TRIANGLE_STRIP,0,e.cylinderBuffer.vertexPositionBuffer.numItems)}}}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(e,t){e.Ring=function(){this.atoms=[],this.bonds=[]};var n=e.Ring.prototype;n.center=void 0,n.setupBonds=function(){for(var e=0,t=this.bonds.length;e<t;e++)this.bonds[e].ring=this;this.center=this.getCenter()},n.getCenter=function(){for(var n=Infinity,r=Infinity,i=-Infinity,s=-Infinity,o=0,u=this.atoms.length;o<u;o++)n=t.min(this.atoms[o].x,n),r=t.min(this.atoms[o].y,r),i=t.max(this.atoms[o].x,i),s=t.max(this.atoms[o].y,s);return new e.Point((i+n)/2,(s+r)/2)}}(ChemDoodle.structures,Math),function(e,t,n,r,i){n.Molecule=function(){this.atoms=[],this.bonds=[],this.rings=[]};var s=n.Molecule.prototype;s.findRings=!0,s.draw=function(e,t){this.specs&&(t=this.specs);if(t.atoms_display&&!t.atoms_circles_2D)for(var n=0,r=this.atoms.length;n<r;n++)this.atoms[n].draw(e,t);if(t.bonds_display){n=0;for(r=this.bonds.length;n<r;n++)this.bonds[n].draw(e,t)}if(t.atoms_display){n=0;for(r=this.atoms.length;n<r;n++){var i=this.atoms[n];t.atoms_circles_2D&&i.draw(e,t),i.query&&i.query.draw(e,t,i)}}},s.render=function(e,i){this.specs&&(i=this.specs);var s=0<this.atoms.length&&void 0!==this.atoms[0].hetatm;if(s){if(i.macro_displayBonds){0<this.bonds.length&&(i.bonds_renderAsLines_3D&&!this.residueSpecs||this.residueSpecs&&this.residueSpecs.bonds_renderAsLines_3D?(e.lineWidth(this.residueSpecs?this.residueSpecs.bonds_width_2D:i.bonds_width_2D),e.lineBuffer.bindBuffers(e)):e.cylinderBuffer.bindBuffers(e),e.material.setTempColors(i.bonds_materialAmbientColor_3D,void 0,i.bonds_materialSpecularColor_3D,i.bonds_materialShininess_3D));for(var u=0,a=this.bonds.length;u<a;u++){var f=this.bonds[u];!f.a1.hetatm&&(-1===i.macro_atomToLigandDistance||void 0!==f.a1.closestDistance&&i.macro_atomToLigandDistance>=f.a1.closestDistance&&i.macro_atomToLigandDistance>=f.a2.closestDistance)&&f.render(e,this.residueSpecs?this.residueSpecs:i)}}if(i.macro_displayAtoms){0<this.atoms.length&&(e.sphereBuffer.bindBuffers(e),e.material.setTempColors(i.atoms_materialAmbientColor_3D,void 0,i.atoms_materialSpecularColor_3D,i.atoms_materialShininess_3D)),u=0;for(a=this.atoms.length;u<a;u++)(f=this.atoms[u],!f.hetatm&&(-1===i.macro_atomToLigandDistance||void 0!==f.closestDistance&&i.macro_atomToLigandDistance>=f.closestDistance))&&f.render(e,this.residueSpecs?this.residueSpecs:i)}}if(i.bonds_display){var c=[],h=[];0<this.bonds.length&&(i.bonds_renderAsLines_3D?(e.lineWidth(i.bonds_width_2D),e.lineBuffer.bindBuffers(e)):e.cylinderBuffer.bindBuffers(e),e.material.setTempColors(i.bonds_materialAmbientColor_3D,void 0,i.bonds_materialSpecularColor_3D,i.bonds_materialShininess_3D)),u=0;for(a=this.bonds.length;u<a;u++)if(f=this.bonds[u],!s||f.a1.hetatm)i.bonds_showBondOrders_3D?0==f.bondOrder?h.push(f):.5==f.bondOrder?c.push(f):(1.5==f.bondOrder&&c.push(f),f.render(e,i)):f.render(e,i);if(0<c.length){i.bonds_renderAsLines_3D||e.pillBuffer.bindBuffers(e),u=0;for(a=c.length;u<a;u++)c[u].render(e,i,!0)}if(0<h.length){i.bonds_renderAsLines_3D||e.sphereBuffer.bindBuffers(e),u=0;for(a=h.length;u<a;u++)h[u].render(e,i,!0)}}if(i.atoms_display){u=0;for(a=this.atoms.length;u<a;u++)f=this.atoms[u],f.bondNumber=0,f.renderAsStar=!1;u=0;for(a=this.bonds.length;u<a;u++)f=this.bonds[u],f.a1.bondNumber++,f.a2.bondNumber++;0<this.atoms.length&&(e.sphereBuffer.bindBuffers(e),e.material.setTempColors(i.atoms_materialAmbientColor_3D,void 0,i.atoms_materialSpecularColor_3D,i.atoms_materialShininess_3D)),c=[],u=0;for(a=this.atoms.length;u<a;u++)if(f=this.atoms[u],!s||f.hetatm&&(i.macro_showWater||!f.isWater))i.atoms_nonBondedAsStars_3D&&0===f.bondNumber?(f.renderAsStar=!0,c.push(f)):f.render(e,i);if(0<c.length){e.starBuffer.bindBuffers(e),u=0;for(a=c.length;u<a;u++)c[u].render(e,i)}}if(this.chains){e.setMatrixUniforms(e.modelViewMatrix);if(i.proteins_displayRibbon){e.material.setTempColors(i.proteins_materialAmbientColor_3D,void 0,i.proteins_materialSpecularColor_3D,i.proteins_materialShininess_3D),f=i.proteins_ribbonCartoonize?this.cartoons:this.ribbons,s=0;for(c=f.length;s<c;s++)if(h=f[s],"none"!==i.proteins_residueColor){h.front.bindBuffers(e);for(var p="rainbow"===i.proteins_residueColor,u=0,a=h.front.segments.length;u<a;u++)p&&e.material.setDiffuseColor(t.rainbowAt(u,a,i.macro_rainbowColors)),h.front.segments[u].render(e,i);h.back.bindBuffers(e),u=0;for(a=h.back.segments.length;u<a;u++)p&&e.material.setDiffuseColor(t.rainbowAt(u,a,i.macro_rainbowColors)),h.back.segments[u].render(e,i)}else h.front.render(e,i),h.back.render(e,i)}if(i.proteins_displayPipePlank){s=0;for(c=this.pipePlanks.length;s<c;s++)this.pipePlanks[s].render(e,i)}if(i.proteins_displayBackbone){if(!this.alphaCarbonTrace){this.alphaCarbonTrace={nodes:[],edges:[]},s=0;for(c=this.chains.length;s<c;s++)if(h=this.chains[s],!(2<h.length&&r[h[2].name]&&"#BEA06E"===r[h[2].name].aminoColor)&&0<h.length){u=0;for(a=h.length-2;u<a;u++)f=h[u].cp1,f.chainColor=h.chainColor,this.alphaCarbonTrace.nodes.push(f),f=new n.Bond(h[u].cp1,h[u+1].cp1),f.residueName=h[u].name,f.chainColor=h.chainColor,this.alphaCarbonTrace.edges.push(f),u===h.length-3&&(f=h[u+1].cp1,f.chainColor=h.chainColor,this.alphaCarbonTrace.nodes.push(f))}}if(0<this.alphaCarbonTrace.nodes.length){s=new n.VisualSpecifications,s.atoms_display=!0,s.bonds_display=!0,s.atoms_sphereDiameter_3D=i.proteins_backboneThickness,s.bonds_cylinderDiameter_3D=i.proteins_backboneThickness,s.bonds_useJMOLColors=!1,s.atoms_color=i.proteins_backboneColor,s.bonds_color=i.proteins_backboneColor,s.atoms_useVDWDiameters_3D=!1,e.material.setTempColors(i.proteins_materialAmbientColor_3D,void 0,i.proteins_materialSpecularColor_3D,i.proteins_materialShininess_3D),e.material.setDiffuseColor(i.proteins_backboneColor),u=0;for(a=this.alphaCarbonTrace.nodes.length;u<a;u++)f=this.alphaCarbonTrace.nodes[u],i.macro_colorByChain&&(s.atoms_color=f.chainColor),e.sphereBuffer.bindBuffers(e),f.render(e,s);u=0;for(a=this.alphaCarbonTrace.edges.length;u<a;u++){var f=this.alphaCarbonTrace.edges[u],d,c=r[f.residueName]?r[f.residueName]:r["*"];i.macro_colorByChain?d=f.chainColor:"shapely"===i.proteins_residueColor?d=c.shapelyColor:"amino"===i.proteins_residueColor?d=c.aminoColor:"polarity"===i.proteins_residueColor?d=c.polar?"#C10000":"#FFFFFF":"acidity"===i.proteins_residueColor?d=1===c.acidity?"#0000FF":-1===c.acidity?"#FF0000":c.polar?"#FFFFFF":"#773300":"rainbow"===i.proteins_residueColor&&(d=t.rainbowAt(u,a,i.macro_rainbowColors)),d&&(s.bonds_color=d),e.cylinderBuffer.bindBuffers(e),f.render(e,s)}}}if(i.nucleics_display){e.material.setTempColors(i.nucleics_materialAmbientColor_3D,void 0,i.nucleics_materialSpecularColor_3D,i.nucleics_materialShininess_3D),s=0;for(c=this.tubes.length;s<c;s++)e.setMatrixUniforms(e.modelViewMatrix),h=this.tubes[s],h.render(e,i)}}if(i.atoms_display){d=!1,u=0;for(a=this.atoms.length;u<a;u++)if(f=this.atoms[u],f.isHover||f.isSelected){d=!0;break}if(!d){u=0;for(a=this.bonds.length;u<a;u++)if(f=this.bonds[u],f.isHover||f.isSelected){d=!0;break}}if(d){e.sphereBuffer.bindBuffers(e),e.blendFunc(e.SRC_ALPHA,e.ONE),e.material.setTempColors(i.atoms_materialAmbientColor_3D,void 0,"#000000",0),e.enable(e.BLEND),e.depthMask(!1),e.material.setAlpha(.4),e.sphereBuffer.bindBuffers(e),u=0;for(a=this.atoms.length;u<a;u++)f=this.atoms[u],(f.isHover||f.isSelected)&&f.renderHighlight(e,i);e.cylinderBuffer.bindBuffers(e),u=0;for(a=this.bonds.length;u<a;u++)f=this.bonds[u],(f.isHover||f.isSelected)&&f.renderHighlight(e,i);e.depthMask(!0),e.disable(e.BLEND),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)}}this.surface&&i.surfaces_display&&(e.setMatrixUniforms(e.modelViewMatrix),this.surface.bindBuffers(e),e.material.setTempColors(i.surfaces_materialAmbientColor_3D,i.surfaces_color,i.surfaces_materialSpecularColor_3D,i.surfaces_materialShininess_3D),"Dot"===i.surfaces_style?e.drawArrays(e.POINTS,0,this.surface.vertexPositionBuffer.numItems):e.drawElements(e.TRIANGLES,this.surface.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0))},s.renderPickFrame=function(e,n,r,i,s){this.specs&&(n=this.specs);var o=0<this.atoms.length&&void 0!==this.atoms[0].hetatm;if(s&&n.bonds_display){0<this.bonds.length&&(n.bonds_renderAsLines_3D?(e.lineWidth(n.bonds_width_2D),e.lineBuffer.bindBuffers(e)):e.cylinderBuffer.bindBuffers(e)),s=0;for(var u=this.bonds.length;s<u;s++){var a=this.bonds[s];if(!o||a.a1.hetatm)e.material.setDiffuseColor(t.idx2color(r.length)),a.renderPicker(e,n),r.push(a)}}if(i&&n.atoms_display){s=0;for(u=this.atoms.length;s<u;s++)i=this.atoms[s],i.bondNumber=0,i.renderAsStar=!1;s=0;for(u=this.bonds.length;s<u;s++)a=this.bonds[s],a.a1.bondNumber++,a.a2.bondNumber++;0<this.atoms.length&&e.sphereBuffer.bindBuffers(e),a=[],s=0;for(u=this.atoms.length;s<u;s++)if(i=this.atoms[s],!o||i.hetatm&&(n.macro_showWater||!i.isWater))n.atoms_nonBondedAsStars_3D&&0===i.bondNumber?(i.renderAsStar=!0,a.push(i)):(e.material.setDiffuseColor(t.idx2color(r.length)),i.render(e,n,!0),r.push(i));if(0<a.length){e.starBuffer.bindBuffers(e),s=0;for(u=a.length;s<u;s++)i=a[s],e.material.setDiffuseColor(t.idx2color(r.length)),i.render(e,n,!0),r.push(i)}}},s.getCenter3D=function(){if(1===this.atoms.length)return new n.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);var e=Infinity,t=Infinity,r=Infinity,s=-Infinity,u=-Infinity,a=-Infinity;if(this.chains)for(var f=0,l=this.chains.length;f<l;f++)for(var c=this.chains[f],p=0,d=c.length;p<d;p++)var v=c[p],e=i.min(v.cp1.x,v.cp2.x,e),t=i.min(v.cp1.y,v.cp2.y,t),r=i.min(v.cp1.z,v.cp2.z,r),s=i.max(v.cp1.x,v.cp2.x,s),u=i.max(v.cp1.y,v.cp2.y,u),a=i.max(v.cp1.z,v.cp2.z,a);f=0;for(l=this.atoms.length;f<l;f++)e=i.min(this.atoms[f].x,e),t=i.min(this.atoms[f].y,t),r=i.min(this.atoms[f].z,r),s=i.max(this.atoms[f].x,s),u=i.max(this.atoms[f].y,u),a=i.max(this.atoms[f].z,a);return new n.Atom("C",(s+e)/2,(u+t)/2,(a+r)/2)},s.getCenter=function(){if(1===this.atoms.length)return new n.Point(this.atoms[0].x,this.atoms[0].y);for(var e=Infinity,t=Infinity,r=-Infinity,s=-Infinity,u=0,a=this.atoms.length;u<a;u++)e=i.min(this.atoms[u].x,e),t=i.min(this.atoms[u].y,t),r=i.max(this.atoms[u].x,r),s=i.max(this.atoms[u].y,s);return new n.Point((r+e)/2,(s+t)/2)},s.getDimension=function(){if(1===this.atoms.length)return new n.Point(0,0);var e=Infinity,t=Infinity,r=-Infinity,s=-Infinity;if(this.chains){for(var u=0,a=this.chains.length;u<a;u++)for(var f=this.chains[u],l=0,c=f.length;l<c;l++)var p=f[l],e=i.min(p.cp1.x,p.cp2.x,e),t=i.min(p.cp1.y,p.cp2.y,t),r=i.max(p.cp1.x,p.cp2.x,r),s=i.max(p.cp1.y,p.cp2.y,s);e-=30,t-=30,r+=30,s+=30}u=0;for(a=this.atoms.length;u<a;u++)e=i.min(this.atoms[u].x,e),t=i.min(this.atoms[u].y,t),r=i.max(this.atoms[u].x,r),s=i.max(this.atoms[u].y,s);return new n.Point(r-e,s-t)},s.check=function(t){if(t&&this.doChecks){if(this.findRings)if(this.bonds.length-this.atoms.length!==this.fjNumCache){this.rings=(new e.informatics.SSSRFinder(this)).rings;for(var n=0,r=this.bonds.length;n<r;n++)this.bonds[n].ring=void 0;n=0;for(r=this.rings.length;n<r;n++)this.rings[n].setupBonds()}else{n=0;for(r=this.rings.length;n<r;n++){var i=this.rings[n];i.center=i.getCenter()}}n=0;for(r=this.atoms.length;n<r;n++)if(this.atoms[n].isLone=!1,"C"===this.atoms[n].label){for(var s=i=0,o=this.bonds.length;s<o;s++)(this.bonds[s].a1===this.atoms[n]||this.bonds[s].a2===this.atoms[n])&&i++;0===i&&(this.atoms[n].isLone=!0)}i=!1,n=0;for(r=this.atoms.length;n<r;n++)0!==this.atoms[n].z&&(i=!0);i&&(this.sortAtomsByZ(),this.sortBondsByZ()),this.setupMetaData(),this.atomNumCache=this.atoms.length,this.bondNumCache=this.bonds.length,this.fjNumCache=this.bonds.length-this.atoms.length}this.doChecks=!t},s.getAngles=function(e){for(var t=[],n=0,r=this.bonds.length;n<r;n++)this.bonds[n].contains(e)&&t.push(e.angle(this.bonds[n].getNeighbor(e)));return t.sort(),t},s.getCoordinationNumber=function(e){for(var t=0,n=0,r=e.length;n<r;n++)t+=e[n].bondOrder;return t},s.getBonds=function(e){for(var t=[],n=0,r=this.bonds.length;n<r;n++)this.bonds[n].contains(e)&&t.push(this.bonds[n]);return t},s.sortAtomsByZ=function(){for(var e=1,t=this.atoms.length;e<t;e++)for(var n=e;0<n&&this.atoms[n].z<this.atoms[n-1].z;){var r=this.atoms[n];this.atoms[n]=this.atoms[n-1],this.atoms[n-1]=r,n--}},s.sortBondsByZ=function(){for(var e=1,t=this.bonds.length;e<t;e++)for(var n=e;0<n&&this.bonds[n].a1.z+this.bonds[n].a2.z<this.bonds[n-1].a1.z+this.bonds[n-1].a2.z;){var r=this.bonds[n];this.bonds[n]=this.bonds[n-1],this.bonds[n-1]=r,n--}},s.setupMetaData=function(){for(var e=this.getCenter(),n=0,r=this.atoms.length;n<r;n++){var s=this.atoms[n];s.bonds=this.getBonds(s),s.angles=this.getAngles(s),s.isHidden=2===s.bonds.length&&i.abs(i.abs(s.angles[1]-s.angles[0])-i.PI)<i.PI/30&&s.bonds[0].bondOrder===s.bonds[1].bondOrder;var o=t.angleBetweenLargest(s.angles);s.angleOfLeastInterference=o.angle%(2*i.PI),s.largestAngle=o.largest,s.coordinationNumber=this.getCoordinationNumber(s.bonds),s.bondNumber=s.bonds.length,s.molCenter=e}n=0;for(r=this.bonds.length;n<r;n++)this.bonds[n].molCenter=e},s.scaleToAverageBondLength=function(e){var t=this.getAverageBondLength();if(0!==t){e/=t;for(var t=0,n=this.atoms.length;t<n;t++)this.atoms[t].x*=e,this.atoms[t].y*=e}},s.getAverageBondLength=function(){if(0===this.bonds.length)return 0;for(var e=0,t=0,n=this.bonds.length;t<n;t++)e+=this.bonds[t].getLength();return e/=this.bonds.length},s.getBounds=function(){for(var e=new t.Bounds,n=0,r=this.atoms.length;n<r;n++)e.expand(this.atoms[n].getBounds());if(this.chains){n=0;for(r=this.chains.length;n<r;n++)for(var i=this.chains[n],s=0,o=i.length;s<o;s++){var u=i[s];e.expand(u.cp1.x,u.cp1.y),e.expand(u.cp2.x,u.cp2.y)}e.minX-=30,e.minY-=30,e.maxX+=30,e.maxY+=30}return e},s.getBounds3D=function(){for(var e=new t.Bounds,n=0,r=this.atoms.length;n<r;n++)e.expand(this.atoms[n].getBounds3D());if(this.chains){n=0;for(r=this.chains.length;n<r;n++)for(var i=this.chains[n],s=0,o=i.length;s<o;s++){var u=i[s];e.expand3D(u.cp1.x,u.cp1.y,u.cp1.z),e.expand3D(u.cp2.x,u.cp2.y,u.cp2.z)}}return e}}(ChemDoodle,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math),function(e,t,n,r){var i,s=-1;e.Residue=function(e){this.resSeq=e};var o=e.Residue.prototype;o.setup=function(t,n){this.horizontalResolution=n;var i=[t.x-this.cp1.x,t.y-this.cp1.y,t.z-this.cp1.z],s=r.cross(i,[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],[]);this.D=r.cross(s,i,[]),r.normalize(s),r.normalize(this.D),this.guidePointsSmall=[],this.guidePointsLarge=[],i=[(t.x+this.cp1.x)/2,(t.y+this.cp1.y)/2,(t.z+this.cp1.z)/2],this.helix&&(r.scale(s,1.5),r.add(i,s)),this.guidePointsSmall[0]=new e.Atom("",i[0]-this.D[0]/2,i[1]-this.D[1]/2,i[2]-this.D[2]/2);for(s=1;s<n;s++)this.guidePointsSmall[s]=new e.Atom("",this.guidePointsSmall[0].x+this.D[0]*s/n,this.guidePointsSmall[0].y+this.D[1]*s/n,this.guidePointsSmall[0].z+this.D[2]*s/n);r.scale(this.D,4),this.guidePointsLarge[0]=new e.Atom("",i[0]-this.D[0]/2,i[1]-this.D[1]/2,i[2]-this.D[2]/2);for(s=1;s<n;s++)this.guidePointsLarge[s]=new e.Atom("",this.guidePointsLarge[0].x+this.D[0]*s/n,this.guidePointsLarge[0].y+this.D[1]*s/n,this.guidePointsLarge[0].z+this.D[2]*s/n)},o.getGuidePointSet=function(e){if(0===e)return this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall;if(1===e)return this.guidePointsSmall;if(2===e)return this.guidePointsLarge},o.computeLineSegments=function(e,t,n,r,i){this.setVerticalResolution(i),this.split=n.helix!==this.helix||n.sheet!==this.sheet,this.lineSegments=this.innerCompute(0,e,t,n,!1,i),r&&(this.lineSegmentsCartoon=this.innerCompute(this.helix||this.sheet?2:1,e,t,n,!0,i))},o.innerCompute=function(s,o,u,a,f,c){var p=[],d=this.getGuidePointSet(s);o=o.getGuidePointSet(s),u=u.getGuidePointSet(s);for(var v=a.getGuidePointSet(s),m=0,g=d.length;m<g;m++){for(var y=n.multiply([o[m].x,o[m].y,o[m].z,1,u[m].x,u[m].y,u[m].z,1,d[m].x,d[m].y,d[m].z,1,v[m].x,v[m].y,v[m].z,1],i,[]),w=[],E=0;E<c;E++){for(s=3;0<s;s--)for(a=0;4>a;a++)y[4*s+a]+=y[4*(s-1)+a];w[E]=new e.Atom("",y[12]/y[15],y[13]/y[15],y[14]/y[15])}p[m]=w}if(f&&this.arrow)for(s=0;s<c;s++){f=1.5-1.3*s/c,d=t.floor(this.horizontalResolution/2),o=p[d],a=0;for(u=p.length;a<u;a++)a!==d&&(v=o[s],m=p[a][s],g=[m.x-v.x,m.y-v.y,m.z-v.z],r.scale(g,f),m.x=v.x+g[0],m.y=v.y+g[1],m.z=v.z+g[2])}return p},o.setVerticalResolution=function(e){if(e!==s){var t=e*e,r=e*e*e;i=n.multiply([-1/6,.5,-0.5,1/6,.5,-1,.5,0,-0.5,0,.5,0,1/6,2/3,1/6,0],[6/r,0,0,0,6/r,2/t,0,0,1/r,1/t,1/e,0,0,0,0,1],[]),s=e}}}(ChemDoodle.structures,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(e,t,n,r,i){t.Spectrum=function(){this.data=[],this.metadata=[],this.dataDisplay=[],this.memory={offsetTop:0,offsetLeft:0,offsetBottom:0,flipXAxis:!1,scale:1,width:0,height:0}},r=t.Spectrum.prototype,r.title=void 0,r.xUnit=void 0,r.yUnit=void 0,r.continuous=!0,r.integrationSensitivity=.01,r.draw=function(t,n,r,s){this.specs&&(n=this.specs);var o=5,u=0,a=0;t.fillStyle=n.text_color,t.textAlign="center",t.textBaseline="alphabetic",t.font=e.getFontString(n.text_font_size,n.text_font_families),this.xUnit&&(a+=n.text_font_size,t.fillText(this.xUnit,r/2,s-2)),this.yUnit&&n.plots_showYAxis&&(u+=n.text_font_size,t.save(),t.translate(n.text_font_size,s/2),t.rotate(-i.PI/2),t.fillText(this.yUnit,0,0),t.restore()),this.title&&(o+=n.text_font_size,t.fillText(this.title,r/2,n.text_font_size)),t.lineCap="square",a+=5+n.text_font_size,n.plots_showYAxis&&(u+=5+t.measureText("1000").width),n.plots_showGrid&&(t.strokeStyle=n.plots_gridColor,t.lineWidth=n.plots_gridLineWidth,t.strokeRect(u,o,r-u,s-a-o)),t.textAlign="center",t.textBaseline="top";for(var f=this.maxX-this.minX,l=f/100,c=.001;c<l||25<f/c;)c*=10;for(var p=0,d=n.plots_flipXAxis?r:0,f=i.round(this.minX/c)*c;f<=this.maxX;f+=c/2){var v=this.getTransformedX(f,n,r,u);if(v>u)if(t.strokeStyle="black",t.lineWidth=1,0===p%2){t.beginPath(),t.moveTo(v,s-a),t.lineTo(v,s-a+2),t.stroke();for(l=f.toFixed(5);"0"===l.charAt(l.length-1);)l=l.substring(0,l.length-1);"."===l.charAt(l.length-1)&&(l=l.substring(0,l.length-1));var m=t.measureText(l).width;n.plots_flipXAxis&&(m*=-1);var g=v-m/2;if(n.plots_flipXAxis?g<d:g>d)t.fillText(l,v,s-a+2),d=v+m/2;n.plots_showGrid&&(t.strokeStyle=n.plots_gridColor,t.lineWidth=n.plots_gridLineWidth,t.beginPath(),t.moveTo(v,s-a),t.lineTo(v,o),t.stroke())}else t.beginPath(),t.moveTo(v,s-a),t.lineTo(v,s-a+2),t.stroke();p++}if(n.plots_showYAxis||n.plots_showGrid){c=1/n.scale,t.textAlign="right",t.textBaseline="middle";for(f=0;10>=f;f++)if(l=c/10*f,p=o+(s-a-o)*(1-l*n.scale),n.plots_showGrid&&(t.strokeStyle=n.plots_gridColor,t.lineWidth=n.plots_gridLineWidth,t.beginPath(),t.moveTo(u,p),t.lineTo(r,p),t.stroke()),n.plots_showYAxis){t.strokeStyle="black",t.lineWidth=1,t.beginPath(),t.moveTo(u,p),t.lineTo(u-3,p),t.stroke(),l*=100,d=i.max(0,3-i.floor(l).toString().length),l=l.toFixed(d);if(0<d)for(;"0"===l.charAt(l.length-1);)l=l.substring(0,l.length-1);"."===l.charAt(l.length-1)&&(l=l.substring(0,l.length-1)),t.fillText(l,u-3,p)}}t.strokeStyle="black",t.lineWidth=1,t.beginPath(),t.moveTo(r,s-a),t.lineTo(u,s-a),n.plots_showYAxis&&t.lineTo(u,o),t.stroke();if(0<this.dataDisplay.length){t.textAlign="left",t.textBaseline="top",f=l=0;for(c=this.dataDisplay.length;f<c;f++)if(this.dataDisplay[f].value)t.fillText([this.dataDisplay[f].display,": ",this.dataDisplay[f].value].join(""),u+10,o+10+l*(n.text_font_size+5)),l++;else if(this.dataDisplay[f].tag){p=0;for(d=this.metadata.length;p<d;p++)if(e.stringStartsWith(this.metadata[p],this.dataDisplay[f].tag)){d=this.metadata[p],this.dataDisplay[f].display&&(d=this.metadata[p].indexOf("="),d=[this.dataDisplay[f].display,": ",-1<d?this.metadata[p].substring(d+2):this.metadata[p]].join("")),t.fillText(d,u+10,o+10+l*(n.text_font_size+5)),l++;break}}}this.drawPlot(t,n,r,s,o,u,a),this.memory.offsetTop=o,this.memory.offsetLeft=u,this.memory.offsetBottom=a,this.memory.flipXAxis=n.plots_flipXAxis,this.memory.scale=n.scale,this.memory.width=r,this.memory.height=s},r.drawPlot=function(e,n,r,s,o,u,a){this.specs&&(n=this.specs),e.strokeStyle=n.plots_color,e.lineWidth=n.plots_width;var f=[];e.save(),e.rect(u,o,r-u,s-a-o),e.clip(),e.beginPath();if(this.continuous)for(var l=!1,c=0,p=!1,d=0,v=this.data.length;d<v;d++){var m=this.getTransformedX(this.data[d].x,n,r,u),g;d<v&&!l&&this.data[d+1]&&(g=this.getTransformedX(this.data[d+1].x,n,r,u));if(m>=u&&m<r||void 0!==g&&g>=u&&g<r){var y=this.getTransformedY(this.data[d].y,n,s,a,o);n.plots_showIntegration&&i.abs(this.data[d].y)>this.integrationSensitivity&&f.push(new t.Point(this.data[d].x,this.data[d].y)),l||(e.moveTo(m,y),l=!0),e.lineTo(m,y),c++,0===c%1e3&&(e.stroke(),e.beginPath(),e.moveTo(m,y));if(p)break}else l&&(p=!0)}else{d=0;for(v=this.data.length;d<v;d++)m=this.getTransformedX(this.data[d].x,n,r,u),m>=u&&m<r&&(e.moveTo(m,s-a),e.lineTo(m,this.getTransformedY(this.data[d].y,n,s,a,o)))}e.stroke();if(n.plots_showIntegration&&1<f.length){e.strokeStyle=n.plots_integrationColor,e.lineWidth=n.plots_integrationLineWidth,e.beginPath(),d=f[1].x>f[0].x;if(this.flipXAxis&&!d||!this.flipXAxis&&d){for(d=f.length-2;0<=d;d--)f[d].y+=f[d+1].y;l=f[0].y}else{d=1;for(v=f.length;d<v;d++)f[d].y+=f[d-1].y;l=f[f.length-1].y}d=0;for(v=f.length;d<v;d++)m=this.getTransformedX(f[d].x,n,r,u),y=this.getTransformedY(f[d].y/n.scale/l,n,s,a,o),0===d?e.moveTo(m,y):e.lineTo(m,y);e.stroke()}e.restore()},r.getTransformedY=function(e,t,n,r,i){return i+(n-r-i)*(1-e*t.scale)},r.getInverseTransformedY=function(e){return 100*((1-(e-this.memory.offsetTop)/(this.memory.height-this.memory.offsetBottom-this.memory.offsetTop))/this.memory.scale)},r.getTransformedX=function(e,t,n,r){return e=r+(e-this.minX)/(this.maxX-this.minX)*(n-r),t.plots_flipXAxis&&(e=n+r-e),e},r.getInverseTransformedX=function(e){return this.memory.flipXAxis&&(e=this.memory.width+this.memory.offsetLeft-e),(e-this.memory.offsetLeft)*(this.maxX-this.minX)/(this.memory.width-this.memory.offsetLeft)+this.minX},r.setup=function(){for(var e=Number.MAX_VALUE,t=Number.MIN_VALUE,n=Number.MIN_VALUE,r=0,s=this.data.length;r<s;r++)e=i.min(e,this.data[r].x),t=i.max(t,this.data[r].x),n=i.max(n,this.data[r].y);this.continuous?(this.minX=e,this.maxX=t):(this.minX=e-1,this.maxX=t+1),r=0;for(s=this.data.length;r<s;r++)this.data[r].y/=n},r.zoom=function(e,t,r,s){e=this.getInverseTransformedX(e),t=this.getInverseTransformedX(t),this.minX=i.min(e,t),this.maxX=i.max(e,t);if(s){s=Number.MIN_VALUE,t=0;for(e=this.data.length;t<e;t++)n.isBetween(this.data[t].x,this.minX,this.maxX)&&(s=i.max(s,this.data[t].y));return 1/s}},r.translate=function(e,t){var n=e/(t-this.memory.offsetLeft)*(this.maxX-this.minX)*(this.memory.flipXAxis?1:-1);this.minX+=n,this.maxX+=n},r.alertMetadata=function(){alert(this.metadata.join("\n"))},r.getInternalCoordinates=function(e,t){return new ChemDoodle.structures.Point(this.getInverseTransformedX(e),this.getInverseTransformedY(t))},r.getClosestPlotInternalCoordinates=function(e){var t=this.getInverseTransformedX(e-1);e=this.getInverseTransformedX(e+1);if(t>e){var r=t,t=e;e=r}for(var r=-1,i=-Infinity,s=!1,u=0,a=this.data.length;u<a;u++){var f=this.data[u];if(n.isBetween(f.x,t,e))f.y>i&&(s=!0,i=f.y,r=u);else if(s)break}if(-1!==r)return f=this.data[r],new ChemDoodle.structures.Point(f.x,100*f.y)},r.getClosestPeakInternalCoordinates=function(e){var t=this.getInverseTransformedX(e);e=0;for(var n=Infinity,r=0,s=this.data.length;r<s;r++){var o=i.abs(this.data[r].x-t);if(!(o<=n))break;n=o,e=r}for(var n=t=e,o=this.data[e].y,u=this.data[e].y,r=e+1,s=this.data.length;r<s;r++){if(!(this.data[r].y+.05>u))break;u=this.data[r].y,n=r}for(r=e-1;0<=r;r--){if(!(this.data[r].y+.05>o))break;o=this.data[r].y,t=r}return e=this.data[t-e>n-e?n:t],new ChemDoodle.structures.Point(e.x,100*e.y)}}(ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,ChemDoodle.lib.jQuery,Math),function(e,t,n){t._Shape=function(){},t=t._Shape.prototype,t.drawDecorations=function(e,t){if(this.isHover)for(var n=this.getPoints(),r=0,i=n.length;r<i;r++){var s=n[r];this.drawAnchor(e,t,s,s===this.hoverPoint)}},t.getBounds=function(){for(var t=new e.Bounds,n=this.getPoints(),r=0,i=n.length;r<i;r++){var s=n[r];t.expand(s.x,s.y)}return t},t.drawAnchor=function(e,t,r,i){e.save(),e.translate(r.x,r.y),e.rotate(n.PI/4),e.scale(1/t.scale,1/t.scale),e.beginPath(),e.moveTo(-4,-4),e.lineTo(4,-4),e.lineTo(4,4),e.lineTo(-4,4),e.closePath(),e.fillStyle=i?"#885110":"white",e.fill(),e.beginPath(),e.moveTo(-4,-2),e.lineTo(-4,-4),e.lineTo(-2,-4),e.moveTo(2,-4),e.lineTo(4,-4),e.lineTo(4,-2),e.moveTo(4,2),e.lineTo(4,4),e.lineTo(2,4),e.moveTo(-2,4),e.lineTo(-4,4),e.lineTo(-4,2),e.moveTo(-4,-2),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=5,e.stroke(),e.strokeStyle="blue",e.lineWidth=1,e.stroke(),e.restore()}}(ChemDoodle.math,ChemDoodle.structures.d2,Math),function(e,t,n,r,i){r.Bracket=function(e,t){this.p1=e?e:new n.Point,this.p2=t?t:new n.Point},r=r.Bracket.prototype=new r._Shape,r.charge=0,r.mult=0,r.repeat=0,r.draw=function(t,n){var r=i.min(this.p1.x,this.p2.x),s=i.max(this.p1.x,this.p2.x),o=i.min(this.p1.y,this.p2.y),u=i.max(this.p1.y,this.p2.y),a=u-o,f=a/10;t.beginPath(),t.moveTo(r+f,o),t.lineTo(r,o),t.lineTo(r,u),t.lineTo(r+f,u),t.moveTo(s-f,u),t.lineTo(s,u),t.lineTo(s,o),t.lineTo(s-f,o),this.isLassoed&&(f=t.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y),f.addColorStop(0,"rgba(212, 99, 0, 0)"),f.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),f.addColorStop(1,"rgba(212, 99, 0, 0)"),t.lineWidth=n.shapes_lineWidth+5,t.strokeStyle=f,t.lineJoin="miter",t.lineCap="square",t.stroke()),t.strokeStyle=n.shapes_color,t.lineWidth=n.shapes_lineWidth,t.lineJoin="miter",t.lineCap="butt",t.stroke(),0!==this.charge&&(t.fillStyle=n.text_color,t.textAlign="left",t.textBaseline="alphabetic",t.font=e.getFontString(n.text_font_size,n.text_font_families),f=this.charge.toFixed(0),f="1"===f?"+":"-1"===f?"–":e.stringStartsWith(f,"-")?f.substring(1)+"–":f+"+",t.fillText(f,s+5,o+5)),0!==this.mult&&(t.fillStyle=n.text_color,t.textAlign="right",t.textBaseline="middle",t.font=e.getFontString(n.text_font_size,n.text_font_families),t.fillText(this.mult.toFixed(0),r-5,o+a/2)),0!==this.repeat&&(t.fillStyle=n.text_color,t.textAlign="left",t.textBaseline="top",t.font=e.getFontString(n.text_font_size,n.text_font_families),f=this.repeat.toFixed(0),t.fillText
(f,s+5,u-5))},r.getPoints=function(){return[this.p1,this.p2]},r.isOver=function(e){return t.isBetween(e.x,this.p1.x,this.p2.x)&&t.isBetween(e.y,this.p1.y,this.p2.y)}}(ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math),function(e,t,n,r){n.Line=function(e,n){this.p1=e?e:new t.Point,this.p2=n?n:new t.Point},n.Line.ARROW_SYNTHETIC="synthetic",n.Line.ARROW_RETROSYNTHETIC="retrosynthetic",n.Line.ARROW_RESONANCE="resonance",n.Line.ARROW_EQUILIBRIUM="equilibrium";var i=n.Line.prototype=new n._Shape;i.arrowType=void 0,i.topText=void 0,i.bottomText=void 0,i.draw=function(e,t){if(this.isLassoed){var i=e.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y);i.addColorStop(0,"rgba(212, 99, 0, 0)"),i.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),i.addColorStop(1,"rgba(212, 99, 0, 0)");var s=2.5,u=this.p1.angle(this.p2)+r.PI/2,a=r.cos(u),u=r.sin(u),f=this.p1.x-a*s,c=this.p1.y+u*s,h=this.p1.x+a*s,p=this.p1.y-u*s,d=this.p2.x+a*s,v=this.p2.y-u*s,m=this.p2.x-a*s,g=this.p2.y+u*s;e.fillStyle=i,e.beginPath(),e.moveTo(f,c),e.lineTo(h,p),e.lineTo(d,v),e.lineTo(m,g),e.closePath(),e.fill()}e.strokeStyle=t.shapes_color,e.fillStyle=t.shapes_color,e.lineWidth=t.shapes_lineWidth,e.lineJoin="miter",e.lineCap="butt";if(this.p1.x!==this.p2.x||this.p1.y!==this.p2.y){if(this.arrowType===n.Line.ARROW_RETROSYNTHETIC){var i=2*r.sqrt(2),s=t.shapes_arrowLength_2D/i,a=this.p1.angle(this.p2),u=a+r.PI/2,i=t.shapes_arrowLength_2D/i,y=r.cos(a),b=r.sin(a),a=r.cos(u),u=r.sin(u),f=this.p1.x-a*s,c=this.p1.y+u*s,h=this.p1.x+a*s,p=this.p1.y-u*s,d=this.p2.x+a*s-y*i,v=this.p2.y-u*s+b*i,m=this.p2.x-a*s-y*i,g=this.p2.y+u*s+b*i,w=this.p2.x+2*a*s-2*y*i,E=this.p2.y-2*u*s+2*b*i,S=this.p2.x-2*a*s-2*y*i,s=this.p2.y+2*u*s+2*b*i;e.beginPath(),e.moveTo(h,p),e.lineTo(d,v),e.moveTo(w,E),e.lineTo(this.p2.x,this.p2.y),e.lineTo(S,s),e.moveTo(m,g),e.lineTo(f,c)}else this.arrowType===n.Line.ARROW_EQUILIBRIUM?(i=2*r.sqrt(2),s=t.shapes_arrowLength_2D/i/2,a=this.p1.angle(this.p2),u=a+r.PI/2,i=2*t.shapes_arrowLength_2D/r.sqrt(3),y=r.cos(a),b=r.sin(a),a=r.cos(u),u=r.sin(u),f=this.p1.x-a*s,c=this.p1.y+u*s,h=this.p1.x+a*s,p=this.p1.y-u*s,d=this.p2.x+a*s,v=this.p2.y-u*s,m=this.p2.x-a*s,g=this.p2.y+u*s,e.beginPath(),e.moveTo(h,p),e.lineTo(d,v),e.moveTo(m,g),e.lineTo(f,c),e.stroke(),h=d-.8*y*i,p=v+.8*b*i,w=d+a*t.shapes_arrowLength_2D/3-y*i,E=v-u*t.shapes_arrowLength_2D/3+b*i,e.beginPath(),e.moveTo(d,v),e.lineTo(w,E),e.lineTo(h,p),e.closePath(),e.fill(),e.stroke(),h=f+.8*y*i,p=c-.8*b*i,w=f-a*t.shapes_arrowLength_2D/3+y*i,E=c+u*t.shapes_arrowLength_2D/3-b*i,e.beginPath(),e.moveTo(f,c),e.lineTo(w,E),e.lineTo(h,p),e.closePath(),e.fill()):this.arrowType===n.Line.ARROW_SYNTHETIC?(a=this.p1.angle(this.p2),u=a+r.PI/2,i=2*t.shapes_arrowLength_2D/r.sqrt(3),y=r.cos(a),b=r.sin(a),a=r.cos(u),u=r.sin(u),e.beginPath(),e.moveTo(this.p1.x,this.p1.y),e.lineTo(this.p2.x-y*i/2,this.p2.y+b*i/2),e.stroke(),h=this.p2.x-.8*y*i,p=this.p2.y+.8*b*i,w=this.p2.x+a*t.shapes_arrowLength_2D/3-y*i,E=this.p2.y-u*t.shapes_arrowLength_2D/3+b*i,S=this.p2.x-a*t.shapes_arrowLength_2D/3-y*i,s=this.p2.y+u*t.shapes_arrowLength_2D/3+b*i,e.beginPath(),e.moveTo(this.p2.x,this.p2.y),e.lineTo(S,s),e.lineTo(h,p),e.lineTo(w,E),e.closePath(),e.fill()):this.arrowType===n.Line.ARROW_RESONANCE?(a=this.p1.angle(this.p2),u=a+r.PI/2,i=2*t.shapes_arrowLength_2D/r.sqrt(3),y=r.cos(a),b=r.sin(a),a=r.cos(u),u=r.sin(u),e.beginPath(),e.moveTo(this.p1.x+y*i/2,this.p1.y-b*i/2),e.lineTo(this.p2.x-y*i/2,this.p2.y+b*i/2),e.stroke(),h=this.p2.x-.8*y*i,p=this.p2.y+.8*b*i,w=this.p2.x+a*t.shapes_arrowLength_2D/3-y*i,E=this.p2.y-u*t.shapes_arrowLength_2D/3+b*i,S=this.p2.x-a*t.shapes_arrowLength_2D/3-y*i,s=this.p2.y+u*t.shapes_arrowLength_2D/3+b*i,e.beginPath(),e.moveTo(this.p2.x,this.p2.y),e.lineTo(S,s),e.lineTo(h,p),e.lineTo(w,E),e.closePath(),e.fill(),e.stroke(),h=this.p1.x+.8*y*i,p=this.p1.y-.8*b*i,w=this.p1.x-a*t.shapes_arrowLength_2D/3+y*i,E=this.p1.y+u*t.shapes_arrowLength_2D/3-b*i,S=this.p1.x+a*t.shapes_arrowLength_2D/3+y*i,s=this.p1.y-u*t.shapes_arrowLength_2D/3-b*i,e.beginPath(),e.moveTo(this.p1.x,this.p1.y),e.lineTo(S,s),e.lineTo(h,p),e.lineTo(w,E),e.closePath(),e.fill()):(e.beginPath(),e.moveTo(this.p1.x,this.p1.y),e.lineTo(this.p2.x,this.p2.y));e.stroke(),this.topText&&(e.textAlign="center",e.textBaseline="bottom",e.fillText(this.topText,(this.p1.x+this.p2.x)/2,this.p1.y-5)),this.bottomText&&(e.textAlign="center",e.textBaseline="top",e.fillText(this.bottomText,(this.p1.x+this.p2.x)/2,this.p1.y+5))}},i.getPoints=function(){return[this.p1,this.p2]},i.isOver=function(t,n){var r=e.distanceFromPointToLineInclusive(t,this.p1,this.p2);return-1!==r&&r<n}}(ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math),function(e,t,n,r,i){var s=function(e){var t=[];if(e instanceof n.Atom){if(0===e.bondNumber)t.push(i.PI);else if(e.angles){if(1===e.angles.length)t.push(e.angles[0]+i.PI);else{for(var r=1,s=e.angles.length;r<s;r++)t.push(e.angles[r-1]+(e.angles[r]-e.angles[r-1])/2);r=e.angles[e.angles.length-1],t.push(r+(e.angles[0]+2*i.PI-r)/2)}e.largestAngle>i.PI&&(t=[e.angleOfLeastInterference]);if(e.bonds){r=0;for(s=e.bonds.length;r<s;r++){var o=e.bonds[r];if(2===o.bondOrder&&(o=o.getNeighbor(e),"O"===o.label)){t=[o.angle(e)];break}}}}}else e=e.a1.angle(e.a2),t.push(e+i.PI/2),t.push(e+3*i.PI/2);r=0;for(s=t.length;r<s;r++){for(;t[r]>2*i.PI;)t[r]-=2*i.PI;for(;0>t[r];)t[r]+=2*i.PI}return t},o=function(e,t){var r=3;if(e instanceof n.Atom){if(e.isLabelVisible(t)&&(r=8),0!==e.charge||0!==e.numRadical||0!==e.numLonePair)r=13}else e instanceof n.Point?r=0:1<e.bondOrder&&(r=5);return r},u=function(e,t,r,s,u,a,f,l,c,p){var d=a.angle(u),v=f.angle(l),m=i.cos(d),d=i.sin(d),g=o(r,t);u.x-=m*g,u.y+=d*g,g=v+i.PI/2,r=2*t.shapes_arrowLength_2D/i.sqrt(3);var m=i.cos(v),d=i.sin(v),y=i.cos(g),b=i.sin(g);l.x-=5*m,l.y+=5*d,v=new n.Point(l.x,l.y),g=o(s,t)/3,v.x-=m*g,v.y+=d*g,l.x-=m*(.8*r+g),l.y+=d*(.8*r+g),s=v.x-.8*m*r;var g=v.y+.8*d*r,w=new n.Point(v.x+y*t.shapes_arrowLength_2D/3-m*r,v.y-b*t.shapes_arrowLength_2D/3+d*r);t=new n.Point(v.x-y*t.shapes_arrowLength_2D/3-m*r,v.y+b*t.shapes_arrowLength_2D/3+d*r),d=m=!0,1===c&&(w.distance(a)>t.distance(a)?d=!1:m=!1),e.beginPath(),e.moveTo(v.x,v.y),d&&e.lineTo(t.x,t.y),e.lineTo(s,g),m&&e.lineTo(w.x,w.y),e.closePath(),e.fill(),e.stroke(),e.beginPath(),e.moveTo(u.x,u.y),e.bezierCurveTo(a.x,a.y,f.x,f.y,l.x,l.y),e.stroke(),p.push([u,a,f,l])};r.Pusher=function(e,t,n){this.o1=e,this.o2=t,this.numElectron=n?n:1},r=r.Pusher.prototype=new r._Shape,r.drawDecorations=function(e,t){if(this.isHover)for(var r=this.o1 instanceof n.Atom?new n.Point(this.o1.x,this.o1.y):this.o1.getCenter(),i=this.o2 instanceof n.Atom?new n.Point(this.o2.x,this.o2.y):this.o2.getCenter(),r=[r,i],i=0,s=r.length;i<s;i++){var o=r[i];this.drawAnchor(e,t,o,o===this.hoverPoint)}},r.draw=function(t,r){if(this.o1&&this.o2){t.strokeStyle=r.shapes_color,t.fillStyle=r.shapes_color,t.lineWidth=r.shapes_lineWidth,t.lineJoin="miter",t.lineCap="butt";for(var o=this.o1 instanceof n.Atom?new n.Point(this.o1.x,this.o1.y):this.o1.getCenter(),f=this.o2 instanceof n.Atom?new n.Point(this.o2.x,this.o2.y):this.o2.getCenter(),l=s(this.o1),c=s(this.o2),p,d,v=Infinity,m=0,y=l.length;m<y;m++)for(var w=0,E=c.length;w<E;w++){var S=new n.Point(o.x+35*i.cos(l[m]),o.y-35*i.sin(l[m])),x=new n.Point(f.x+35*i.cos(c[w]),f.y-35*i.sin(c[w])),T=S.distance(x);T<v&&(v=T,p=S,d=x)}this.caches=[],-1===this.numElectron?(m=o.distance(f)/2,c=o.angle(f),l=c+i.PI/2,y=i.cos(c),w=i.sin(c),c=new n.Point(o.x+(m-1)*y,o.y-(m-1)*w),v=new n.Point(c.x+35*i.cos(l+i.PI/6),c.y-35*i.sin(l+i.PI/6)),m=new n.Point(o.x+(m+1)*y,o.y-(m+1)*w),l=new n.Point(m.x+35*i.cos(l-i.PI/6),m.y-35*i.sin(l-i.PI/6)),u(t,r,this.o1,c,o,p,v,c,1,this.caches),u(t,r,this.o2,m,f,d,l,m,1,this.caches)):(e.intersectLines(o.x,o.y,p.x,p.y,f.x,f.y,d.x,d.y)&&(l=p,p=d,d=l),l=p.angle(o),c=d.angle(f),v=i.max(l,c)-i.min(l,c),.001>i.abs(v-i.PI)&&this.o1.molCenter===this.o2.molCenter&&(l+=i.PI/2,c-=i.PI/2,p.x=o.x+35*i.cos(l+i.PI),p.y=o.y-35*i.sin(l+i.PI),d.x=f.x+35*i.cos(c+i.PI),d.y=f.y-35*i.sin(c+i.PI)),u(t,r,this.o1,this.o2,o,p,d,f,this.numElectron,this.caches))}},r.getPoints=function(){return[]},r.isOver=function(e,n){for(var r=0,i=this.caches.length;r<i;r++)if(t.distanceFromCurve(e,this.caches[r]).distance<n)return!0;return!1}}(ChemDoodle.math,ChemDoodle.math.jsBezier,ChemDoodle.structures,ChemDoodle.structures.d2,Math),function(e){e._Mesh=function(){},e=e._Mesh.prototype,e.storeData=function(e,t,n){this.positionData=e,this.normalData=t,this.indexData=n},e.setupBuffers=function(e){this.vertexPositionBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertexPositionBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.positionData),e.STATIC_DRAW),this.vertexPositionBuffer.itemSize=3,this.vertexPositionBuffer.numItems=this.positionData.length/3,this.vertexNormalBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.vertexNormalBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.normalData),e.STATIC_DRAW),this.vertexNormalBuffer.itemSize=3,this.vertexNormalBuffer.numItems=this.normalData.length/3,this.indexData&&(this.vertexIndexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexData),e.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexData.length);if(this.partitions)for(var t=0,n=this.partitions.length;t<n;t++){var r=this.partitions[t],i=this.generateBuffers(e,r.positionData,r.normalData,r.indexData);r.vertexPositionBuffer=i[0],r.vertexNormalBuffer=i[1],r.vertexIndexBuffer=i[2]}},e.generateBuffers=function(e,t,n,r){var i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),i.itemSize=3,i.numItems=t.length/3,t=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW),t.itemSize=3,t.numItems=n.length/3;var s;return r&&(s=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(r),e.STATIC_DRAW),s.itemSize=1,s.numItems=r.length),[i,t,s]},e.bindBuffers=function(e){this.vertexPositionBuffer||this.setupBuffers(e),e.bindBuffer(e.ARRAY_BUFFER,this.vertexPositionBuffer),e.vertexAttribPointer(e.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexNormalBuffer),e.vertexAttribPointer(e.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,e.FLOAT,!1,0,0),this.vertexIndexBuffer&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}}(ChemDoodle.structures.d3,Math),function(e){e._Measurement=function(){},(e._Measurement.prototype=new e._Mesh).render=function(e,t){e.setMatrixUniforms(e.modelViewMatrix),t.measurement_update_3D&&(this.text=this.vertexPositionBuffer=void 0),this.vertexPositionBuffer||this.calculateData(t),this.bindBuffers(e),e.material.setDiffuseColor(t.shapes_color),e.lineWidth(t.shapes_lineWidth),e.drawElements(e.LINES,this.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0);if(t.measurement_displayText_3D){this.text||(this.text=this.getText(t));var n={position:[],texCoord:[],translation:[]};e.textImage.pushVertexData(this.text.value,this.text.pos,1,n),e.textMesh.storeData(e,n.position,n.texCoord,n.translation),e.enable(e.BLEND),e.depthMask(!1),e.enableVertexAttribArray(e.shader.vertexTexCoordAttribute),e.textImage.useTexture(e),e.textMesh.render(e),e.disableVertexAttribArray(e.shader.vertexTexCoordAttribute),e.disable(e.BLEND),e.depthMask(!0)}}}(ChemDoodle.structures.d3),function(e,t,n,r,i,s,o){n.Angle=function(e,t,n){this.a1=e,this.a2=t,this.a3=n},e=n.Angle.prototype=new n._Measurement,e.calculateData=function(e){var n=[],r=[],s=[],u=this.a2.distance3D(this.a1),a=this.a2.distance3D(this.a3);this.distUse=i.min(u,a)/2,this.vec1=o.normalize([this.a1.x-this.a2.x,this.a1.y-this.a2.y,this.a1.z-this.a2.z]),this.vec2=o.normalize([this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z]),this.angle=t.vec3AngleFrom(this.vec1,this.vec2),u=o.normalize(o.cross(this.vec1,this.vec2,[])),u=o.normalize(o.cross(u,this.vec1,[])),e=e.measurement_angleBands_3D;for(a=0;a<=e;++a){var f=this.angle*a/e,l=o.scale(this.vec1,i.cos(f),[]),f=o.scale(u,i.sin(f),[]),l=o.scale(o.normalize(o.add(l,f,[])),this.distUse);n.push(this.a2.x+l[0],this.a2.y+l[1],this.a2.z+l[2]),r.push(0,0,0),a<e&&s.push(a,a+1)}this.storeData(n,r,s)},e.getText=function(){var e=o.scale(o.normalize(o.add(this.vec1,this.vec2,[])),this.distUse+.3);return{pos:[this.a2.x+e[0],this.a2.y+e[1],this.a2.z+e[2]],value:[r.angleBounds(this.angle,!0).toFixed(2)," °"].join("")}}}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures.d3,ChemDoodle.math,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(e,t){e.Arrow=function(e,n){for(var r=[],i=[],s=0;s<=n;s++){var o=2*s*t.PI/n,u=t.sin(o),o=t.cos(o);i.push(0,0,-1,0,0,-1,o,u,0,o,u,0,0,0,-1,0,0,-1,o,u,1,o,u,1),r.push(0,0,0,e*o,e*u,0,e*o,e*u,0,e*o,e*u,2,e*o,e*u,2,2*e*o,2*e*u,2,2*e*o,2*e*u,2,0,0,3)}s=[];for(u=0;u<n;u++)for(var o=8*u,a=0;7>a;a++){var f=a+o,l=f+7+2;s.push(f,l,f+1,l,f,l-1)}this.storeData(r,i,s)},e.Arrow.prototype=new e._Mesh}(ChemDoodle.structures.d3,Math),function(e){e.Box=function(e,t,n){e/=2,n/=2;var r=[],i=[];r.push(e,t,-n),r.push(e,t,-n),r.push(-e,t,-n),r.push(e,t,n),r.push(-e,t,n),r.push(-e,t,n);for(var s=6;s--;i.push(0,1,0));r.push(-e,t,n),r.push(-e,t,n),r.push(-e,0,n),r.push(e,t,n),r.push(e,0,n),r.push(e,0,n);for(s=6;s--;i.push(0,0,1));r.push(e,t,n),r.push(e,t,n),r.push(e,0,n),r.push(e,t,-n),r.push(e,0,-n),r.push(e,0,-n);for(s=6;s--;i.push(1,0,0));r.push(e,t,-n),r.push(e,t,-n),r.push(e,0,-n),r.push(-e,t,-n),r.push(-e,0,-n),r.push(-e,0,-n);for(s=6;s--;i.push(0,0,-1));r.push(-e,t,-n),r.push(-e,t,-n),r.push(-e,0,-n),r.push(-e,t,n),r.push(-e,0,n),r.push(-e,0,n);for(s=6;s--;i.push(-1,0,0));r.push(-e,0,n),r.push(-e,0,n),r.push(-e,0,-n),r.push(e,0,n),r.push(e,0,-n),r.push(e,0,-n);for(s=6;s--;i.push(0,-1,0));this.storeData(r,i)},e.Box.prototype=new e._Mesh}(ChemDoodle.structures.d3,Math),function(e,t,n){e.LineArrow=function(){this.storeData([0,0,-3,.1,0,-2.8,0,0,-3,-0.1,0,-2.8,0,0,-3,0,0,3,0,0,3,.1,0,2.8,0,0,3,-0.1,0,2.8],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},e.LineArrow.prototype=new e._Mesh,e.Compass=function(r,i){this.textImage=new e.TextImage,this.textImage.init(r),this.textImage.updateFont(r,i.text_font_size,i.text_font_families,i.text_font_bold,i.text_font_italic,i.text_font_stroke_3D),this.textMesh=new e.TextMesh,this.textMesh.init(r);var s=3/(i.compass_size_3D/r.canvas.clientHeight),u=t.tan(i.projectionPerspectiveVerticalFieldOfView_3D/360*t.PI),a=s/u,f=t.max(a-s,.1),l=r.canvas.clientWidth/r.canvas.clientHeight,c,h;i.projectionPerspective_3D?(h=f,c=n.frustum):(h=a,c=n.ortho);var p=2*(h/r.canvas.clientHeight)*u,u=u*h;h=-u;var d=l*h,l=l*u;if(0===i.compass_type_3D){var v=(-(r.canvas.clientWidth-i.compass_size_3D)/2+this.textImage.charHeight)*p,p=(-(r.canvas.clientHeight-i.compass_size_3D)/2+this.textImage.charHeight)*p,d=d-v,l=l-v;h-=p,u-=p}this.projectionMatrix=c(d,l,h,u,f,a+s),this.translationMatrix=n.translate(n.identity([]),[0,0,-a]),s={position:[],texCoord:[],translation:[]},this.textImage.pushVertexData("X",[3.5,0,0],0,s),this.textImage.pushVertexData("Y",[0,3.5,0],0,s),this.textImage.pushVertexData("Z",[0,0,3.5],0,s),this.textMesh.storeData(r,s.position,s.texCoord,s.translation)};var r=e.Compass.prototype;r.renderArrow=function(e,t,n,r){e.material.setDiffuseColor(n),e.setMatrixUniforms(r),1===t?e.drawArrays(e.LINES,0,e.lineArrowBuffer.vertexPositionBuffer.numItems):e.drawElements(e.TRIANGLES,e.arrowBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)},r.render=function(e,r){1===r.compass_type_3D?e.lineArrowBuffer.bindBuffers(e):e.arrowBuffer.bindBuffers(e),e.material.setTempColors(r.bonds_materialAmbientColor_3D,void 0,r.bonds_materialSpecularColor_3D,r.bonds_materialShininess_3D);var i=n.multiply(this.translationMatrix,e.rotationMatrix,[]),s=t.PI/2;e.fogging.setMode(0),this.renderArrow(e,r.compass_type_3D,r.compass_axisXColor_3D,n.rotateY(i,s,[])),this.renderArrow(e,r.compass_type_3D,r.compass_axisYColor_3D,n.rotateX(i,-s,[])),this.renderArrow(e,r.compass_type_3D,r.compass_axisZColor_3D,i)},r.renderAxis=function(e){var t=n.multiply(this.translationMatrix,e.rotationMatrix,[]);e.setMatrixUniforms(t),this.textImage.useTexture(e),this.textMesh.render(e)}}(ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4),function(e,t){e.Cylinder=function(e,n,r,i){var s=[],o=[];if(i){for(i=0;i<=r;i++){var u=2*(i%r)*t.PI/r,a=t.cos(u),u=t.sin(u);o.push(0,-1,0),s.push(0,0,0),o.push(0,-1,0),s.push(e*a,0,e*u)}for(i=0;i<=r;i++)u=2*(i%r)*t.PI/r,a=t.cos(u),u=t.sin(u),o.push(a,0,u),s.push(e*a,0,e*u),o.push(a,0,u),s.push(e*a,n,e*u);for(i=0;i<=r;i++)u=2*(i%r)*t.PI/r,a=t.cos(u),u=t.sin(u),o.push(0,1,0),s.push(e*a,n,e*u),o.push(0,1,0),s.push(0,n,0)}else{for(i=0;i<r;i++)u=2*i*t.PI/r,a=t.cos(u),u=t.sin(u),o.push(a,0,u),s.push(e*a,0,e*u),o.push(a,0,u),s.push(e*a,n,e*u);o.push(1,0,0),s.push(e,0,0),o.push(1,0,0),s.push(e,n,0)}this.storeData(s,o)},e.Cylinder.prototype=new e._Mesh}(ChemDoodle.structures.d3,Math),function(e,t,n,r){t.Distance=function(e,t,n,r){this.a1=e,this.a2=t,this.node=n,this.offset=r?r:0},t=t.Distance.prototype=new t._Measurement,t.calculateData=function(t){var i=[this.a1.x,this.a1.y,this.a1.z,this.a2.x,this.a2.y,this.a2.z];this.node&&(this.move=this.offset+n.max(t.atoms_useVDWDiameters_3D?e[this.a1.label].vdWRadius*t.atoms_vdwMultiplier_3D:t.atoms_sphereDiameter_3D/2,t.atoms_useVDWDiameters_3D?e[this.a2.label].vdWRadius*t.atoms_vdwMultiplier_3D:t.atoms_sphereDiameter_3D/2),this.displacement=[(this.a1.x+this.a2.x)/2-this.node.x,(this.a1.y+this.a2.y)/2-this.node.y,(this.a1.z+this.a2.z)/2-this.node.z],r.normalize(this.displacement),t=r.scale(this.displacement,this.move,[]),i[0]+=t[0],i[1]+=t[1],i[2]+=t[2],i[3]+=t[0],i[4]+=t[1],i[5]+=t[2]),this.storeData(i,[0,0,0,0,0,0],[0,1])},t.getText=function(){var e=this.a1.distance3D(this.a2),t=[(this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2,(this.a1.z+this.a2.z)/2];if(this.node){var n=r.scale(this.displacement,this.move+.1,[]);t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}return{pos:t,value:[e.toFixed(2)," Å"].join("")}}}(ChemDoodle.ELEMENT,ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3),function(e,t){t.Fog=function(e){this.gl=e,this.mUL=e.getUniformLocation(e.program,"u_fog_mode"),this.cUL=e.getUniformLocation(e.program,"u_fog_color"),this.sUL=e.getUniformLocation(e.program,"u_fog_start"),this.eUL=e.getUniformLocation(e.program,"u_fog_end"),this.dUL=e.getUniformLocation(e.program,"u_fog_density")};var n=t.Fog.prototype;n.setTempParameter=function(t,n,r,i){if(!this.cCache||this.cCache!==t)this.cCache=t,t=e.getRGB(t,1),this.gl.uniform3f(this.cUL,t[0],t[1],t[2]);if(!this.sCache||this.sCache!==n)this.sCache=n,this.gl.uniform1f(this.sUL,n);if(!this.eCache||this.eCache!==r)this.eCache=r,this.gl.uniform1f(this.eUL,r);if(!this.dCache||this.dCache!==i)this.dCache=i,this.gl.uniform1f(this.dUL,i)},n.setMode=function(e){if(!this.mCache||this.mCache!==e)this.mCache=e,this.gl.uniform1i(this.mUL,e)}}(ChemDoodle.math,ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(e,t){t.Label=function(){this.textImage=new t.TextImage};var n=t.Label.prototype;n.init=function(e,t){this.textImage.init(e),this.textImage.updateFont(e,t.atoms_font_size_2D,t.atoms_font_families_2D,t.atoms_font_bold_2D,t.atoms_font_italic_2D,t.text_font_stroke_3D)},n.updateVerticesBuffer=function(t,n,r){for(var i=0,s=n.length;i<s;i++){for(var o=n[i],u=o.labelMesh,a=o.atoms,f=this.textImage,l={position:[],texCoord:[],translation:[]},c=0<a.length&&void 0!=a[0].hetatm,h=0,p=a.length;h<p;h++){var d=a[h],v=d.label,m=.05;r.atoms_useVDWDiameters_3D?(v=e[v].vdWRadius*r.atoms_vdwMultiplier_3D,0===v&&(v=1),m+=v):r.atoms_sphereDiameter_3D&&(m+=1.5*(r.atoms_sphereDiameter_3D/2));if(c)if(d.hetatm){if(d.isWater&&!r.macro_showWaters)continue}else if(!r.macro_displayAtoms)continue;f.pushVertexData(d.altLabel?d.altLabel:d.label,[d.x,d.y,d.z],m,l)}if((o=o.chains)&&(r.proteins_displayRibbon||r.proteins_displayBackbone)){h=0;for(p=o.length;h<p;h++){a=o[h],c=0;for(m=a.length;c<m;c++)v=a[c],v.name&&(d=v.cp1,f.pushVertexData(v.name,[d.x,d.y,d.z],2,l))}}u.storeData(t,l.position,l.texCoord,l.translation,l.zDepth)}},n.render=function(e,t,n){e.setMatrixUniforms(e.modelViewMatrix),this.textImage.useTexture(e),t=0;for(var r=n.length;t<r;t++)n[t].labelMesh&&n[t].labelMesh.render(e)}}(ChemDoodle.ELEMENT,ChemDoodle.structures.d3),function(e,t){e.Sphere=function(e,n,r){for(var i=[],s=[],o=0;o<=n;o++)for(var u=o*t.PI/n,a=t.sin(u),f=t.cos(u),u=0;u<=r;u++){var l=2*u*t.PI/r,c=t.sin(l),l=t.cos(l)*a,h=f,c=c*a;s.push(l,h,c),i.push(e*l,e*h,e*c)}e=[],r+=1;for(o=0;o<n;o++)for(u=0;u<r;u++)a=o*r+u%r,f=a+r,e.push(a,a+1,f),u<r-1&&e.push(f,a+1,f+1);this.storeData(i,s,e)},e.Sphere.prototype=new e._Mesh}(ChemDoodle.structures.d3,Math),function(e,t,n,r){function i(e,t,n,r){this.entire=e,this.name=t,this.indexes=n,this.pi=r}var s=i.prototype;s.getColor=function(t){return t.macro_colorByChain?this.entire.chainColor:this.name?this.getResidueColor(e[this.name]?this.name:"*",t):this.helix?this.entire.front?t.proteins_ribbonCartoonHelixPrimaryColor:t.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?t.proteins_ribbonCartoonSheetColor:this.entire.front?t.proteins_primaryColor:t.proteins_secondaryColor},s.getResidueColor=function(t,n){var r=e[t];if("shapely"===n.proteins_residueColor)return r.shapelyColor;if("amino"===n.proteins_residueColor)return r.aminoColor;if("polarity"===n.proteins_residueColor){if(r.polar)return"#C10000"}else if("acidity"===n.proteins_residueColor){if(1===r.acidity)return"#0000FF";if(-1===r.acidity)return"#FF0000";if(!r.polar)return"#773300"}return"#FFFFFF"},s.render=function(e,t,n){if(this.entire.partitions&&this.pi!==this.entire.partitions.lastRender){var r=this.entire.partitions[this.pi];e.bindBuffer(e.ARRAY_BUFFER,r.vertexPositionBuffer),e.vertexAttribPointer(e.shader.vertexPositionAttribute,r.vertexPositionBuffer.itemSize,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,r.vertexNormalBuffer),e.vertexAttribPointer(e.shader.vertexNormalAttribute,r.vertexNormalBuffer.itemSize,e.FLOAT,!1,0,0),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.vertexIndexBuffer),this.entire.partitions.lastRender=this.pi}this.vertexIndexBuffer||(this.vertexIndexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexes),e.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexes.length),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),!n&&"rainbow"!==t.proteins_residueColor&&e.material.setDiffuseColor(this.getColor(t)),e.drawElements(e.TRIANGLES,this.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)},t.Ribbon=function(e,t,s){var u=e[0].lineSegments.length,a=e[0].lineSegments[0].length;this.partitions=[],this.partitions.lastRender=0;var f;this.front=0<t;for(var c=0,p=e.length;c<p;c++){if(!f||65e3<f.positionData.length)0<this.partitions.length&&c--,f={count:0,positionData:[],normalData:[]},this.partitions.push(f);var d=e[c];f.count++;for(var v=0;v<u;v++)for(var m=s?d.lineSegmentsCartoon[v]:d.lineSegments[v],g=0===v,y=!1,b=0;b<a;b++){var w=m[b],E=c,S=b+1;c===e.length-1&&b===a-1?S--:b===a-1&&(E++,S=0);var S=s?e[E].lineSegmentsCartoon[v][S]:e[E].lineSegments[v][S],E=!1,x=v+1;v===u-1&&(x-=2,E=!0);var x=s?d.lineSegmentsCartoon[x][b]:d.lineSegments[x][b],S=[S.x-w.x,S.y-w.y,S.z-w.z],x=[x.x-w.x,x.y-w.y,x.z-w.z],T=r.cross(S,x,[]);0===b&&(r.normalize(S),r.scale(S,-1),f.normalData.push(S[0],S[1],S[2]),f.positionData.push(w.x,w.y,w.z)),g||y?(r.normalize(x),r.scale(x,-1),f.normalData.push(x[0],x[1],x[2]),f.positionData.push(w.x,w.y,w.z),g&&b===a-1&&(g=!1,b=-1)):(r.normalize(T),(E&&!this.front||!E&&this.front)&&r.scale(T,-1),f.normalData.push(T[0],T[1],T[2]),r.scale(T,n.abs(t)),f.positionData.push(w.x+T[0],w.y+T[1],w.z+T[2]),v===u-1&&b===a-1&&(y=!0,b=-1));if(-1===b||b===a-1)r.normalize(S),f.normalData.push(S[0],S[1],S[2]),f.positionData.push(w.x,w.y,w.z)}}u+=2,a+=2,this.segments=[],this.partitionSegments=[],t=0;for(d=this.partitions.length;t<d;t++){f=this.partitions[t],m=[],c=0;for(p=f.count-1;c<p;c++){for(var N=c,v=0;v<t;v++)N+=this.partitions[v].count-1;N=e[N],g=c*u*a,f=[],v=0;for(y=u-1;v<y;v++){w=g+v*a;for(b=0;b<a;b++)E=1,c===p?E=0:b===a-1&&(E=u*a-b),E=[w+b,w+a+b,w+a+b+E,w+b,w+b+E,w+a+b+E],b!==a-1&&(this.front?f.push(E[0],E[1],E[2],E[3],E[5],E[4]):f.push(E[0],E[2],E[1],E[3],E[4],E[5])),b===a-2&&c<p&&(S=u*a-b,E[2]+=S,E[4]+=S,E[5]+=S),this.front?m.push(E[0],E[1],E[2],E[3],E[5],E[4]):m.push(E[0],E[2],E[1],E[3],E[4],E[5])}s&&N.split&&(v=new i(this,void 0,m,t),v.helix=N.helix,v.sheet=N.sheet,this.partitionSegments.push(v),m=[]),this.segments.push(new i(this,N.name,f,t))}v=new i(this,void 0,m,t),v.helix=N.helix,v.sheet=N.sheet,this.partitionSegments.push(v)}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData),1===this.partitions.length&&(this.partitions=void 0)},(t.Ribbon.prototype=new t._Mesh).render=function(e,t){this.bindBuffers(e);var n=t.macro_colorByChain?this.chainColor:void 0;n||(n=this.front?t.proteins_primaryColor:t.proteins_secondaryColor),e.material.setDiffuseColor(n);for(var n=0,r=this.partitionSegments.length;n<r;n++)this.partitionSegments[n].render(e,t,!t.proteins_ribbonCartoonize)}}(ChemDoodle.RESIDUE,ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3),function(e,t,n){t.Light=function(t,n,r){this.diffuseRGB=e.getRGB(t,1),this.specularRGB=e.getRGB(n,1),this.direction=r},t.Light.prototype.lightScene=function(e){e.uniform3f(e.getUniformLocation(e.program,"u_light_diffuse_color"),this.diffuseRGB[0],this.diffuseRGB[1],this.diffuseRGB[2]),e.uniform3f(e.getUniformLocation(e.program,"u_light_specular_color"),this.specularRGB[0],this.specularRGB[1],this.specularRGB[2]);var t=n.create(this.direction);n.normalize(t),n.negate(t),e.uniform3f(e.getUniformLocation(e.program,"u_light_direction"),t[0],t[1],t[2]);var r=[0,0,0],t=[r[0]+t[0],r[1]+t[1],r[2]+t[2]],r=n.length(t);0===r?t=[0,0,1]:n.scale(t,1/r),e.uniform3f(e.getUniformLocation(e.program,"u_light_half_vector"),t[0],t[1],t[2])}}(ChemDoodle.math,ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(e){e.Line=function(){this.storeData([0,0,0,0,1,0],[0,0,0,0,0,0])},e.Line.prototype=new e._Mesh}(ChemDoodle.structures.d3),function(e,t){t.Material=function(e){this.gl=e,this.aUL=e.getUniformLocation(e.program,"u_material_ambient_color"),this.dUL=e.getUniformLocation(e.program,"u_material_diffuse_color"),this.sUL=e.getUniformLocation(e.program,"u_material_specular_color"),this.snUL=e.getUniformLocation(e.program,"u_material_shininess"),this.alUL=e.getUniformLocation(e.program,"u_material_alpha")};var n=t.Material.prototype;n.setTempColors=function(t,n,r,i){if(!this.aCache||this.aCache!==t)this.aCache=t,t=e.getRGB(t,1),this.gl.uniform3f(this.aUL,t[0],t[1],t[2]);n&&(!this.dCache||this.dCache!==n)&&(this.dCache=n,t=e.getRGB(n,1),this.gl.uniform3f(this.dUL,t[0],t[1],t[2]));if(!this.sCache||this.sCache!==r)this.sCache=r,t=e.getRGB(r,1),this.gl.uniform3f(this.sUL,t[0],t[1],t[2]);if(!this.snCache||this.snCache!==i)this.snCache=i,this.gl.uniform1f(this.snUL,i);this.alCache=1,this.gl.uniform1f(this.alUL,1)},n.setDiffuseColor=function(t){if(!this.dCache||this.dCache!==t)this.dCache=t,t=e.getRGB(t,1),this.gl.uniform3f(this.dUL,t[0],t[1],t[2])},n.setAlpha=function(e){if(!this.alCache||this.alCache!==e)this.alCache=e,this.gl.uniform1f(this.alUL,e)}}(ChemDoodle.math,ChemDoodle.structures.d3),function(e,t,n,r){t.MolecularSurface=function(t,i,s,u,a){function f(e,t,n,r){var i=e.index;if(e.contained)for(var i=-1,s=Infinity,o=0,u=t.length;o<u;o++)for(var a=t[o],f=0,l=a.length;f<l;f++){var c=a[f];if(!c.contained&&c.index!==n&&c.index!==r){var h=c.distance3D(e);h<s&&(i=c.index,s=h)}}return i}for(var c=[],h=[],p=[],d=[],v=0;v<=i;v++)for(var m=v*r.PI/i,g=r.sin(m),y=r.cos(m),m=0;m<=s;m++){var w=2*m*r.PI/s;d.push(r.cos(w)*g,y,r.sin(w)*g)}g=[],v=0;for(m=t.atoms.length;v<m;v++){for(var y=[],E=t.atoms[v],S=n[E.label][a]+u,x=[],w=0,T=t.atoms.length;w<T;w++)if(w!==v){var N=t.atoms[w];N.index=w,E.distance3D(N)<S+n[N.label][a]+u&&x.push(N)}w=0;for(T=d.length;w<T;w+=3){for(var C=new e.Atom("C",E.x+S*d[w],E.y+S*d[w+1],E.z+S*d[w+2]),k=0,L=x.length;k<L;k++)if(N=x[k],C.distance3D(N)<n[N.label][a]+u){C.contained=!0;break}y.push(C)}g.push(y)}t=[],s++;for(v=0;v<i;v++)for(m=0;m<s;m++)a=v*s+m%s,u=a+s,t.push(a),t.push(u),t.push(a+1),m<s-1&&(t.push(u),t.push(u+1),t.push(a+1));v=k=0;for(m=g.length;v<m;v++){y=g[v],w=0;for(T=y.length;w<T;w++)C=y[w],C.contained||(C.index=k,k++,c.push(C.x,C.y,C.z),h.push(d[3*w],d[3*w+1],d[3*w+2]));w=0;for(T=t.length;w<T;w+=3)a=y[t[w]],u=y[t[w+1]],C=y[t[w+2]],!a.contained&&!u.contained&&!C.contained&&p.push(a.index,u.index,C.index)}d=[],v=0;for(m=g.length;v<m;v++){y=g[v],w=0;for(T=t.length;w<T;w+=3){a=y[t[w]],u=y[t[w+1]],C=y[t[w+2]],x=[],k=0;for(L=g.length;k<L;k++)k!==v&&x.push(g[k]);if((!a.contained||!u.contained||!C.contained)&&(a.contained||u.contained||C.contained))if(i=f(a,x,-1,-1),s=f(u,x,i,-1),x=f(C,x,i,s),-1!==i&&-1!==s&&-1!==x){u=!1,k=0;for(L=d.length;k<L;k+=3)if(a=d[k],C=d[k+1],E=d[k+2],S=s===a||s===C||s===E,N=x===a||x===C||x===E,(i===a||i===C||i===E)&&S&&N){u=!0;break}u||d.push(i,s,x)}}}p=p.concat(d),this.storeData(c,h,p)},t.MolecularSurface.prototype=new t._Mesh}(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.ELEMENT,Math),function(e){e.Picker=function(){},e=e.Picker.prototype,e.init=function(e){this.framebuffer=e.createFramebuffer();var t=e.createTexture(),n=e.createRenderbuffer();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindRenderbuffer(e.RENDERBUFFER,n),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,n),e.bindTexture(e.TEXTURE_2D,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null)},e.setDimension=function(e,t,n){e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer);var r=e.getFramebufferAttachmentParameter(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);e.isRenderbuffer(r)&&(e.bindRenderbuffer(e.RENDERBUFFER,r),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t,n),e.bindRenderbuffer(e.RENDERBUFFER,null)),r=e.getFramebufferAttachmentParameter(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME),e.isTexture(r)&&(e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,n,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindTexture(e.TEXTURE_2D,null)),e.bindFramebuffer(e.FRAMEBUFFER,null)},e.pick=function(e,t,n,r,i,s,o){var u=void 0,a=e.getParameter(e.COLOR_CLEAR_VALUE);e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),e.clearColor(1,1,1,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.fogging.setMode(0),e.disableVertexAttribArray(e.shader.vertexNormalAttribute);var f=[];e.material.setAlpha(255);for(var l=0,c=t.length;l<c;l++)t[l].renderPickFrame(e,n,f,s,o);return e.flush(),t=new Uint8Array(4),e.readPixels(r-2,i+2,1,1,e.RGBA,e.UNSIGNED_BYTE,t),0<t[3]&&(u=f[t[2]|t[1]<<8|t[0]<<16]),e.enableVertexAttribArray(e.shader.vertexNormalAttribute),e.fogging.setMode(n.fog_mode_3D),e.bindFramebuffer(e.FRAMEBUFFER,null),e.clearColor(a[0],a[1],a[2],a[3]),u}}(ChemDoodle.structures.d3,ChemDoodle.math,document),function(e,t){e.Pill=function(e,n,r,i){var s=1,o=2*e;n-=o,0>n?(s=0,n+=o):n<o&&(s=n/o,n=o);for(var o=[],u=[],a=0;a<=r;a++)for(var f=a*t.PI/r,l=t.sin(f),c=t.cos(f)*s,f=0;f<=i;f++){var h=2*f*t.PI/i,p=t.sin(h),h=t.cos(h)*l,d=c,p=p*l;u.push(h,d,p),o.push(e*h,e*d+(a<r/2?n:0),e*p)}e=[],i+=1;for(a=0;a<r;a++)for(f=0;f<i;f++)n=a*i+f%i,s=n+i,e.push(n,n+1,s),f<i-1&&e.push(s,n+1,s+1);this.storeData(o,u,e)},e.Pill.prototype=new e._Mesh}(ChemDoodle.structures.d3,Math),function(e,t,n,r,i,s,o){function u(e,t,r){var i=new n.Residue(-1);return i.cp1=i.cp2=new n.Atom("",e,t,r),i}function a(e,t){this.a1=e,this.a2=t}function f(e,t,n){this.a1=e,this.a2=t,this.vx=n}t=a.prototype,t.render=function(t,n){var r=this.a1,u=this.a2,a=1.001*r.distance3D(u),f=n.proteins_cylinderHelixDiameter/2,a=[f,a,f],f=s.translate(t.modelViewMatrix,[r.x,r.y,r.z],[]),l=[0,1,0],c=0;r.x===u.x&&r.z===u.z?(l=[0,0,1],u.y<r.y&&(c=i.PI)):(r=[u.x-r.x,u.y-r.y,u.z-r.z],c=e.vec3AngleFrom(l,r),l=o.cross(l,r,[])),0!==c&&s.rotate(f,c,l),s.scale(f,a),t.setMatrixUniforms(f),t.drawArrays(t.TRIANGLE_STRIP,0,t.cylinderClosedBuffer.vertexPositionBuffer.numItems)},t=f.prototype,t.render=function(e,t){this.specs&&(t=this.specs);var n=1.001*this.a1.distance3D(this.a2
),r=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],i=o.cross(r,this.vx,[]),u=o.cross(i,r,[]);o.normalize(u),o.normalize(r),o.normalize(i),n=[t.proteins_plankSheetWidth,n,t.proteins_tubeThickness],r=s.multiply(e.modelViewMatrix,[u[0],u[1],u[2],0,r[0],r[1],r[2],0,i[0],i[1],i[2],0,this.a1.x,this.a1.y,this.a1.z,1],[]),s.scale(r,n),e.setMatrixUniforms(r),e.drawArrays(e.TRIANGLE_STRIP,0,e.boxBuffer.vertexPositionBuffer.numItems)},r.PipePlank=function(e,t){this.tubes=[],this.helixCylinders=[],this.sheetPlanks=[],this.chainColor=e.chainColor;var s=[],c=[],p=[],v=[];if(1<e.length){var m=e[0],g=e[1];g.helix?p.push(m):g.sheet?v.push(m):c.push(m)}m=1;for(g=e.length-1;m<=g;m++){var y=e[m];if(y.helix){if(p.push(y),y.arrow){var b=o.create(),w=o.create();if(2==p.length)b=[p[0].cp1.x,p[0].cp1.y,p[0].cp1.z],w=[p[1].cp1.x,p[1].cp1.y,p[1].cp1.z];else{3==p.length&&p.unshift(e[i.max(m-3,0)]);for(var E=[],S=[],x=1,T=p.length-1;x<T;x++){var N=[p[x].cp1.x,p[x].cp1.y,p[x].cp1.z],C=[p[x-1].cp1.x,p[x-1].cp1.y,p[x-1].cp1.z],k=[p[x+1].cp1.x,p[x+1].cp1.y,p[x+1].cp1.z];o.subtract(C,N),o.subtract(k,N);var L=o.scale(C,o.length(k),[]),C=o.scale(k,o.length(C),[]),L=o.normalize(o.add(L,C,[]));E.push(N),S.push(L)}p=[],x=0;for(T=E.length-1;x<T;x++){var C=E[x],k=S[x],N=E[x+1],L=S[x+1],A=o.normalize(o.cross(k,L,[])),O=o.subtract(N,C,[]),M=o.dot(O,A),A=o.scale(A,M,[]),A=o.length(A),O=o.length(O),O=-(A*A-O*O)/(2*o.dot(o.subtract(C,N,[]),L)),C=o.add(C,o.scale(k,O,[]),[]),N=o.add(N,o.scale(L,O,[]),[]);p.push([C,N])}x=p[0][0],T=p[0][1],T=o.subtract(x,T,[]),o.add(x,T,b),x=p[p.length-1][1],T=p[p.length-1][0],T=o.subtract(x,T,[]),o.add(x,T,w)}x=new n.Atom("",b[0],b[1],b[2]),T=new n.Atom("",w[0],w[1],w[2]),this.helixCylinders.push(new a(x,T)),p=[],T=o.subtract(b,w,[]),o.normalize(T),o.scale(T,.5),0<c.length&&(x=o.add(b,T,[]),E=c[c.length-1].cp1,E=o.subtract([E.x,E.y,E.z],x,[]),o.normalize(E),o.scale(E,.5),o.add(x,E),E=new n.Residue(-1),E.cp1=E.cp2=new n.Atom("",x[0],x[1],x[2]),c.push(E),E=u(b[0],b[1],b[2]),c.push(E),s.push(c)),c=[],m<g&&(E=u(w[0],w[1],w[2]),c.push(E),b=e[m+1],b.sheet?(c.push(y),c.push(y),s.push(c),c=[],v.push(y)):(o.scale(T,-1),x=o.add(w,T,[]),y=b.cp1,y=o.subtract([y.x,y.y,y.z],x,[]),o.normalize(y),o.scale(y,.5),o.add(x,y),E=u(x[0],x[1],x[2]),c.push(E)))}}else if(y.sheet){if(v.push(y),y.arrow){w=[0,0,0],b=[0,0,0],x=0;for(T=v.length;x<T;x++)S=v[x].guidePointsLarge,E=S[0],S=S[S.length-1],o.add(w,[E.x,E.y,E.z]),o.add(b,[S.x,S.y,S.z]);o.scale(w,1/T),o.scale(b,1/T),b=o.subtract(w,b),w=v[v.length-1].guidePointsSmall[0],this.sheetPlanks.push(new f(v[0].guidePointsSmall[0],w,b)),v=[],m<g&&(b=e[m+1],b.sheet?v.push(y):(E=u(w.x,w.y,w.z),c.push(E)))}}else c.push(y),m<g&&(b=e[m+1],b.sheet&&(S=y.guidePointsSmall[0],E=u(S.x,S.y,S.z),c.push(E),s.push(c),c=[],v.push(y)))}1<c.length&&(2==c.length&&c.push(c[c.length-1]),s.push(c)),c=[],v=0;for(y=s.length;v<y;v++){w=s[v],b=[],m=0;for(g=w.length-1;m<=g;m++)b.push(w[m].cp1);c.push(b)}m=0;for(g=c.length;m<g;m++)s=new r.CatmullTube(c[m],t.proteins_tubeThickness,t.proteins_tubeResolution_3D,t.proteins_horizontalResolution),s.chainColor=e.chainColor,this.tubes.push(s)},t=r.PipePlank.prototype=new r._Mesh,t.render=function(e,t){e.material.setTempColors(t.proteins_materialAmbientColor_3D,void 0,t.proteins_materialSpecularColor_3D,t.proteins_materialShininess_3D),e.material.setDiffuseColor(t.macro_colorByChain?this.chainColor:t.proteins_tubeColor);for(var n=0,r=this.tubes.length;n<r;n++)e.setMatrixUniforms(e.modelViewMatrix),this.tubes[n].render(e,t);t.macro_colorByChain||e.material.setDiffuseColor(t.proteins_ribbonCartoonHelixSecondaryColor),e.cylinderClosedBuffer.bindBuffers(e),n=0;for(r=this.helixCylinders.length;n<r;n++)this.helixCylinders[n].render(e,t);t.macro_colorByChain||e.material.setDiffuseColor(t.proteins_ribbonCartoonSheetColor),e.boxBuffer.bindBuffers(e),n=0;for(r=this.sheetPlanks.length;n<r;n++)this.sheetPlanks[n].render(e,t)}}(ChemDoodle.extensions,ChemDoodle.RESIDUE,ChemDoodle.structures,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3,ChemDoodle.math),function(e,t){e.Shader=function(){};var n=e.Shader.prototype;n.init=function(e){var t=this.getShader(e,"vertex-shader");t||(t=this.loadDefaultVertexShader(e));var n=this.getShader(e,"fragment-shader");n||(n=this.loadDefaultFragmentShader(e)),e.attachShader(e.program,t),e.attachShader(e.program,n),this.vertexPositionAttribute=0,e.bindAttribLocation(e.program,this.vertexPositionAttribute,"a_vertex_position"),e.linkProgram(e.program),e.getProgramParameter(e.program,e.LINK_STATUS)||alert("Could not initialize shaders: "+e.getProgramInfoLog(e.program)),e.useProgram(e.program),e.enableVertexAttribArray(this.vertexPositionAttribute),this.vertexTexCoordAttribute=e.getAttribLocation(e.program,"a_vertex_texcoord"),this.vertexNormalAttribute=e.getAttribLocation(e.program,"a_vertex_normal"),e.enableVertexAttribArray(this.vertexNormalAttribute),this.dimensionUniform=e.getUniformLocation(e.program,"u_dimension")},n.getShader=function(e,n){var r=t.getElementById(n);if(r){for(var i=[],s=r.firstChild;s;)3===s.nodeType&&i.push(s.textContent),s=s.nextSibling;if("x-shader/x-fragment"===r.type)s=e.createShader(e.FRAGMENT_SHADER);else{if("x-shader/x-vertex"!==r.type)return;s=e.createShader(e.VERTEX_SHADER)}e.shaderSource(s,i.join("")),e.compileShader(s);if(e.getShaderParameter(s,e.COMPILE_STATUS))return s;alert(r.type+" "+e.getShaderInfoLog(s))}},n.loadDefaultVertexShader=function(e){var t=e.createShader(e.VERTEX_SHADER);e.shaderSource(t,"precision mediump float;attribute vec3 a_vertex_position;attribute vec3 a_vertex_normal;attribute vec2 a_vertex_texcoord;uniform vec3 u_light_diffuse_color;uniform vec3 u_material_ambient_color;uniform vec3 u_material_diffuse_color;uniform mat4 u_model_view_matrix;uniform mat4 u_projection_matrix;uniform mat3 u_normal_matrix;uniform vec2 u_dimension;varying vec2 v_texcoord;varying vec3 v_diffuse;varying vec4 v_ambient;varying vec3 v_normal;void main() {v_texcoord = a_vertex_texcoord;if(length(a_vertex_texcoord) != 0.) {gl_Position = u_model_view_matrix * vec4(a_vertex_position, 1.);vec4 depth_pos = vec4(gl_Position);depth_pos.z += a_vertex_normal.z;gl_Position = u_projection_matrix * gl_Position;depth_pos = u_projection_matrix * depth_pos;gl_Position /= gl_Position.w;gl_Position.xy += a_vertex_normal.xy / u_dimension * 2.;gl_Position.z = depth_pos.z / depth_pos.w;} else {v_normal = length(a_vertex_normal)==0. ? a_vertex_normal : normalize(u_normal_matrix * a_vertex_normal);v_ambient = vec4(u_material_ambient_color, 1.);v_diffuse = u_material_diffuse_color * u_light_diffuse_color;gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.);gl_Position /= gl_Position.w;}}"),e.compileShader(t);if(e.getShaderParameter(t,e.COMPILE_STATUS))return t;alert("Vertex shader failed to compile: "+e.getShaderInfoLog(t))},n.loadDefaultFragmentShader=function(e){var t=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(t,"precision mediump float;\nuniform vec3 u_light_specular_color;uniform vec3 u_light_direction;uniform vec3 u_light_half_vector;uniform vec3 u_material_specular_color;uniform float u_material_shininess;uniform float u_material_alpha;uniform int u_fog_mode;uniform vec3 u_fog_color;uniform float u_fog_density;uniform float u_fog_start;uniform float u_fog_end;uniform sampler2D u_image;varying vec2 v_texcoord;varying vec3 v_diffuse;varying vec4 v_ambient;varying vec3 v_normal;void main(void){if(length(v_texcoord)!=0.) {gl_FragColor = texture2D(u_image, v_texcoord);return;}if(length(v_normal)==0.){gl_FragColor = vec4(v_diffuse, u_material_alpha);}else{float nDotL = max(dot(v_normal, u_light_direction), 0.);vec4 color = vec4(v_diffuse*nDotL, 1.);float nDotHV = max(dot(v_normal, u_light_half_vector), 0.);vec3 specular = u_material_specular_color * u_light_specular_color;color+=vec4(specular * pow(nDotHV, u_material_shininess), 1.);gl_FragColor = color+v_ambient;gl_FragColor.a*=u_material_alpha;}float fogCoord = 1.-clamp((u_fog_end - gl_FragCoord.z/gl_FragCoord.w) / (u_fog_end - u_fog_start), 0., 1.);float fogFactor = 1.;if(u_fog_mode == 1){fogFactor = 1.-fogCoord;}else if(u_fog_mode == 2) {fogFactor = clamp(exp(-u_fog_density*fogCoord), 0., 1.);}else if(u_fog_mode == 3) {fogFactor = clamp(exp(-pow(u_fog_density*fogCoord, 2.)), 0., 1.);}gl_FragColor = mix(vec4(u_fog_color, 1.), gl_FragColor, fogFactor);}"),e.compileShader(t);if(e.getShaderParameter(t,e.COMPILE_STATUS))return t;alert("Fragment shader failed to compile: "+e.getShaderInfoLog(t))}}(ChemDoodle.structures.d3,document),function(e,t,n){t.Shape=function(t,r){for(var i=t.length,s=[],u=[],a=new e.Point,f=0,l=i;f<l;f++){var c=f+1;f===l-1&&(c=0);for(var h=t[f],c=t[c],p=n.cross([0,0,1],[c.x-h.x,c.y-h.y,0]),d=0;2>d;d++)s.push(h.x,h.y,r/2),s.push(h.x,h.y,-r/2),s.push(c.x,c.y,r/2),s.push(c.x,c.y,-r/2);for(d=0;4>d;d++)u.push(p[0],p[1],p[2]);u.push(0,0,1),u.push(0,0,-1),u.push(0,0,1),u.push(0,0,-1),a.add(h)}a.x/=i,a.y/=i,u.push(0,0,1),s.push(a.x,a.y,r/2),u.push(0,0,-1),s.push(a.x,a.y,-r/2),a=[],h=8*i,f=0;for(l=i;f<l;f++)i=8*f,a.push(i),a.push(i+3),a.push(i+1),a.push(i),a.push(i+2),a.push(i+3),a.push(i+4),a.push(h),a.push(i+6),a.push(i+5),a.push(i+7),a.push(h+1);this.storeData(s,u,a)},t.Shape.prototype=new t._Mesh}(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(e,t,n){e.Star=function(){for(var e=[.8944,.4472,0,.2764,.4472,.8506,.2764,.4472,-0.8506,-0.7236,.4472,.5257,-0.7236,.4472,-0.5257,-0.3416,.4472,0,-0.1056,.4472,.3249,-0.1056,.4472,-0.3249,.2764,.4472,.2008,.2764,.4472,-0.2008,-0.8944,-0.4472,0,-0.2764,-0.4472,.8506,-0.2764,-0.4472,-0.8506,.7236,-0.4472,.5257,.7236,-0.4472,-0.5257,.3416,-0.4472,0,.1056,-0.4472,.3249,.1056,-0.4472,-0.3249,-0.2764,-0.4472,.2008,-0.2764,-0.4472,-0.2008,-0.5527,.1058,0,-0.1708,.1058,.5527,-0.1708,.1058,-0.5527,.4471,.1058,.3249,.4471,.1058,-0.3249,.5527,-0.1058,0,.1708,-0.1058,.5527,.1708,-0.1058,-0.5527,-0.4471,-0.1058,.3249,-0.4471,-0.1058,-0.3249,0,1,0,0,-1,0],t=[0,9,8,2,7,9,4,5,7,3,6,5,1,8,6,0,8,23,30,6,8,3,21,6,11,26,21,13,23,26,2,9,24,30,8,9,1,23,8,13,25,23,14,24,25,4,7,22,30,9,7,0,24,9,14,27,24,12,22,27,3,5,20,30,7,5,2,22,7,12,29,22,10,20,29,1,6,21,30,5,6,4,20,5,10,28,20,11,21,28,10,19,18,12,17,19,14,15,17,13,16,15,11,18,16,31,19,17,14,17,27,2,27,22,4,22,29,10,29,19,31,18,19,12,19,29,4,29,20,3,20,28,11,28,18,31,16,18,10,18,28,3,28,21,1,21,26,13,26,16,31,15,16,11,16,26,1,26,23,0,23,25,14,25,15,31,17,15,13,15,25,0,25,24,2,24,27,12,27,17],r=[],i=[],s=[],u=0,a=t.length;u<a;u+=3){var f=3*t[u],l=3*t[u+1],c=3*t[u+2],f=[e[f],e[f+1],e[f+2]],l=[e[l],e[l+1],e[l+2]],c=[e[c],e[c+1],e[c+2]],h=n.cross([c[0]-l[0],c[1]-l[1],c[2]-l[2]],[f[0]-l[0],f[1]-l[1],f[2]-l[2]],[]);n.normalize(h),r.push(f[0],f[1],f[2],l[0],l[1],l[2],c[0],c[1],c[2]),i.push(h[0],h[1],h[2],h[0],h[1],h[2],h[0],h[1],h[2]),s.push(u,u+1,u+2)}this.storeData(r,i,s)},e.Star.prototype=new e._Mesh}(ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3),function(e,t,n,r){var i=1;r.devicePixelRatio&&(i=r.devicePixelRatio),e.TextImage=function(){this.ctx=n.createElement("canvas").getContext("2d"),this.data=[],this.text="",this.charHeight=0},e=e.TextImage.prototype,e.init=function(e){this.textureImage=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.textureImage),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.bindTexture(e.TEXTURE_2D,null),this.updateFont(e,12,["Sans-serif"],!1,!1,!1)},e.charData=function(e){return e=this.text.indexOf(e),0<=e?this.data[e]:null},e.updateFont=function(e,n,r,s,o,u){var a=this.ctx,f=this.ctx.canvas,l=[],c="";n*=i,o=t.getFontString(n,r,s,o),a.font=o,a.save();var p=0;n*=1.5,r=32;for(s=127;r<s;r++){var d=String.fromCharCode(r),v=a.measureText(d).width;l.push({text:d,width:v,height:n}),p+=2*v}var m=["°","Å","®"];r=0;for(s=m.length;r<s;r++)d=m[r],v=a.measureText(d).width,l.push({text:d,width:v,height:n}),p+=2*v;r=Math.sqrt(p*n),r=Math.ceil(r/n),p=Math.ceil(p/(r-1)),f.width=p,f.height=r*n,a.font=o,a.textAlign="left",a.textBaseline="middle",a.strokeStyle="#000",a.lineWidth=1.4,a.fillStyle="#fff",r=d=o=0;for(s=l.length;r<s;r++){v=l[r],m=2*v.width,n=v.height;var g=v.text;d+m>p&&(o++,d=0);var y=o*n;u&&a.strokeText(g,d,y+n/2),a.fillText(g,d,y+n/2),v.x=d,v.y=y,c+=g,d+=m}this.text=c,this.data=l,this.charHeight=n,e.bindTexture(e.TEXTURE_2D,this.textureImage),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,f),e.bindTexture(e.TEXTURE_2D,null)},e.pushVertexData=function(e,t,n,r){var s=e.toString().split(""),o=this.getHeight(),u=this.getWidth();e=-this.textWidth(e)/2/i;for(var a=-this.charHeight/2/i,f=0,l=s.length;f<l;f++){var c=this.charData(s[f]),p=c.width,d=c.x/u,v=d+1.8*c.width/u,m=c.y/o,c=m+c.height/o,g=e+1.8*p/i,y=this.charHeight/2/i;r.position.push(t[0],t[1],t[2],t[0],t[1],t[2],t[0],t[1],t[2],t[0],t[1],t[2],t[0],t[1],t[2],t[0],t[1],t[2]),r.texCoord.push(d,m,v,c,v,m,d,m,d,c,v,c),r.translation.push(e,y,n,g,a,n,g,y,n,e,y,n,e,a,n,g,a,n),e=g+(p-1.8*p)/i}},e.getCanvas=function(){return this.ctx.canvas},e.getHeight=function(){return this.getCanvas().height},e.getWidth=function(){return this.getCanvas().width},e.textWidth=function(e){return this.ctx.measureText(e).width},e.test=function(){n.body.appendChild(this.getCanvas())},e.useTexture=function(e){e.bindTexture(e.TEXTURE_2D,this.textureImage)}}(ChemDoodle.structures.d3,ChemDoodle.extensions,document,window),function(e){e.TextMesh=function(){},e=e.TextMesh.prototype,e.init=function(e){this.vertexPositionBuffer=e.createBuffer(),this.vertexTexCoordBuffer=e.createBuffer(),this.vertexTranslationBuffer=e.createBuffer()},e.setVertexData=function(e,t,n,r){e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW),t.itemSize=r,t.numItems=n.length/r},e.storeData=function(e,t,n,r){this.setVertexData(e,this.vertexPositionBuffer,t,3),this.setVertexData(e,this.vertexTexCoordBuffer,n,2),this.setVertexData(e,this.vertexTranslationBuffer,r,3)},e.bindBuffers=function(e){e.bindBuffer(e.ARRAY_BUFFER,this.vertexPositionBuffer),e.vertexAttribPointer(e.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexTexCoordBuffer),e.vertexAttribPointer(e.shader.vertexTexCoordAttribute,this.vertexTexCoordBuffer.itemSize,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexTranslationBuffer),e.vertexAttribPointer(e.shader.vertexNormalAttribute,this.vertexTranslationBuffer.itemSize,e.FLOAT,!1,0,0)},e.render=function(e){var t=this.vertexPositionBuffer.numItems;t&&(this.bindBuffers(e),e.drawArrays(e.TRIANGLES,0,t))}}(ChemDoodle.structures.d3,Math),function(e,t,n,r,i,s,o){r.Torsion=function(e,t,n,r){this.a1=e,this.a2=t,this.a3=n,this.a4=r},e=r.Torsion.prototype=new r._Measurement,e.calculateData=function(e){var t=[],n=[],r=[],s=this.a2.distance3D(this.a1),u=this.a2.distance3D(this.a3);this.distUse=i.min(s,u)/2;var u=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],s=[this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z],a=[this.a4.x-this.a3.x,this.a4.y-this.a3.y,this.a4.z-this.a3.z],f=o.cross(u,s,[]),a=o.cross(s,a,[]);o.scale(u,o.length(s)),this.torsion=i.atan2(o.dot(u,a),o.dot(f,a)),u=o.normalize(o.cross(f,s,[])),f=o.normalize(o.cross(s,u,[])),this.pos=o.add([this.a2.x,this.a2.y,this.a2.z],o.scale(o.normalize(s,[]),this.distUse));var a=[],l=e.measurement_angleBands_3D;for(e=0;e<=l;++e){var c=this.torsion*e/l,p=o.scale(u,i.cos(c),[]),c=o.scale(f,i.sin(c),[]),p=o.scale(o.normalize(o.add(p,c,[])),this.distUse);0==e&&(a=p),t.push(this.pos[0]+p[0],this.pos[1]+p[1],this.pos[2]+p[2]),n.push(0,0,0),e<l&&r.push(e,e+1)}this.vecText=o.normalize(o.add(a,p,[])),s=o.normalize(s,[]),o.scale(s,.0625),c=this.torsion-2*i.asin(.125)*this.torsion/i.abs(this.torsion),p=o.scale(u,i.cos(c),[]),c=o.scale(f,i.sin(c),[]),p=o.scale(o.normalize(o.add(p,c,[])),this.distUse),t.push(this.pos[0]+s[0]+p[0],this.pos[1]+s[1]+p[1],this.pos[2]+s[2]+p[2]),n.push(0,0,0),t.push(this.pos[0]-s[0]+p[0],this.pos[1]-s[1]+p[1],this.pos[2]-s[2]+p[2]),n.push(0,0,0),r.push(--e,e+1,e,e+2),this.storeData(t,n,r)},e.getText=function(){return o.add(this.pos,o.scale(this.vecText,this.distUse+.3,[])),{pos:this.pos,value:[t.angleBounds(this.torsion,!0,!0).toFixed(2)," °"].join("")}}}(ChemDoodle.ELEMENT,ChemDoodle.math,ChemDoodle.extensions,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(e,t,n,r,i,s,o,u){var a=function(e,t){e.bindBuffer(e.ARRAY_BUFFER,t.vertexPositionBuffer),e.vertexAttribPointer(e.shader.vertexPositionAttribute,t.vertexPositionBuffer.itemSize,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,t.vertexNormalBuffer),e.vertexAttribPointer(e.shader.vertexNormalAttribute,t.vertexNormalBuffer.itemSize,e.FLOAT,!1,0,0),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.vertexIndexBuffer)},f=function(e,t,n){var r=i.sqrt(t[1]*t[1]+t[2]*t[2]),o=[1,0,0,0,0,t[2]/r,-t[1]/r,0,0,t[1]/r,t[2]/r,0,0,0,0,1],u=[1,0,0,0,0,t[2]/r,t[1]/r,0,0,-t[1]/r,t[2]/r,0,0,0,0,1],a=[r,0,-t[0],0,0,1,0,0,t[0],0,r,0,0,0,0,1];t=[r,0,t[0],0,0,1,0,0,-t[0],0,r,0,0,0,0,1],n=[i.cos(n),-i.sin(n),0,0,i.sin(n),i.cos(n),0,0,0,0,1,0,0,0,0,1];var f=s.multiply(o,s.multiply(a,s.multiply(n,s.multiply(t,u,[]))));this.rotate=function(){return s.multiplyVec3(f,e)}};r.Tube=function(r,l,c){var p=r[0].lineSegments[0].length;this.partitions=[];var v;this.ends=[],this.ends.push(r[0].lineSegments[0][0]),this.ends.push(r[r.length-1].lineSegments[0][0]);for(var m=[1,0,0],y=0,w=r.length;y<w;y++){if(!v||65e3<v.positionData.length)0<this.partitions.length&&y--,v={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(v);var E=r[y];v.count++;for(var S=Infinity,x=new n.Atom("",r[y].cp1.x,r[y].cp1.y,r[y].cp1.z),T=0;T<p;T++){var N=E.lineSegments[0][T],C;C=T===p-1?y===r.length-1?E.lineSegments[0][T-1]:r[y+1].lineSegments[0][0]:E.lineSegments[0][T+1],C=[C.x-N.x,C.y-N.y,C.z-N.z],o.normalize(C),y===r.length-1&&T===p-1&&o.scale(C,-1);var k=o.cross(C,m,[]);o.normalize(k),o.scale(k,l/2),k=new f(k,C,2*Math.PI/c),C=0;for(var L=c;C<L;C++){var A=k.rotate();C===i.floor(c/4)&&(m=[A[0],A[1],A[2]]),v.normalData.push(A[0],A[1],A[2]),v.positionData.push(N.x+A[0],N.y+A[1],N.z+A[2])}x&&(C=N.distance3D(x),C<S&&(S=C,r[y].pPoint=N))}}m=0;for(E=this.partitions.length;m<E;m++){v=this.partitions[m],y=0;for(w=v.count-1;y<w;y++){S=y*p*c,T=0;for(x=p;T<x;T++){N=S+T*c;for(C=0;C<c;C++)k=N+C,v.indexData.push(k),v.indexData.push(k+c),v.indexData.push(k+c+1),v.indexData.push(k),v.indexData.push(k+c+1),v.indexData.push(k+1)}}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData),c=[new n.Point(2,0)];for(y=0;60>y;y++)p=y/60*i.PI,c.push(new n.Point(2*i.cos(p),-2*i.sin(p)));c.push(new n.Point(-2,0),new n.Point(-2,4),new n.Point(2,4));var O=new n.d3.Shape(c,1);this.render=function(f,c){this.bindBuffers(f),f.material.setDiffuseColor(c.macro_colorByChain?this.chainColor:c.nucleics_tubeColor),f.drawElements(f.TRIANGLES,this.vertexIndexBuffer.numItems,f.UNSIGNED_SHORT,0);if(this.partitions)for(var p=1,v=this.partitions.length;p<v;p++){var m=this.partitions[p];a(f,m),f.drawElements(f.TRIANGLES,m.vertexIndexBuffer.numItems,f.UNSIGNED_SHORT,0)}f.sphereBuffer.bindBuffers(f);for(p=0;2>p;p++)m=this.ends[p],m=s.translate(f.modelViewMatrix,[m.x,m.y,m.z],[]),v=l/2,s.scale(m,[v,v,v]),f.setMatrixUniforms(m),f.drawElements(f.TRIANGLES,f.sphereBuffer.vertexIndexBuffer.numItems,f.UNSIGNED_SHORT,0);f.cylinderBuffer.bindBuffers(f),p=0;for(v=r.length-1;p<v;p++){var y=r[p],w=y.pPoint,E=new n.Atom("",y.cp2.x,y.cp2.y,y.cp2.z),m=1.001*w.distance3D(E),y=[l/4,m,l/4],m=s.translate(f.modelViewMatrix,[w.x,w.y,w.z],[]),S=[0,1,0],x=0,T=[E.x-w.x,E.y-w.y,E.z-w.z];w.x===E.x&&w.z===E.z?(S=[0,0,1],w.y<w.y&&(x=i.PI)):(x=e.vec3AngleFrom(S,T),S=o.cross(S,T,[])),0!==x&&s.rotate(m,x,S),s.scale(m,y),f.setMatrixUniforms(m),f.drawArrays(f.TRIANGLE_STRIP,0,f.cylinderBuffer.vertexPositionBuffer.numItems)}O.bindBuffers(f),"none"===c.nucleics_residueColor&&!c.macro_colorByChain&&f.material.setDiffuseColor(c.nucleics_baseColor),p=0;for(v=r.length-1;p<v;p++)if(y=r[p],E=y.cp2,m=s.translate(f.modelViewMatrix,[E.x,E.y,E.z],[]),S=[0,1,0],x=0,w=y.cp3)T=[w.x-E.x,w.y-E.y,w.z-E.z],E.x===w.x&&E.z===w.z?(S=[0,0,1],E.y<E.y&&(x=i.PI)):(x=e.vec3AngleFrom(S,T),S=o.cross(S,T,[])),0!==x&&s.rotate(m,x,S),E=[1,0,0],x=s.rotate(s.identity([]),x,S),s.multiplyVec3(x,E),x=y.cp4,w=y.cp5,x.y===w.y&&x.z===w.z||(x=[w.x-x.x,w.y-x.y,w.z-x.z],w=e.vec3AngleFrom(E,x),0>o.dot(T,o.cross(E,x))&&(w*=-1),s.rotateY(m,w)),c.macro_colorByChain||("shapely"===c.nucleics_residueColor?t[y.name]?f.material.setDiffuseColor(t[y.name].shapelyColor):f.material.setDiffuseColor(t["*"].shapelyColor):"rainbow"===c.nucleics_residueColor&&f.material.setDiffuseColor(u.rainbowAt(p,v,c.macro_rainbowColors))),f.setMatrixUniforms(m),f.drawElements(f.TRIANGLES,O.vertexIndexBuffer.numItems,f.UNSIGNED_SHORT,0)}},r.Tube.prototype=new r._Mesh,r.CatmullTube=function(e,t,r,s){var u=[];e.push(e[e.length-1]);for(var a=0,l=e.length-2;a<=l;a++){for(var c=e[0==a?0:a-1],p=e[a+0],d=e[a+1],v=e[a==l?a+1:a+2],m=[],g=0;g<s;g++){var y=g/s;a==l&&(y=g/(s-1)),y=new n.Atom("C",.5*(2*p.x+(d.x-c.x)*y+(2*c.x-5*p.x+4*d.x-v.x)*y*y+(3*p.x-c.x-3*d.x+v.x)*y*y*y),.5*(2*p.y+(d.y-c.y)*y+(2*c.y-5*p.y+4*d.y-v.y)*y*y+(3*p.y-c.y-3*d.y+v.y)*y*y*y),.5*(2*p.z+(d.z-c.z)*y+(2*c.z-5*p.z+4*d.z-v.z)*y*y+(3*p.z-c.z-3*d.z+v.z)*y*y*y)),m.push(y)}u.push(m)}e=u[0].length,this.partitions=[];var b;this.ends=[],this.ends.push(u[0][0]),this.ends.push(u[u.length-1][0]),c=[1,0,0],a=0;for(l=u.length;a<l;a++){if(!b||65e3<b.positionData.length)0<this.partitions.length&&a--,b={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(b);p=u[a],b.count++;for(g=0;g<e;g++){d=p[g],s=g===e-1?a===u.length-1?p[g-1]:u[a+1][0]:p[g+1],s=[s.x-d.x,s.y-d.y,s.z-d.z],o.normalize(s),a===u.length-1&&g===e-1&&o.scale(s,-1),v=o.cross(s,c,[]),o.normalize(v),o.scale(v,t/2),v=new f(v,s,2*Math.PI/r),s=0;for(m=r;s<m;s++)y=v.rotate(),s===i.floor(r/4)&&(c=[y[0],y[1],y[2]]),b.normalData.push(y[0],y[1],y[2]),b.positionData.push(d.x+y[0],d.y+y[1],d.z+y[2])}}t=0;for(u=this.partitions.length;t<u;t++){b=this.partitions[t],a=0;for(l=b.count-1;a<l;a++){c=a*e*r,g=0;for(p=e;g<p;g++){d=c+g*r;for(s=0;s<=r;s++)v=d+s%r,b.indexData.push(v,v+r)}}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData)},(r.CatmullTube.prototype=new r._Mesh).render=function(e,t){this.bindBuffers(e);for(var n=0,r=this.partitions.length;n<r;n++){var i=this.partitions[n];a(e,i),e.drawElements(e.TRIANGLE_STRIP,i.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)}e.sphereBuffer.bindBuffers(e);for(n=0;2>n;n++)i=this.ends[n],r=s.translate(e.modelViewMatrix,[i.x,i.y,i.z],[]),i=t.proteins_tubeThickness/2,s.scale(r,[i,i,i]),e.setMatrixUniforms(r),e.drawElements(e.TRIANGLES,e.sphereBuffer.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)}}(ChemDoodle.extensions,ChemDoodle.RESIDUE,ChemDoodle.structures,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3,ChemDoodle.math),function(e){e.UnitCell=function(e){this.unitCell=e;var t=[],n=[],r=function(e,r,i,s){t.push(e[0],e[1],e[2]),t.push(r[0],r[1],r[2]),t.push(i[0],i[1],i[2]),t.push(s[0],s[1],s[2]);for(e=0;4>e;e++)n.push(0,0,0)};r(e.o,e.x,e.xy,e.y),r(e.o,e.y,e.yz,e.z),r(e.o,e.z,e.xz,e.x),r(e.yz,e.y,e.xy,e.xyz),r(e.xyz,e.xz,e.z,e.yz),r(e.xy,e.x,e.xz,e.xyz),e=[];for(r=0;6>r;r++){var i=4*r;e.push(i,i+1,i+1,i+2,i+2,i+3,i+3,i)}this.storeData(t,n,e)},(e.UnitCell.prototype=new e._Mesh).render=function(e,t){e.setMatrixUniforms(e.modelViewMatrix),this.bindBuffers(e),e.material.setDiffuseColor(t.shapes_color),e.lineWidth(t.shapes_lineWidth),e.drawElements(e.LINES,this.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)}}(ChemDoodle.structures.d3,ChemDoodle.lib.vec3),function(e,t,n){e.Plate=function(e){this.lanes=Array(e),i=0;for(ii=e;i<ii;i++)this.lanes[i]=[]};var r=e.Plate.prototype;r.sort=function(){i=0;for(ii=this.lanes.length;i<ii;i++)this.lanes[i].sort(function(e,t){return e-t})},r.draw=function(e){var r=e.canvas.width,u=e.canvas.height;this.origin=9*u/10,this.front=u/10,this.laneLength=this.origin-this.front,e.strokeStyle="#000000",e.beginPath(),e.moveTo(0,this.front),t.contextHashTo(e,0,this.front,r,this.front,3,3),e.closePath(),e.stroke(),e.beginPath(),e.moveTo(0,this.origin),e.lineTo(r,this.origin),e.closePath(),e.stroke(),i=0;for(ii=this.lanes.length;i<ii;i++){u=(i+1)*r/(ii+1),e.beginPath(),e.moveTo(u,this.origin),e.lineTo(u,this.origin+3),e.closePath(),e.stroke(),s=0;for(ss=this.lanes[i].length;s<ss;s++){var a=this.origin-this.laneLength*this.lanes[i][s].rf;switch(this.lanes[i][s].type){case"compact":e.beginPath(),e.arc(u,a,3,0,2*n.PI,!1),e.closePath();break;case"expanded":e.beginPath(),e.arc(u,a,7,0,2*n.PI,!1),e.closePath();break;case"widened":t.contextOval(e,u-18,a-10,36,10);break;case"cresent":e.beginPath(),e.arc(u,a,9,0,n.PI,!0),e.closePath()}switch(this.lanes[i][s].style){case"solid":e.fillStyle="#000000",e.fill();break;case"transparent":e.stroke()}}}},e.Plate.Spot=function(e,t,n){this.type=e,this.rf=t,this.style=n?n:"solid"}}(ChemDoodle.structures,ChemDoodle.extensions,Math),function(e,t,n){e.default_backgroundColor="#FFFFFF",e.default_scale=1,e.default_rotateAngle=0,e.default_bondLength_2D=20,e.default_angstromsPerBondLength=1.25,e.default_lightDirection_3D=[-0.1,-0.1,-1],e.default_lightDiffuseColor_3D="#FFFFFF",e.default_lightSpecularColor_3D="#FFFFFF",e.default_projectionPerspective_3D=!0,e.default_projectionPerspectiveVerticalFieldOfView_3D=45,e.default_projectionOrthoWidth_3D=40,e.default_projectionWidthHeightRatio_3D=void 0,e.default_projectionFrontCulling_3D=.1,e.default_projectionBackCulling_3D=1e4,e.default_cullBackFace_3D=!0,e.default_fog_mode_3D=0,e.default_fog_color_3D="#000000",e.default_fog_start_3D=0,e.default_fog_end_3D=1,e.default_fog_density_3D=1,e.default_atoms_display=!0,e.default_atoms_color="#000000",e.default_atoms_font_size_2D=12,e.default_atoms_font_families_2D=["Helvetica","Arial","Dialog"],e.default_atoms_font_bold_2D=!1,e.default_atoms_font_italic_2D=!1,e.default_atoms_circles_2D=!1,e.default_atoms_circleDiameter_2D=10,e.default_atoms_circleBorderWidth_2D=1,e.default_atoms_lonePairDistance_2D=8,e.default_atoms_lonePairSpread_2D=4,e.default_atoms_lonePairDiameter_2D=1,e.default_atoms_useJMOLColors=!1,e.default_atoms_usePYMOLColors=!1,e.default_atoms_resolution_3D=60,e.default_atoms_sphereDiameter_3D=.8,e.default_atoms_useVDWDiameters_3D=!1,e.default_atoms_vdwMultiplier_3D=1,e.default_atoms_materialAmbientColor_3D="#000000",e.default_atoms_materialSpecularColor_3D="#555555",e.default_atoms_materialShininess_3D=32,e.default_atoms_implicitHydrogens_2D=!0,e.default_atoms_displayTerminalCarbonLabels_2D=!1,e.default_atoms_showHiddenCarbons_2D=!0,e.default_atoms_showAttributedCarbons_2D=!0,e.default_atoms_displayAllCarbonLabels_2D=!1,e.default_atoms_nonBondedAsStars_3D=!1,e.default_atoms_displayLabels_3D=!1,e.default_atoms_HBlack_2D=!0,e.default_bonds_display=!0,e.default_bonds_color="#000000",e.default_bonds_width_2D=1,e.default_bonds_saturationWidth_2D=.2,e.default_bonds_ends_2D="round",e.default_bonds_useJMOLColors=!1,e.default_bonds_usePYMOLColors=!1,e.default_bonds_colorGradient=!1,e.default_bonds_saturationAngle_2D=n.PI/3,e.default_bonds_symmetrical_2D=!1,e.default_bonds_clearOverlaps_2D=!1,e.default_bonds_overlapClearWidth_2D=.5,e.default_bonds_atomLabelBuffer_2D=1,e.default_bonds_wedgeThickness_2D=.22,e.default_bonds_hashWidth_2D=1,e.default_bonds_hashSpacing_2D=2.5,e.default_bonds_dotSize_2D=2,e.default_bonds_lewisStyle_2D=!1,e.default_bonds_showBondOrders_3D=!1,e.default_bonds_resolution_3D=60,e.default_bonds_renderAsLines_3D=!1,e.default_bonds_cylinderDiameter_3D=.3,e.default_bonds_pillLatitudeResolution_3D=10,e.default_bonds_pillLongitudeResolution_3D=20,e.default_bonds_pillHeight_3D=.3,e.default_bonds_pillSpacing_3D=.1,e.default_bonds_pillDiameter_3D=.3,e.default_bonds_materialAmbientColor_3D="#222222",e.default_bonds_materialSpecularColor_3D="#555555",e.default_bonds_materialShininess_3D=32,e.default_proteins_displayRibbon=!0,e.default_proteins_displayBackbone=!1,e.default_proteins_backboneThickness=1.5,e.default_proteins_backboneColor="#CCCCCC",e.default_proteins_ribbonCartoonize=!1,e.default_proteins_displayPipePlank=!1,e.default_proteins_residueColor="none",e.default_proteins_primaryColor="#FF0D0D",e.default_proteins_secondaryColor="#FFFF30",e.default_proteins_ribbonCartoonHelixPrimaryColor="#00E740",e.default_proteins_ribbonCartoonHelixSecondaryColor="#9905FF",e.default_proteins_ribbonCartoonSheetColor="#E8BB99",e.default_proteins_tubeColor="#FF0D0D",e.default_proteins_tubeResolution_3D=30,e.default_proteins_ribbonThickness=.2,e.default_proteins_tubeThickness=.5,e.default_proteins_plankSheetWidth=3.5,e.default_proteins_cylinderHelixDiameter=4,e.default_proteins_verticalResolution=10,e.default_proteins_horizontalResolution=9,e.default_proteins_materialAmbientColor_3D="#222222",e.default_proteins_materialSpecularColor_3D="#555555",e.default_proteins_materialShininess_3D=32,e.default_nucleics_display=!0,e.default_nucleics_tubeColor="#CCCCCC",e.default_nucleics_baseColor="#C10000",e.default_nucleics_residueColor="none",e.default_nucleics_tubeThickness=1.5,e.default_nucleics_tubeResolution_3D=60,e.default_nucleics_verticalResolution=10,e.default_nucleics_materialAmbientColor_3D="#222222",e.default_nucleics_materialSpecularColor_3D="#555555",e.default_nucleics_materialShininess_3D=32,e.default_macro_displayAtoms=!1,e.default_macro_displayBonds=!1,e.default_macro_atomToLigandDistance=-1,e.default_macro_showWater=!1,e.default_macro_colorByChain=!1,e.default_macro_rainbowColors=["#0000FF","#00FFFF","#00FF00","#FFFF00","#FF0000"],e.default_surfaces_display=!0,e.default_surfaces_style="Dot",e.default_surfaces_color="#E9B862",e.default_surfaces_materialAmbientColor_3D="#000000",e.default_surfaces_materialSpecularColor_3D="#000000",e.default_surfaces_materialShininess_3D=32,e.default_plots_color="#000000",e.default_plots_width=1,e.default_plots_showIntegration=!1,e.default_plots_integrationColor="#c10000",e.default_plots_integrationLineWidth=1,e.default_plots_showGrid=!1,e.default_plots_gridColor="gray",e.default_plots_gridLineWidth=.5,e.default_plots_showYAxis=!0,e.default_plots_flipXAxis=!1,e.default_text_font_size=12,e.default_text_font_families=["Helvetica","Arial","Dialog"],e.default_text_font_bold=!0,e.default_text_font_italic=!1,e.default_text_font_stroke_3D=!0,e.default_text_color="#000000",e.default_shapes_color="#000000",e.default_shapes_lineWidth=1,e.default_shapes_arrowLength_2D=8,e.default_compass_display=!1,e.default_compass_axisXColor_3D="#FF0000",e.default_compass_axisYColor_3D="#00FF00",e.default_compass_axisZColor_3D="#0000FF",e.default_compass_size_3D=50,e.default_compass_resolution_3D=10,e.default_compass_displayText_3D=!0,e.default_compass_type_3D=0,e.default_measurement_update_3D=!1,e.default_measurement_angleBands_3D=10,e.default_measurement_displayText_3D=!0,t.VisualSpecifications=function(){this.backgroundColor=e.default_backgroundColor,this.scale=e.default_scale,this.rotateAngle=e.default_rotateAngle,this.bondLength_2D=e.default_bondLength_2D,this.angstromsPerBondLength=e.default_angstromsPerBondLength,this.lightDirection_3D=e.default_lightDirection_3D.slice(0),this.lightDiffuseColor_3D=e.default_lightDiffuseColor_3D,this.lightSpecularColor_3D=e.default_lightSpecularColor_3D,this.projectionPerspective_3D=e.default_projectionPerspective_3D,this.projectionPerspectiveVerticalFieldOfView_3D=e.default_projectionPerspectiveVerticalFieldOfView_3D,this.projectionOrthoWidth_3D=e.default_projectionOrthoWidth_3D,this.projectionWidthHeightRatio_3D=e.default_projectionWidthHeightRatio_3D,this.projectionFrontCulling_3D=e.default_projectionFrontCulling_3D,this.projectionBackCulling_3D=e.default_projectionBackCulling_3D,this.cullBackFace_3D=e.default_cullBackFace_3D,this.fog_mode_3D=e.default_fog_mode_3D,this.fog_color_3D=e.default_fog_color_3D,this.fog_start_3D=e.default_fog_start_3D,this.fog_end_3D=e.default_fog_end_3D,this.fog_density_3D=e.default_fog_density_3D,this.atoms_display=e.default_atoms_display,this.atoms_color=e.default_atoms_color,this.atoms_font_size_2D=e.default_atoms_font_size_2D,this.atoms_font_families_2D=e.default_atoms_font_families_2D.slice(0),this.atoms_font_bold_2D=e.default_atoms_font_bold_2D,this.atoms_font_italic_2D=e.default_atoms_font_italic_2D,this.atoms_circles_2D=e.default_atoms_circles_2D,this.atoms_circleDiameter_2D=e.default_atoms_circleDiameter_2D,this.atoms_circleBorderWidth_2D=e.default_atoms_circleBorderWidth_2D,this.atoms_lonePairDistance_2D=e.default_atoms_lonePairDistance_2D
,this.atoms_lonePairSpread_2D=e.default_atoms_lonePairSpread_2D,this.atoms_lonePairDiameter_2D=e.default_atoms_lonePairDiameter_2D,this.atoms_useJMOLColors=e.default_atoms_useJMOLColors,this.atoms_usePYMOLColors=e.default_atoms_usePYMOLColors,this.atoms_resolution_3D=e.default_atoms_resolution_3D,this.atoms_sphereDiameter_3D=e.default_atoms_sphereDiameter_3D,this.atoms_useVDWDiameters_3D=e.default_atoms_useVDWDiameters_3D,this.atoms_vdwMultiplier_3D=e.default_atoms_vdwMultiplier_3D,this.atoms_materialAmbientColor_3D=e.default_atoms_materialAmbientColor_3D,this.atoms_materialSpecularColor_3D=e.default_atoms_materialSpecularColor_3D,this.atoms_materialShininess_3D=e.default_atoms_materialShininess_3D,this.atoms_implicitHydrogens_2D=e.default_atoms_implicitHydrogens_2D,this.atoms_displayTerminalCarbonLabels_2D=e.default_atoms_displayTerminalCarbonLabels_2D,this.atoms_showHiddenCarbons_2D=e.default_atoms_showHiddenCarbons_2D,this.atoms_showAttributedCarbons_2D=e.default_atoms_showAttributedCarbons_2D,this.atoms_displayAllCarbonLabels_2D=e.default_atoms_displayAllCarbonLabels_2D,this.atoms_nonBondedAsStars_3D=e.default_atoms_nonBondedAsStars_3D,this.atoms_displayLabels_3D=e.default_atoms_displayLabels_3D,this.atoms_HBlack_2D=e.default_atoms_HBlack_2D,this.bonds_display=e.default_bonds_display,this.bonds_color=e.default_bonds_color,this.bonds_width_2D=e.default_bonds_width_2D,this.bonds_saturationWidth_2D=e.default_bonds_saturationWidth_2D,this.bonds_ends_2D=e.default_bonds_ends_2D,this.bonds_useJMOLColors=e.default_bonds_useJMOLColors,this.bonds_usePYMOLColors=e.default_bonds_usePYMOLColors,this.bonds_colorGradient=e.default_bonds_colorGradient,this.bonds_saturationAngle_2D=e.default_bonds_saturationAngle_2D,this.bonds_symmetrical_2D=e.default_bonds_symmetrical_2D,this.bonds_clearOverlaps_2D=e.default_bonds_clearOverlaps_2D,this.bonds_overlapClearWidth_2D=e.default_bonds_overlapClearWidth_2D,this.bonds_atomLabelBuffer_2D=e.default_bonds_atomLabelBuffer_2D,this.bonds_wedgeThickness_2D=e.default_bonds_wedgeThickness_2D,this.bonds_hashWidth_2D=e.default_bonds_hashWidth_2D,this.bonds_hashSpacing_2D=e.default_bonds_hashSpacing_2D,this.bonds_dotSize_2D=e.default_bonds_dotSize_2D,this.bonds_lewisStyle_2D=e.default_bonds_lewisStyle_2D,this.bonds_showBondOrders_3D=e.default_bonds_showBondOrders_3D,this.bonds_resolution_3D=e.default_bonds_resolution_3D,this.bonds_renderAsLines_3D=e.default_bonds_renderAsLines_3D,this.bonds_cylinderDiameter_3D=e.default_bonds_cylinderDiameter_3D,this.bonds_pillHeight_3D=e.default_bonds_pillHeight_3D,this.bonds_pillLatitudeResolution_3D=e.default_bonds_pillLatitudeResolution_3D,this.bonds_pillLongitudeResolution_3D=e.default_bonds_pillLongitudeResolution_3D,this.bonds_pillSpacing_3D=e.default_bonds_pillSpacing_3D,this.bonds_pillDiameter_3D=e.default_bonds_pillDiameter_3D,this.bonds_materialAmbientColor_3D=e.default_bonds_materialAmbientColor_3D,this.bonds_materialSpecularColor_3D=e.default_bonds_materialSpecularColor_3D,this.bonds_materialShininess_3D=e.default_bonds_materialShininess_3D,this.proteins_displayRibbon=e.default_proteins_displayRibbon,this.proteins_displayBackbone=e.default_proteins_displayBackbone,this.proteins_backboneThickness=e.default_proteins_backboneThickness,this.proteins_backboneColor=e.default_proteins_backboneColor,this.proteins_ribbonCartoonize=e.default_proteins_ribbonCartoonize,this.proteins_residueColor=e.default_proteins_residueColor,this.proteins_primaryColor=e.default_proteins_primaryColor,this.proteins_secondaryColor=e.default_proteins_secondaryColor,this.proteins_ribbonCartoonHelixPrimaryColor=e.default_proteins_ribbonCartoonHelixPrimaryColor,this.proteins_ribbonCartoonHelixSecondaryColor=e.default_proteins_ribbonCartoonHelixSecondaryColor,this.proteins_tubeColor=e.default_proteins_tubeColor,this.proteins_tubeResolution_3D=e.default_proteins_tubeResolution_3D,this.proteins_displayPipePlank=e.default_proteins_displayPipePlank,this.proteins_ribbonCartoonSheetColor=e.default_proteins_ribbonCartoonSheetColor,this.proteins_ribbonThickness=e.default_proteins_ribbonThickness,this.proteins_tubeThickness=e.default_proteins_tubeThickness,this.proteins_plankSheetWidth=e.default_proteins_plankSheetWidth,this.proteins_cylinderHelixDiameter=e.default_proteins_cylinderHelixDiameter,this.proteins_verticalResolution=e.default_proteins_verticalResolution,this.proteins_horizontalResolution=e.default_proteins_horizontalResolution,this.proteins_materialAmbientColor_3D=e.default_proteins_materialAmbientColor_3D,this.proteins_materialSpecularColor_3D=e.default_proteins_materialSpecularColor_3D,this.proteins_materialShininess_3D=e.default_proteins_materialShininess_3D,this.macro_displayAtoms=e.default_macro_displayAtoms,this.macro_displayBonds=e.default_macro_displayBonds,this.macro_atomToLigandDistance=e.default_macro_atomToLigandDistance,this.nucleics_display=e.default_nucleics_display,this.nucleics_tubeColor=e.default_nucleics_tubeColor,this.nucleics_baseColor=e.default_nucleics_baseColor,this.nucleics_residueColor=e.default_nucleics_residueColor,this.nucleics_tubeThickness=e.default_nucleics_tubeThickness,this.nucleics_tubeResolution_3D=e.default_nucleics_tubeResolution_3D,this.nucleics_verticalResolution=e.default_nucleics_verticalResolution,this.nucleics_materialAmbientColor_3D=e.default_nucleics_materialAmbientColor_3D,this.nucleics_materialSpecularColor_3D=e.default_nucleics_materialSpecularColor_3D,this.nucleics_materialShininess_3D=e.default_nucleics_materialShininess_3D,this.macro_showWater=e.default_macro_showWater,this.macro_colorByChain=e.default_macro_colorByChain,this.macro_rainbowColors=e.default_macro_rainbowColors.slice(0),this.surfaces_display=e.default_surfaces_display,this.surfaces_style=e.default_surfaces_style,this.surfaces_color=e.default_surfaces_color,this.surfaces_materialAmbientColor_3D=e.default_surfaces_materialAmbientColor_3D,this.surfaces_materialSpecularColor_3D=e.default_surfaces_materialSpecularColor_3D,this.surfaces_materialShininess_3D=e.default_surfaces_materialShininess_3D,this.plots_color=e.default_plots_color,this.plots_width=e.default_plots_width,this.plots_showIntegration=e.default_plots_showIntegration,this.plots_integrationColor=e.default_plots_integrationColor,this.plots_integrationLineWidth=e.default_plots_integrationLineWidth,this.plots_showGrid=e.default_plots_showGrid,this.plots_gridColor=e.default_plots_gridColor,this.plots_gridLineWidth=e.default_plots_gridLineWidth,this.plots_showYAxis=e.default_plots_showYAxis,this.plots_flipXAxis=e.default_plots_flipXAxis,this.text_font_size=e.default_text_font_size,this.text_font_families=e.default_text_font_families.slice(0),this.text_font_bold=e.default_text_font_bold,this.text_font_italic=e.default_text_font_italic,this.text_font_stroke_3D=e.default_text_font_stroke_3D,this.text_color=e.default_text_color,this.shapes_color=e.default_shapes_color,this.shapes_lineWidth=e.default_shapes_lineWidth,this.shapes_arrowLength_2D=e.default_shapes_arrowLength_2D,this.compass_display=e.default_compass_display,this.compass_axisXColor_3D=e.default_compass_axisXColor_3D,this.compass_axisYColor_3D=e.default_compass_axisYColor_3D,this.compass_axisZColor_3D=e.default_compass_axisZColor_3D,this.compass_size_3D=e.default_compass_size_3D,this.compass_resolution_3D=e.default_compass_resolution_3D,this.compass_displayText_3D=e.default_compass_displayText_3D,this.compass_type_3D=e.default_compass_type_3D,this.measurement_update_3D=e.default_measurement_update_3D,this.measurement_angleBands_3D=e.default_measurement_angleBands_3D,this.measurement_displayText_3D=e.default_measurement_displayText_3D},t.VisualSpecifications.prototype.set3DRepresentation=function(t){this.bonds_display=this.atoms_display=!0,this.bonds_color="#777777",this.bonds_showBondOrders_3D=this.bonds_useJMOLColors=this.atoms_useJMOLColors=this.atoms_useVDWDiameters_3D=!0,this.bonds_renderAsLines_3D=!1,"Ball and Stick"===t?(this.atoms_vdwMultiplier_3D=.3,this.bonds_useJMOLColors=!1,this.bonds_cylinderDiameter_3D=.3,this.bonds_materialAmbientColor_3D=e.default_atoms_materialAmbientColor_3D,this.bonds_pillDiameter_3D=.15):"van der Waals Spheres"===t?(this.bonds_display=!1,this.atoms_vdwMultiplier_3D=1):"Stick"===t?(this.bonds_showBondOrders_3D=this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=.8,this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D):"Wireframe"===t?(this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.bonds_pillDiameter_3D=.05,this.atoms_sphereDiameter_3D=.15,this.bonds_materialAmbientColor_3D=e.default_atoms_materialAmbientColor_3D):"Line"===t?(this.atoms_display=!1,this.bonds_renderAsLines_3D=!0,this.bonds_width_2D=1,this.bonds_cylinderDiameter_3D=.05):alert('"'+t+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n5. Line\n')}}(ChemDoodle,ChemDoodle.structures,Math),function(e,t,n,r){n.getPointsPerAngstrom=function(){return e.default_bondLength_2D/e.default_angstromsPerBondLength},n.BondDeducer=function(){};var i=n.BondDeducer.prototype;i.margin=1.1,i.deduceCovalentBonds=function(e,i){var s=n.getPointsPerAngstrom();i&&(s=i);for(var u=0,a=e.atoms.length;u<a;u++)for(var f=u+1;f<a;f++){var c=e.atoms[u],h=e.atoms[f];c.distance3D(h)<(t[c.label].covalentRadius+t[h.label].covalentRadius)*s*this.margin&&e.bonds.push(new r.Bond(c,h,1))}}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.informatics,ChemDoodle.structures),function(e,t){e.HydrogenDeducer=function(){},e.HydrogenDeducer.prototype.removeHydrogens=function(e,n){for(var r=[],i=[],s=0,o=e.bonds.length;s<o;s++){var u=e.bonds[s],a="H"!==u.a1.label&&"H"!==u.a2.label;!a&&!n&&u.stereo!==t.Bond.STEREO_NONE&&(a=!0),a?(u.a1.tag=!0,i.push(u)):("H"===u.a1.label&&(u.a1.remove=!0),"H"===u.a2.label&&(u.a2.remove=!0))}s=0;for(o=e.atoms.length;s<o;s++)u=e.atoms[s],u.remove?u.remove=void 0:r.push(u);e.atoms=r,e.bonds=i}}(ChemDoodle.informatics,ChemDoodle.structures),function(e,t,n){t.MolecularSurfaceGenerator=function(){},t.MolecularSurfaceGenerator.prototype.generateSurface=function(e,t,r,i,s){return new n.MolecularSurface(e,t,r,i,s)}}(ChemDoodle,ChemDoodle.informatics,ChemDoodle.structures.d3),function(e,t){e.Splitter=function(){},e.Splitter.prototype.split=function(e){for(var n=[],r=0,i=e.atoms.length;r<i;r++)e.atoms[r].visited=!1;r=0;for(i=e.bonds.length;r<i;r++)e.bonds[r].visited=!1;r=0;for(i=e.atoms.length;r<i;r++){var s=e.atoms[r];if(!s.visited){var o=new t.Molecule;o.atoms.push(s),s.visited=!0;var u=new t.Queue;for(u.enqueue(s);!u.isEmpty();)for(var s=u.dequeue(),a=0,f=e.bonds.length;a<f;a++){var l=e.bonds[a];l.contains(s)&&!l.visited&&(l.visited=!0,o.bonds.push(l),l=l.getNeighbor(s),l.visited||(l.visited=!0,o.atoms.push(l),u.enqueue(l)))}n.push(o)}}return n}}(ChemDoodle.informatics,ChemDoodle.structures),function(e,t){e.StructureBuilder=function(){},e.StructureBuilder.prototype.copy=function(e){var n=new t.JSONInterpreter;return n.molFrom(n.molTo(e))}}(ChemDoodle.informatics,ChemDoodle.io,ChemDoodle.structures),function(e){e._Counter=function(){},e=e._Counter.prototype,e.value=0,e.molecule=void 0,e.setMolecule=function(e){this.value=0,this.molecule=e,this.innerCalculate&&this.innerCalculate()}}(ChemDoodle.informatics),function(e){e.FrerejacqueNumberCounter=function(e){this.setMolecule(e)},(e.FrerejacqueNumberCounter.prototype=new e._Counter).innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+(new e.NumberOfMoleculesCounter(this.molecule)).value}}(ChemDoodle.informatics),function(e,t){t.NumberOfMoleculesCounter=function(e){this.setMolecule(e)},(t.NumberOfMoleculesCounter.prototype=new t._Counter).innerCalculate=function(){for(var t=0,n=this.molecule.atoms.length;t<n;t++)this.molecule.atoms[t].visited=!1;t=0;for(n=this.molecule.atoms.length;t<n;t++)if(!this.molecule.atoms[t].visited){this.value++;var r=new e.Queue;this.molecule.atoms[t].visited=!0;for(r.enqueue(this.molecule.atoms[t]);!r.isEmpty();)for(var i=r.dequeue(),s=0,o=this.molecule.bonds.length;s<o;s++){var u=this.molecule.bonds[s];u.contains(i)&&(u=u.getNeighbor(i),u.visited||(u.visited=!0,r.enqueue(u)))}}}}(ChemDoodle.structures,ChemDoodle.informatics),function(e){e._RingFinder=function(){},e=e._RingFinder.prototype,e.atoms=void 0,e.bonds=void 0,e.rings=void 0,e.reduce=function(e){for(var t=0,n=e.atoms.length;t<n;t++)e.atoms[t].visited=!1;t=0;for(n=e.bonds.length;t<n;t++)e.bonds[t].visited=!1;for(var r=!0;r;){r=!1,t=0;for(n=e.atoms.length;t<n;t++){for(var i=0,s,o=0,u=e.bonds.length;o<u;o++)if(e.bonds[o].contains(e.atoms[t])&&!e.bonds[o].visited){i++;if(2===i)break;s=e.bonds[o]}1===i&&(r=!0,s.visited=!0,e.atoms[t].visited=!0)}}t=0;for(n=e.atoms.length;t<n;t++)e.atoms[t].visited||this.atoms.push(e.atoms[t]);t=0;for(n=e.bonds.length;t<n;t++)e.bonds[t].visited||this.bonds.push(e.bonds[t]);0===this.bonds.length&&0!==this.atoms.length&&(this.atoms=[])},e.setMolecule=function(e){this.atoms=[],this.bonds=[],this.rings=[],this.reduce(e),2<this.atoms.length&&this.innerGetRings&&this.innerGetRings()},e.fuse=function(){for(var e=0,t=this.rings.length;e<t;e++)for(var n=0,r=this.bonds.length;n<r;n++)-1!==this.rings[e].atoms.indexOf(this.bonds[n].a1)&&-1!==this.rings[e].atoms.indexOf(this.bonds[n].a2)&&this.rings[e].bonds.push(this.bonds[n])}}(ChemDoodle.informatics),function(e,t){function n(e,t){this.atoms=[];if(t)for(var n=0,r=t.atoms.length;n<r;n++)this.atoms[n]=t.atoms[n];this.atoms.push(e)}var r=n.prototype;r.grow=function(e,t){for(var r=this.atoms[this.atoms.length-1],i=[],s=0,u=e.length;s<u;s++)if(e[s].contains(r)){var a=e[s].getNeighbor(r);-1===t.indexOf(a)&&i.push(a)}r=[],s=0;for(u=i.length;s<u;s++)r.push(new n(i[s],this));return r},r.check=function(e,n,r){for(var i=0,s=n.atoms.length-1;i<s;i++)if(-1!==this.atoms.indexOf(n.atoms[i]))return;var o;if(n.atoms[n.atoms.length-1]===this.atoms[this.atoms.length-1]){o=new t.Ring,o.atoms[0]=r,i=0;for(s=this.atoms.length;i<s;i++)o.atoms.push(this.atoms[i]);for(i=n.atoms.length-2;0<=i;i--)o.atoms.push(n.atoms[i])}else{for(var u=[],i=0,s=e.length;i<s;i++)e[i].contains(n.atoms[n.atoms.length-1])&&u.push(e[i]);i=0;for(s=u.length;i<s;i++)if((1===n.atoms.length||!u[i].contains(n.atoms[n.atoms.length-2]))&&u[i].contains(this.atoms[this.atoms.length-1])){o=new t.Ring,o.atoms[0]=r,e=0;for(r=this.atoms.length;e<r;e++)o.atoms.push(this.atoms[e]);for(e=n.atoms.length-1;0<=e;e--)o.atoms.push(n.atoms[e]);break}}return o},e.EulerFacetRingFinder=function(e){this.setMolecule(e)},r=e.EulerFacetRingFinder.prototype=new e._RingFinder,r.fingerBreak=5,r.innerGetRings=function(){for(var e=0,t=this.atoms.length;e<t;e++){for(var r=[],i=0,s=this.bonds.length;i<s;i++)this.bonds[i].contains(this.atoms[e])&&r.push(this.bonds[i].getNeighbor(this.atoms[e]));i=0;for(s=r.length;i<s;i++)for(var u=i+1;u<r.length;u++){var a=[];a[0]=new n(r[i]),a[1]=new n(r[u]);var f=[];f[0]=this.atoms[e];for(var l=0,c=r.length;l<c;l++)l!==i&&l!==u&&f.push(r[l]);var h=[];for((l=a[0].check(this.bonds,a[1],this.atoms[e]))&&(h[0]=l);0===h.length&&0<a.length&&a[0].atoms.length<this.fingerBreak;){for(var p=[],l=0,c=a.length;l<c;l++)for(var d=a[l].grow(this.bonds,f),v=0,m=d.length;v<m;v++)p.push(d[v]);a=p,l=0;for(c=a.length;l<c;l++)for(v=l+1;v<c;v++)(m=a[l].check(this.bonds,a[v],this.atoms[e]))&&h.push(m);if(0===h.length){p=[],l=0;for(c=f.length;l<c;l++){v=0;for(m=this.bonds.length;v<m;v++)this.bonds[v].contains(f[l])&&(r=this.bonds[v].getNeighbor(f[l]),-1===f.indexOf(r)&&-1===p.indexOf(r)&&p.push(r))}l=0;for(c=p.length;l<c;l++)f.push(p[l])}}if(0<h.length){a=void 0,l=0;for(c=h.length;l<c;l++)if(!a||a.atoms.length>h[l].atoms.length)a=h[l];h=!1,l=0;for(c=this.rings.length;l<c;l++){f=!0,v=0;for(m=a.atoms.length;v<m;v++)if(-1===this.rings[l].atoms.indexOf(a.atoms[v])){f=!1;break}if(f){h=!0;break}}h||this.rings.push(a)}}}this.fuse()}}(ChemDoodle.informatics,ChemDoodle.structures),function(e){e.SSSRFinder=function(t){this.rings=[];if(0<t.atoms.length){var n=(new e.FrerejacqueNumberCounter(t)).value,r=(new e.EulerFacetRingFinder(t)).rings;r.sort(function(e,t){return e.atoms.length-t.atoms.length});for(var i=0,s=t.bonds.length;i<s;i++)t.bonds[i].visited=!1;i=0;for(s=r.length;i<s;i++){t=!1;for(var o=0,u=r[i].bonds.length;o<u;o++)if(!r[i].bonds[o].visited){t=!0;break}if(t){o=0;for(u=r[i].bonds.length;o<u;o++)r[i].bonds[o].visited=!0;this.rings.push(r[i])}if(this.rings.length===n)break}}}}(ChemDoodle.informatics),function(e){e._Interpreter=function(){},e._Interpreter.prototype.fit=function(e,t,n){for(var r=e.length,i=[],s=0;s<t-r;s++)i.push(" ");return n?e+i.join(""):i.join("")+e}}(ChemDoodle.io),function(e,t,n,r,i,s,o){var u=/\s+/g,a=/\(|\)|\s+/g,f=/\'|\s+/g,l=/,|\'|\s+/g,c=/^\s+/,h=/[0-9]/g,p=/[0-9]|\+|\-/g,d=function(e){return 0!==e.length},v={P:[],A:[[0,.5,.5]],B:[[.5,0,.5]],C:[[.5,.5,0]],I:[[.5,.5,.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,.5,.5],[.5,0,.5],[.5,.5,0]]},m=function(e){var t=0,n=0,r=0,i=0,s=e.indexOf("x"),o=e.indexOf("y"),u=e.indexOf("z");-1!==s&&(n++,0<s&&"+"!==e.charAt(s-1)&&(n*=-1)),-1!==o&&(r++,0<o&&"+"!==e.charAt(o-1)&&(r*=-1)),-1!==u&&(i++,0<u&&"+"!==e.charAt(u-1)&&(i*=-1));if(2<e.length){s="+",o=0;for(u=e.length;o<u;o++){var a=e.charAt(o);("-"===a||"/"===a)&&(o===e.length-1||e.charAt(o+1).match(h))&&(s=a),a.match(h)&&("+"===s?t+=parseInt(a):"-"===s?t-=parseInt(a):"/"===s&&(t/=parseInt(a)))}}return[t,n,r,i]};n.CIFInterpreter=function(){},(n.CIFInterpreter.prototype=new n._Interpreter).read=function(n,h,g,y){h=h?h:1,g=g?g:1,y=y?y:1;var w=new r.Molecule;if(!n)return w;for(var E=n.split("\n"),S=0,T=0,N=0,C=n=0,k=0,L="P",O,M,_,D,P=!0;0<E.length;)if(P?D=E.shift():P=!0,0<D.length)if(t.stringStartsWith(D,"_cell_length_a"))S=parseFloat(D.split(a)[1]);else if(t.stringStartsWith(D,"_cell_length_b"))T=parseFloat(D.split(a)[1]);else if(t.stringStartsWith(D,"_cell_length_c"))N=parseFloat(D.split(a)[1]);else if(t.stringStartsWith(D,"_cell_angle_alpha"))n=s.PI*parseFloat(D.split(a)[1])/180;else if(t.stringStartsWith(D,"_cell_angle_beta"))C=s.PI*parseFloat(D.split(a)[1])/180;else if(t.stringStartsWith(D,"_cell_angle_gamma"))k=s.PI*parseFloat(D.split(a)[1])/180;else if(t.stringStartsWith(D,"_symmetry_space_group_name_H-M"))L=D.split(f)[1];else if(t.stringStartsWith(D,"loop_")){for(var H={fields:[],lines:[]},B=!1;void 0!==(D=E.shift())&&!t.stringStartsWith(D=D.replace(c,""),"loop_")&&0<D.length;)if(t.stringStartsWith(D,"_")){if(B)break;H.fields=H.fields.concat(D.split(u).filter(d))}else B=!0,H.lines.push(D);0!==E.length&&(t.stringStartsWith(D,"loop_")||t.stringStartsWith(D,"_"))&&(P=!1),-1!==H.fields.indexOf("_symmetry_equiv_pos_as_xyz")||-1!==H.fields.indexOf("_space_group_symop_operation_xyz")?O=H:-1!==H.fields.indexOf("_atom_site_label")?M=H:-1!==H.fields.indexOf("_geom_bond_atom_site_label_1")&&(_=H)}D=S,n=(s.cos(n)-s.cos(k)*s.cos(C))/s.sin(k),n=[D,0,0,0,T*s.cos(k),T*s.sin(k),0,0,N*s.cos(C),N*n,N*s.sqrt(1-s.pow(s.cos(C),2)-n*n),0,0,0,0,1];if(M){H=P=S=E=N=-1,k=0;for(C=M.fields.length;k<C;k++)D=M.fields[k],"_atom_site_type_symbol"===D?N=k:"_atom_site_label"===D?E=k:"_atom_site_fract_x"===D?S=k:"_atom_site_fract_y"===D?P=k:"_atom_site_fract_z"===D&&(H=k);k=0;for(C=M.lines.length;k<C;k++)D=M.lines[k],T=D.split(u).filter(d),D=new r.Atom(T[-1===N?E:N].split(p)[0],parseFloat(T[S]),parseFloat(T[P]),parseFloat(T[H])),w.atoms.push(D),-1!==E&&(D.cifId=T[E],D.cifPart=0)}if(O&&!_){k=T=0;for(C=O.fields.length;k<C;k++)if(D=O.fields[k],"_symmetry_equiv_pos_as_xyz"===D||"_space_group_symop_operation_xyz"===D)T=k;P=v[L],E=[],k=0;for(C=O.lines.length;k<C;k++){D=O.lines[k].split(l).filter(d);for(var H=m(D[T]),B=m(D[T+1]),F=m(D[T+2]),L=0,S=w.atoms.length;L<S;L++){D=w.atoms[L];var I=D.x*H[1]+D.y*H[2]+D.z*H[3]+H[0],R=D.x*B[1]+D.y*B[2]+D.z*B[3]+B[0],U=D.x*F[1]+D.y*F[2]+D.z*F[3]+F[0];M=new r.Atom(D.label,I,R,U),E.push(M),void 0!==D.cifId&&(M.cifId=D.cifId,M.cifPart=k+1);if(P){M=0;for(N=P.length;M<N;M++){var z=P[M],z=new r.Atom(D.label,I+z[0],R+z[1],U+z[2]);E.push(z),void 0!==D.cifId&&(z.cifId=D.cifId,z.cifPart=k+1)}}}}k=0;for(C=E.length;k<C;k++){for(D=E[k];1<=D.x;)D.x--;for(;0>D.x;)D.x++;for(;1<=D.y;)D.y--;for(;0>D.y;)D.y++;for(;1<=D.z;)D.z--;for(;0>D.z;)D.z++}M=[],k=0;for(C=E.length;k<C;k++){N=!1,D=E[k],L=0;for(S=w.atoms.length;L<S;L++)if(1e-4>w.atoms[L].distance3D(D)){N=!0;break}if(!N){L=0;for(S=M.length;L<S;L++)if(1e-4>M[L].distance3D(D)){N=!0;break}N||M.push(D)}}w.atoms=w.atoms.concat(M)}C=[];for(k=0;k<h;k++)for(L=0;L<g;L++)for(M=0;M<y;M++)if(0!==k||0!==L||0!==M){N=0;for(T=w.atoms.length;N<T;N++)D=w.atoms[N],E=new r.Atom(D.label,D.x+k,D.y+L,D.z+M),C.push(E),void 0!==D.cifId&&(E.cifId=D.cifId,E.cifPart=D.cifPart+(O?O.lines.length:0)+k+10*L+100*M)}w.atoms=w.atoms.concat(C),k=0;for(C=w.atoms.length;k<C;k++)D=w.atoms[k],O=o.multiplyVec3(n,[D.x,D.y,D.z]),D.x=O[0],D.y=O[1],D.z=O[2];if(_){E=O=-1,k=0;for(C=_.fields.length;k<C;k++)D=_.fields[k],"_geom_bond_atom_site_label_1"===D?O=k:"_geom_bond_atom_site_label_2"===D&&(E=k);M=0;for(N=_.lines.length;M<N;M++){T=_.lines[M].split(u).filter(d),D=T[O],T=T[E],k=0;for(C=w.atoms.length;k<C;k++)for(L=k+1;L<C;L++){S=w.atoms[k],P=w.atoms[L];if(S.cifPart!==P.cifPart)break;(S.cifId===D&&P.cifId===T||S.cifId===T&&P.cifId===D)&&w.bonds.push(new r.Bond(S,P))}}}else(new e.informatics.BondDeducer).deduceCovalentBonds(w,1);return h=[-h/2,-g/2,-y/2],h={o:o.multiplyVec3(n,h,[]),x:o.multiplyVec3(n,[h[0]+1,h[1],h[2]]),y:o.multiplyVec3(n,[h[0],h[1]+1,h[2]]),z:o.multiplyVec3(n,[h[0],h[1],h[2]+1]),xy:o.multiplyVec3(n,[h[0]+1,h[1]+1,h[2]]),xz:o.multiplyVec3(n,[h[0]+1,h[1],h[2]+1]),yz:o.multiplyVec3(n,[h[0],h[1]+1,h[2]+1]),xyz:o.multiplyVec3(n,[h[0]+1,h[1]+1,h[2]+1])},{molecule:w,unitCell:new i.UnitCell(h)}};var g=new n.CIFInterpreter;e.readCIF=function(e,t,n,r){return g.read(e,t,n,r)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3),function(e,t,n,r){t.CMLInterpreter=function(){};var i=t.CMLInterpreter.prototype=new t._Interpreter;i.read=function(e){var t=[];e=r.parseXML(e),e=r(e).find("cml");for(var i=0,s=e.length;i<s;i++)for(var u=r(e[i]).find("molecule"),a=0,f=u.length;a<f;a++){for(var c=t[a]=new n.Molecule,h=[],p=r(u[a]).find("atom"),d=0,v=p.length;d<v;d++){var m=r(p[d]),g=m.attr("elementType"),y,b,w;void 0==m.attr("x2")?(y=m.attr("x3"),b=m.attr("y3"),w=m.attr("z3")):(y=m.attr("x2"),b=m.attr("y2"),w=0),g=t[a].atoms[d]=new n.Atom(g,y,b,w),h[d]=m.attr("id"),void 0!=m.attr("formalCharge")&&(g.charge=m.attr("formalCharge"))}p=r(u[a]).find("bond"),d=0;for(v=p.length;d<v;d++){m=r(p[d]),y=m.attr("atomRefs2").split(" "),g=c.atoms[r.inArray(y[0],h)],y=c.atoms[r.inArray(y[1],h)];switch(m.attr("order")){case"2":case"D":b=2;break;case"3":case"T":b=3;break;case"A":b=1.5;break;default:b=1}g=t[a].bonds[d]=new n.Bond(g,y,b);switch(m.find("bondStereo").text()){case"W":g.stereo=n.Bond.STEREO_PROTRUDING;break;case"H":g.stereo=n.Bond.STEREO_RECESSED}}}return t},i.write=function(e){var t=[];t.push('<?xml version="1.0" encoding="UTF-8"?>\n'),t.push('<cml convention="conventions:molecular" xmlns="http://www.xml-cml.org/schema" xmlns:conventions="http://www.xml-cml.org/convention/" xmlns:dc="http://purl.org/dc/elements/1.1/">\n');for(var n=0,r=e.length;n<r;n++){t.push('<molecule id="m'),t.push(n),t.push('">'),t.push("<atomArray>");for(var i=0,s=e[n].atoms.length;i<s;i++){var o=e[n].atoms[i];t.push('<atom elementType="'),t.push(o.label),t.push('" id="a'),t.push(i),t.push('" '),t.push('x3="'),t.push(o.x),t.push('" y3="'),t.push(o.y),t.push('" z3="'),t.push(o.z),t.push('" '),0!=o.charge&&(t.push('formalCharge="'),t.push(o.charge),t.push('" ')),t.push("/>")}t.push("</atomArray>"),t.push("<bondArray>"),i=0;for(s=e[n].bonds.length;i<s;i++){o=e[n].bonds[i],t.push('<bond atomRefs2="a'),t.push(e[n].atoms.indexOf(o.a1)),t.push(" a"),t.push(e[n].atoms.indexOf(o.a2)),t.push('" order="');switch(o.bondOrder){case 1.5:t.push("A");break;case 1:case 2:case 3:t.push(o.bondOrder);break;default:t.push("S")}t.push('"/>')}t.push("</bondArray>"),t.push("</molecule>")}return t.push("</cml>"),t.join("")};var s=new t.CMLInterpreter;e.readCML=function(e){return s.read(e)},e.writeCML=function(e){return s.write(e)}}(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery),function(e,t,n,r){n.MOLInterpreter=function(){};var i=n.MOLInterpreter.prototype=new n._Interpreter;i.read=function(n,i){i||(i=e.default_bondLength_2D);var s=new r.Molecule;if(!n)return s;for(var o=n.split("\n"),u=o[3],a=parseInt(u.substring(0,3)),u=parseInt(u.substring(3,6)),f=0;f<a;f++){var c=o[4+f];s.atoms[f]=new r.Atom(c.substring(31,34),parseFloat(c.substring(0,10))*i,(1===i?1:-1)*parseFloat(c.substring(10,20))*i,parseFloat(c.substring(20,30))*i);var h=parseInt(c.substring(34,36));0!==h&&t[s.atoms[f].label]&&(s.atoms[f].mass=t[s.atoms[f].label].mass+h);switch(parseInt(c.substring(36,39))){case 1:s.atoms[f].charge=3;break;case 2:s.atoms[f].charge=2;break;case 3:s.atoms[f].charge=1;break;case 5:s.atoms[f].charge=-1;break;case 6:s.atoms[f].charge=-2;break;case 7:s.atoms[f].charge=-3}}for(f=0;f<u;f++){var c=o[4+a+f],p=parseInt(c.substring(6,9)),h=parseInt(c.substring(9,12));if(3<p)switch(p){case 4:p=1.5;break;default:p=1}c=new r.Bond(s.atoms[parseInt(c.substring(0,3))-1],s.atoms[parseInt(c.substring(3,6))-1],p);switch(h){case 3:c.stereo=r.Bond.STEREO_AMBIGUOUS;break;case 1:c.stereo=r.Bond.STEREO_PROTRUDING;break;case 6:c.stereo=r.Bond.STEREO_RECESSED}s.bonds[f]=c}return s},i.write=function(n){var i=[];i.push("Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n"),i.push(this.fit(n.atoms.length.toString(),3)),i.push(this.fit(n.bonds.length.toString(),3)),i.push("  0  0  0  0            999 V2000\n");for(var s=n.getCenter(),o=0,u=n.atoms.length;o<u;o++){var a=n.atoms[o],f=" 0";if(-1!==a.mass&&t[a.label]){var c=a.mass-t[a.label].mass;5>c&&-4<c&&(f=(-1<c?" ":"")+c)}c="  0";if(0!==a.charge)switch(a.charge){case 3:c="  1";break;case 2:c="  2";break;case 1:c="  3";break;case-1:c="  5";break;case-2:c="  6";break;case-3:c="  7"}i.push(this.fit(((a.x-s.x)/e.default_bondLength_2D).toFixed(4),10)),i.push(this.fit((-(a.y-s.y)/e.default_bondLength_2D).toFixed(4),10)),i.push(this.fit((a.z/e.default_bondLength_2D).toFixed(4),10)),i.push(" "),i.push(this.fit(a.label,3,!0)),i.push(f),i.push(c),i.push("  0  0  0  0\n")}o=0;for(u=n.bonds.length;o<u;o++){a=n.bonds[o],s=0,a.stereo===r.Bond.STEREO_AMBIGUOUS?s=3:a.stereo===r.Bond.STEREO_PROTRUDING?s=1:a.stereo===r.Bond.STEREO_RECESSED&&(s=6),i.push(this.fit((n.atoms.indexOf(a.a1)+1).toString(),3)),i.push(this.fit((n.atoms.indexOf(a.a2)+1).toString(),3)),a=a.bondOrder;if(1.5==a)a=4;else if(3<a||0!=a%1)a=1;i.push(this.fit(a,3)),i.push("  "),i.push(s),i.push("     0  0\n")}return i.push("M  END"),i.join("")};var s=new n.MOLInterpreter;e.readMOL=function(e,t){return s.read(e,t)},e.writeMOL=function(e){return s.write(e)}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.io,ChemDoodle.structures),function(e,t,n,r,i,s,o){function u(e,t,n,r,i){for(var s=0,o=t.length;s<o;s++){var u=t[s];if(u.id===n&&r>=u.start&&r<=u.end){i?e.helix=!0:e.sheet=!0,r===u.end&&(e.arrow=!0);break}}}n.PDBInterpreter=function(){};var a=n.PDBInterpreter.prototype=new n._Interpreter;a.calculateRibbonDistances=!1,a.deduceResidueBonds=!1,a.read=function(n,a){var f=new r.Molecule;f.chains=[];if(!n)return f;var c=n.split("\n");a||(a=1);for(var p=[],d=[],v,m=[],y=[],w=[],E=0,S=c.length;E<S;E++){var x=c[E];if(t.stringStartsWith(x,"HELIX"))p.push({id:x.substring(19,20),start:parseInt(x.substring(21,25)),end:parseInt(x.substring(33,37))});else if(t.stringStartsWith(x,"SHEET"))d.push({id:x.substring(21,22),start:parseInt(x.substring(22,26)),end:parseInt(x.substring(33,37))});else if(t.stringStartsWith(x,"ATOM")){var T=x.substring(16,17);if(" "===T||"A"===T){T=s(x.substring(76,78));if(0===T.length){var N=s(x.substring(12,14));"HD"===N?T="H":0<N.length&&(T=1<N.length?N.charAt(0)+N.substring(1).toLowerCase():N)}N=new r.Atom(T,parseFloat(x.substring(30,38))*a,parseFloat(x.substring(38,46))*a,parseFloat(x.substring(46,54))*a),N.hetatm=!1,y.push(N);var C=parseInt(x.substring(22,26));if(0===m.length)for(T=0;3>T;T++){var k=new r.Residue(-1);k.cp1=N,k.cp2=N,m.push(k)}C!==Number.NaN&&m[m.length-1].resSeq!==C&&(T=new r.Residue(C),T.name=s(x.substring(17,20)),3===T.name.length?T.name=T.name.substring(0,1)+T.name.substring(1).toLowerCase():2===T.name.length&&"D"===T.name.charAt(0)&&(T.name=T.name.substring(1)),m.push(T),k=x.substring(21,22),u(T,p,k,C,!0),u(T,d,k,C,!1)),x=s(x.substring(12,16)),T=m[m.length-1];if("CA"===x||"P"===x||"O5'"===x)T.cp1||(T.cp1=N);else if("N3"===x&&("C"===T.name||"U"===T.name||"T"===T.name)||"N1"===x&&("A"===T.name||"G"===T.name))T.cp3=N;else if("C2"===x)T.cp4=N;else if("C4"===x&&("C"===T.name||"U"===T.name||"T"===T.name)||"C6"===x&&("A"===T.name||"G"===T.name))T.cp5=N;else if("O"===x||"C6"===x&&("C"===T.name||"U"===T.name||"T"===T.name)||"N9"===x){if(!m[m.length-1].cp2){if("C6"===x||"N9"===x)v=N;T.cp2=N}}else"C"===x&&(v=N)}}else if(t.stringStartsWith(x,"HETATM"))T=s(x.substring(76,78)),0===T.length&&(T=s(x.substring(12,16))),1<T.length&&(T=T.substring(0,1)+T.substring(1).toLowerCase()),T=new r.Atom(T,parseFloat(x.substring(30,38))*a,parseFloat(x.substring(38,46))*a,parseFloat(x.substring(46,54))*a),T.hetatm=!0,"HOH"===s(x.substring(17,20))&&(T.isWater=!0),f.atoms.push(T),w[parseInt(s(x.substring(6,11)))]=T;else if(t.stringStartsWith(x,"CONECT")){if(T=parseInt(s(x.substring(6,11))),w[T]){N=w[T];for(C=0;4>C;C++)if(T=s(x.substring(11+5*C,16+5*C)),0!==T.length&&(T=parseInt(T),w[T])){for(var k=w[T],L=!1,T=0,A=f.bonds.length;T<A;T++){var O=f.bonds[T];if(O.a1===N&&O.a2===k||O.a1===k&&O.a2===N){L=!0;break}}L||f.bonds.push(new r.Bond(N,k))}}}else if(t.stringStartsWith(x,"TER"))this.endChain(f,m,v,y),m=[];else if(t.stringStartsWith(x,"ENDMDL"))break}this.endChain(f,m,v,y),0===f.bonds.size&&(new e.informatics.BondDeducer).deduceCovalentBonds(f,a);if(this.deduceResidueBonds){E=0;for(S=y.length;E<S;E++){c=o.min(S,E+20);for(T=E+1;T<c;T++)p=y[E],d=y[T],p.distance3D(d)<1.1*(i[p.label].covalentRadius+i[d.label].covalentRadius)&&f.bonds.push(new r.Bond(p,d,1))}}return f.atoms=f.atoms.concat(y),this.calculateRibbonDistances&&this.calculateDistances(f,y),f},a.endChain=function(e,t,n,i){if(0<t.length){var s=t[t.length-1];s.cp1||(s.cp1=i[i.length-2]),s.cp2||(s.cp2=i[i.length-1]);for(i=0;4>i;i++)s=new r.Residue(-1),s.cp1=n,s.cp2=t[t.length-1].cp2,t.push(s);e.chains.push(t)}},a.calculateDistances=function(e,t){for(var n=[],r=0,i=e.atoms.length;r<i;r++){var s=e.atoms[r];s.hetatm&&(s.isWater||n.push(s))}r=0;for(i=t.length;r<i;r++)if(s=t[r],s.closestDistance=Number.POSITIVE_INFINITY,0===n.length)s.closestDistance=0;else for(var o=0,u=n.length;o<u;o++)s.closestDistance=Math.min(s.closestDistance,s.distance3D(n[o]))};var f=new n.PDBInterpreter;e.readPDB=function(e,t){return f.read(e,t)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.ELEMENT,ChemDoodle.lib.jQuery.trim,Math),function(e,t,n,r){var i={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},s={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},o={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};n.JCAMPInterpreter=function(){};var u=n.JCAMPInterpreter.prototype=new n._Interpreter;u.convertHZ2PPM=!1,u.read=function(e){this.isBreak=function(e){return void 0!==i[e]||void 0!==s[e]||void 0!==o[e]||" "===e||"-"===e||"+"===e},this.getValue=function(e,t){var n=e.charAt(0),r=e.substring(1);return void 0!==i[n]?parseFloat(i[n]+r):void 0!==s[n]?parseFloat(s[n]+r)+t:parseFloat(r)};var n=new r.Spectrum;if(void 0===e||0===e.length)return n;e=e.split("\n");for(var u=[],a,f,c,p,d=1,v=1,m=1,y=-1,b=-1,w=-1,E=!0,S=!1,x=0,T=e.length;x<T;x++){var N=e[x].trim(),C=N.indexOf("$$");-1!==C&&(N=N.substring(0,C));if(0===u.length||!t.stringStartsWith(e[x],"##"))N=N.trim(),0!==u.length&&0!==N.length&&u.push("\n"),u.push(N);else if(C=u.join(""),E&&100>C.length&&n.metadata.push(C),u=[N],t.stringStartsWith(C,"##TITLE="))n.title=C.substring(8).trim();else if(t.stringStartsWith(C,"##XUNITS="))n.xUnit=C.substring(9).trim(),this.convertHZ2PPM&&"HZ"===n.xUnit.toUpperCase()&&(n.xUnit="PPM",S=!0);else if(t.stringStartsWith(C,"##YUNITS="))n.yUnit=C.substring(9).trim();else if(!t.stringStartsWith(C,"##XYPAIRS="))if(t.stringStartsWith(C,"##FIRSTX="))f=parseFloat(C.substring(9).trim());else if(t.stringStartsWith(C,"##LASTX="))a=parseFloat(C.substring(8).trim());else if(t.stringStartsWith(C,"##FIRSTY="))c=parseFloat(C.substring(9).trim());else if(t.stringStartsWith(C,"##NPOINTS="))p=parseFloat(C.substring(10).trim());else if(t.stringStartsWith(C,"##XFACTOR="))d=parseFloat(C.substring(10).trim());else if(t.stringStartsWith(C,"##YFACTOR="))
v=parseFloat(C.substring(10).trim());else if(t.stringStartsWith(C,"##DELTAX="))y=parseFloat(C.substring(9).trim());else if(t.stringStartsWith(C,"##.OBSERVE FREQUENCY="))this.convertHZ2PPM&&(m=parseFloat(C.substring(21).trim()));else if(t.stringStartsWith(C,"##.SHIFT REFERENCE="))this.convertHZ2PPM&&(w=C.substring(19).split(","),b=parseInt(w[2].trim()),w=parseFloat(w[3].trim()));else if(t.stringStartsWith(C,"##XYDATA=")){S||(m=1);var k=E=!1,N=C.split("\n"),L=(a-f)/(p-1);if(-1!==y)for(var C=1,A=N.length;C<A;C++)if("|"===N[C].charAt(0)){L=y;break}for(var O=f-L,M=c,_=0,D,C=1,A=N.length;C<A;C++){for(var P=[],O=N[C].trim(),u=[],H=!1,B=0,F=O.length;B<F;B++)this.isBreak(O.charAt(B))?(0<u.length&&(1!==u.length||" "!==u[0])&&P.push(u.join("")),u=[O.charAt(B)]):"|"===O.charAt(B)?H=!0:u.push(O.charAt(B));P.push(u.join("")),O=parseFloat(P[0])*d-L,B=1;for(F=P.length;B<F;B++)if(M=P[B],void 0!==o[M.charAt(0)])for(var I=parseInt(o[M.charAt(0)]+M.substring(1))-1,q=0;q<I;q++)O+=L,_=this.getValue(D,_),M=_*v,R++,n.data[n.data.length-1]=new r.Point(O/m,M);else void 0!==i[M.charAt(0)]&&k?(M=this.getValue(M,_)*v,H&&(O+=L,n.data.push(new r.Point(O/m,M)))):(k=void 0!==s[M.charAt(0)],D=M,O+=L,_=this.getValue(M,_),M=_*v,R++,n.data.push(new r.Point(O/m,M)))}if(-1!==b){N=w-n.data[b-1].x,x=0;for(T=n.data.length;x<T;x++)n.data[x].x+=N}}else if(t.stringStartsWith(C,"##PEAK TABLE=")){E=!1,n.continuous=!1;for(var N=C.split("\n"),R=0,k=/[\s,]+/,C=1,A=N.length;C<A;C++){H=N[C].split(k),R+=H.length/2,B=0;for(F=H.length;B+1<F;B+=2)n.data.push(new r.Point(parseFloat(H[B].trim()),parseFloat(H[B+1].trim())))}}else if(t.stringStartsWith(C,"##ATOMLIST=")){n.molecule=new r.Molecule,N=C.split("\n"),k=/[\s]+/,C=1;for(A=N.length;C<A;C++)H=N[C].split(k),n.molecule.atoms.push(new r.Atom(H[1]))}else if(t.stringStartsWith(C,"##BONDLIST=")){N=C.split("\n"),k=/[\s]+/,C=1;for(A=N.length;C<A;C++)H=N[C].split(k),B=1,"D"===H[2]?B=2:"T"===H[2]&&(B=3),n.molecule.bonds.push(new r.Bond(n.molecule.atoms[parseInt(H[0])-1],n.molecule.atoms[parseInt(H[1])-1],B))}else if(n.molecule&&t.stringStartsWith(C,"##XY_RASTER=")){N=C.split("\n"),k=/[\s]+/,C=1;for(A=N.length;C<A;C++)H=N[C].split(k),L=n.molecule.atoms[parseInt(H[0])-1],L.x=parseInt(H[1]),L.y=parseInt(H[2]),4==H.length&&(L.z=parseInt(H[3]));n.molecule.scaleToAverageBondLength(20)}else if(t.stringStartsWith(C,"##PEAK ASSIGNMENTS=")){N=C.split("\n"),k=/[\s,()<>]+/,n.assignments=[],C=1;for(A=N.length;C<A;C++){H=N[C].split(k),_=parseFloat(H[1]),P=parseFloat(H[2]),L=n.molecule.atoms[parseInt(H[3])-1],H=!1,B=0;for(F=n.assignments.length;B<F;B++)if(O=n.assignments[B],O.x===_){O.as.push(L),L.assigned=O,H=!0;break}H||(O={x:_,y:P,as:[L]},L.assigned=O,n.assignments.push(O))}}}return n.setup(),n},u.makeStructureSpectrumSet=function(t,n){this.convertHZ2PPM=!0;var r=this.read(n),i=new e.ViewerCanvas(t+"_molecule",200,200);i.specs.atoms_displayTerminalCarbonLabels_2D=!0,i.specs.atoms_displayImplicitHydrogens_2D=!0,i.mouseout=function(){if(0!==this.molecules.length){for(var e=0,t=this.molecules[0].atoms.length;e<t;e++)this.molecules[0].atoms[e].isHover=!1;r.hovered=void 0,this.repaint(),s.repaint()}},i.touchend=i.mouseout,i.mousemove=function(e){if(0!==this.molecules.length){for(var t=void 0,n=0,i=this.molecules[0].atoms.length;n<i;n++){var o=this.molecules[0].atoms[n];o.isHover=!1,o.assigned&&(void 0===t||e.p.distance(o)<e.p.distance(t))&&(t=o)}r.hovered=void 0;if(20>e.p.distance(t)){n=0;for(i=t.assigned.as.length;n<i;n++)t.assigned.as[n].isHover=!0;s.spectrum.hovered=t.assigned}this.repaint(),s.repaint()}},i.touchmove=i.mousemove,i.drawChildExtras=function(e){if(0!==this.molecules.length)for(var t=0,n=this.molecules[0].atoms.length;t<n;t++)this.molecules[0].atoms[t].drawDecorations(e)};var s=new e.ObserverCanvas(t+"_spectrum",400,200);return s.specs.plots_showYAxis=!1,s.specs.plots_flipXAxis=!0,s.mouseout=function(){if(this.spectrum&&this.spectrum.assignments){for(var e=0,t=i.molecules[0].atoms.length;e<t;e++)i.molecules[0].atoms[e].isHover=!1;this.spectrum.hovered=void 0,i.repaint(),this.repaint()}},s.touchend=s.mouseout,s.mousemove=function(e){if(this.spectrum&&this.spectrum.assignments){for(var t=void 0,n=0,r=i.molecules[0].atoms.length;n<r;n++)i.molecules[0].atoms[n].isHover=!1;this.spectrum.hovered=void 0,n=0;for(r=this.spectrum.assignments.length;n<r;n++){var s=this.spectrum.assignments[n];if(void 0===t||Math.abs(this.spectrum.getTransformedX(s.x,this.specs,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-e.p.x)<Math.abs(this.spectrum.getTransformedX(t.x,this.specs,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-e.p.x))t=s}if(20>Math.abs(this.spectrum.getTransformedX(t.x,this.specs,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-e.p.x)){n=0;for(r=t.as.length;n<r;n++)t.as[n].isHover=!0;this.spectrum.hovered=t}i.repaint(),this.repaint()}},s.touchmove=s.mousemove,s.drawChildExtras=function(e){if(this.spectrum&&this.spectrum.hovered){var t=this.spectrum.getTransformedX(this.spectrum.hovered.x,s.specs,this.spectrum.memory.width,this.spectrum.memory.offsetLeft);t>=this.spectrum.memory.offsetLeft&&t<this.spectrum.memory.width&&(e.save(),e.strokeStyle="#885110",e.lineWidth=3,e.beginPath(),e.moveTo(t,this.spectrum.memory.height-this.spectrum.memory.offsetBottom),e.lineTo(t,this.spectrum.getTransformedY(this.spectrum.hovered.y,s.specs,this.spectrum.memory.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)),e.stroke(),e.restore())}},r&&(s.loadSpectrum(r),r.molecule&&i.loadMolecule(r.molecule)),[i,s]};var a=new n.JCAMPInterpreter;a.convertHZ2PPM=!0,e.readJCAMP=function(e){return a.read(e)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery),function(e,t,n,r,i,s){t.JSONInterpreter=function(){};var o=t.JSONInterpreter.prototype;o.contentTo=function(e,t){for(var n=0,r=0,i=0,s=e.length;i<s;i++){for(var o=e[i],u=0,a=o.atoms.length;u<a;u++)o.atoms[u].tmpid="a"+n++;u=0;for(a=o.bonds.length;u<a;u++)o.bonds[u].tmpid="b"+r++}i=n=0;for(s=t.length;i<s;i++)t[i].tmpid="s"+n++;n={};if(e&&0<e.length){n.m=[],i=0;for(s=e.length;i<s;i++)n.m.push(this.molTo(e[i]))}if(t&&0<t.length){n.s=[],i=0;for(s=t.length;i<s;i++)n.s.push(this.shapeTo(t[i]))}i=0;for(s=e.length;i<s;i++){o=e[i],u=0;for(a=o.atoms.length;u<a;u++)o.atoms[u].tmpid=void 0;u=0;for(a=o.bonds.length;u<a;u++)o.bonds[u].tmpid=void 0}i=0;for(s=t.length;i<s;i++)t[i].tmpid=void 0;return n},o.contentFrom=function(e){var t={molecules:[],shapes:[]};if(e.m)for(var n=0,r=e.m.length;n<r;n++)t.molecules.push(this.molFrom(e.m[n]));if(e.s){n=0;for(r=e.s.length;n<r;n++)t.shapes.push(this.shapeFrom(e.s[n],t.molecules))}n=0;for(r=t.molecules.length;n<r;n++){e=t.molecules[n];for(var i=0,s=e.atoms.length;i<s;i++)e.atoms[i].tmpid=void 0;i=0;for(s=e.bonds.length;i<s;i++)e.bonds[i].tmpid=void 0}n=0;for(r=t.shapes.length;n<r;n++)t.shapes[n].tmpid=void 0;return t},o.queryTo=function(e){var t={},r=function(t,n,r,i){n&&(t[r]={v:i?e.outputRange(n.v):n.v,n:n.not})};return e.type===n.Query.TYPE_ATOM?(r(t,e.elements,"as"),r(t,e.chirality,"@"),r(t,e.aromatic,"A"),r(t,e.charge,"C",!0),r(t,e.hydrogens,"H",!0),r(t,e.ringCount,"R",!0),r(t,e.saturation,"S"),r(t,e.connectivity,"X",!0),r(t,e.connectivityNoH,"x",!0)):(r(t,e.orders,"bs"),r(t,e.stereo,"@"),r(t,e.aromatic,"A"),r(t,e.ringCount,"R",!0)),t},o.molTo=function(e){for(var t={a:[]},r=0,i=e.atoms.length;r<i;r++){var s=e.atoms[r],o={x:s.x,y:s.y};s.tmpid&&(o.i=s.tmpid),"C"!==s.label&&(o.l=s.label),0!==s.z&&(o.z=s.z),0!==s.charge&&(o.c=s.charge),-1!==s.mass&&(o.m=s.mass),0!==s.numRadical&&(o.r=s.numRadical),0!==s.numLonePair&&(o.p=s.numLonePair),s.query&&(o.q=this.queryTo(s.query)),t.a.push(o)}if(0<e.bonds.length){t.b=[],r=0;for(i=e.bonds.length;r<i;r++)s=e.bonds[r],o={b:e.atoms.indexOf(s.a1),e:e.atoms.indexOf(s.a2)},s.tmpid&&(o.i=s.tmpid),1!==s.bondOrder&&(o.o=s.bondOrder),s.stereo!==n.Bond.STEREO_NONE&&(o.s=s.stereo),s.query&&(o.q=this.queryTo(s.query)),t.b.push(o)}return t},o.queryFrom=function(e){var t=new n.Query(e.as?n.Query.TYPE_ATOM:n.Query.TYPE_BOND),r=function(e,t,n,r){t&&(e[n]={},e[n].v=r?e.parseRange(t.v):t.v,t.n&&(e[n].not=!0))};return t.type===n.Query.TYPE_ATOM?(r(t,e.as,"elements"),r(t,e["@"],"chirality"),r(t,e.A,"aromatic"),r(t,e.C,"charge",!0),r(t,e.H,"hydrogens",!0),r(t,e.R,"ringCount",!0),r(t,e.S,"saturation"),r(t,e.X,"connectivity",!0),r(t,e.x,"connectivityNoH",!0)):(r(t,e.bs,"orders"),r(t,e["@"],"stereo"),r(t,e.A,"aromatic"),r(t,e.R,"ringCount",!0)),t},o.molFrom=function(e){for(var t=new n.Molecule,r=0,i=e.a.length;r<i;r++){var s=e.a[r],o=new n.Atom(s.l?s.l:"C",s.x,s.y);s.i&&(o.tmpid=s.i),s.z&&(o.z=s.z),s.c&&(o.charge=s.c),s.m&&(o.mass=s.m),s.r&&(o.numRadical=s.r),s.p&&(o.numLonePair=s.p),s.q&&(o.query=this.queryFrom(s.q)),void 0!==s.p_h&&(o.hetatm=s.p_h),void 0!==s.p_w&&(o.isWater=s.p_w),void 0!==s.p_d&&(o.closestDistance=s.p_d),t.atoms.push(o)}if(e.b){r=0;for(i=e.b.length;r<i;r++)s=e.b[r],o=new n.Bond(t.atoms[s.b],t.atoms[s.e],void 0===s.o?1:s.o),s.i&&(o.tmpid=s.i),s.s&&(o.stereo=s.s),s.q&&(o.query=this.queryFrom(s.q)),t.bonds.push(o)}return t},o.shapeTo=function(e){var t={};e.tmpid&&(t.i=e.tmpid);if(e instanceof r.Line)t.t="Line",t.x1=e.p1.x,t.y1=e.p1.y,t.x2=e.p2.x,t.y2=e.p2.y,t.a=e.arrowType;else if(e instanceof r.Pusher)t.t="Pusher",t.o1=e.o1.tmpid,t.o2=e.o2.tmpid,1!==e.numElectron&&(t.e=e.numElectron);else if(e instanceof r.Bracket)t.t="Bracket",t.x1=e.p1.x,t.y1=e.p1.y,t.x2=e.p2.x,t.y2=e.p2.y,0!==e.charge&&(t.c=e.charge),0!==e.mult&&(t.m=e.mult),0!==e.repeat&&(t.r=e.repeat);else if(e instanceof i.Distance)t.t="Distance",t.a1=e.a1.tmpid,t.a2=e.a2.tmpid,e.node&&(t.n=e.node,t.o=e.offset);else if(e instanceof i.Angle)t.t="Angle",t.a1=e.a1.tmpid,t.a2=e.a2.tmpid,t.a3=e.a3.tmpid;else if(e instanceof i.Torsion)t.t="Torsion",t.a1=e.a1.tmpid,t.a2=e.a2.tmpid,t.a3=e.a3.tmpid,t.a4=e.a4.tmpid;else if(e instanceof i.UnitCell){t.t="UnitCell";for(var n in e.unitCell)t[n]=e.unitCell[n]}return t},o.shapeFrom=function(e,t){var s;if("Line"===e.t)s=new r.Line(new n.Point(e.x1,e.y1),new n.Point(e.x2,e.y2)),s.arrowType=e.a;else if("Pusher"===e.t){var o,u,a=0;for(s=t.length;a<s;a++){for(var f=t[a],c=0,p=f.atoms.length;c<p;c++){var d=f.atoms[c];d.tmpid===e.o1?o=d:d.tmpid===e.o2&&(u=d)}c=0;for(p=f.bonds.length;c<p;c++){var v=f.bonds[c];v.tmpid===e.o1?o=v:v.tmpid===e.o2&&(u=v)}}s=new r.Pusher(o,u),e.e&&(s.numElectron=e.e)}else if("Bracket"===e.t)s=new r.Bracket(new n.Point(e.x1,e.y1),new n.Point(e.x2,e.y2)),void 0!==e.c&&(s.charge=e.c),void 0!==e.m&&(s.mult=e.m),void 0!==e.r&&(s.repeat=e.r);else if("Distance"===e.t){var m,a=0;for(s=t.length;a<s;a++){f=t[a],c=0;for(p=f.atoms.length;c<p;c++)d=f.atoms[c],d.tmpid===e.a1?v=d:d.tmpid===e.a2&&(m=d)}s=new i.Distance(v,m,e.n,e.o)}else if("Angle"===e.t){var g,a=0;for(s=t.length;a<s;a++){f=t[a],c=0;for(p=f.atoms.length;c<p;c++)d=f.atoms[c],d.tmpid===e.a1?v=d:d.tmpid===e.a2?m=d:d.tmpid===e.a3&&(g=d)}s=new i.Angle(v,m,g)}else if("Torsion"===e.t){var y,a=0;for(s=t.length;a<s;a++){f=t[a],c=0;for(p=f.atoms.length;c<p;c++)d=f.atoms[c],d.tmpid===e.a1?v=d:d.tmpid===e.a2?m=d:d.tmpid===e.a3?g=d:d.tmpid===e.a4&&(y=d)}s=new i.Torsion(v,m,g,y)}else if("UnitCell"===e.t){o={};for(a in e)o[a]=e[a];s=new i.UnitCell(o)}return s},o.pdbFrom=function(e){var t=this.molFrom(e.mol);return t.findRings=!1,t.fromJSON=!0,t.chains=this.chainsFrom(e.ribbons),t},o.chainsFrom=function(e){for(var t=[],r=0,i=e.cs.length;r<i;r++){for(var s=e.cs[r],o=[],u=0,a=s.length;u<a;u++){var f=s[u],l=new n.Residue;l.name=f.n,l.cp1=new n.Atom("",f.x1,f.y1,f.z1),l.cp2=new n.Atom("",f.x2,f.y2,f.z2),f.x3&&(l.cp3=new n.Atom("",f.x3,f.y3,f.z3),l.cp4=new n.Atom("",f.x4,f.y4,f.z4),l.cp5=new n.Atom("",f.x5,f.y5,f.z5)),l.helix=f.h,l.sheet=f.s,l.arrow=0<u&&s[u-1].a,o.push(l)}t.push(o)}return t};var u=new t.JSONInterpreter;e.readJSON=function(e){var t;try{t=s.parse(e)}catch(n){return}if(t)return t.m||t.s?u.contentFrom(t):t.a?{molecules:[u.molFrom(t)],shapes:[]}:{molecules:[],shapes:[]}},e.writeJSON=function(e,t){return s.stringify(u.contentTo(e,t))}}(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.structures.d2,ChemDoodle.structures.d3,JSON),function(e,t,n){t.RXNInterpreter=function(){};var r=t.RXNInterpreter.prototype=new t._Interpreter;r.read=function(t,r){r||(r=e.default_bondLength_2D);var i=[],s;if(t){s=t.split("$MOL\n");for(var u=s[0].split("\n")[4],a=parseInt(u.substring(0,3)),u=parseInt(u.substring(3,6)),f=1,l=0,c=0,h=a+u;c<h;c++){i[c]=e.readMOL(s[f],r);var p=i[c].getBounds(),p=p.maxX-p.minX,l=l-(p+40);f++}c=0;for(h=a;c<h;c++){var p=i[c].getBounds(),p=p.maxX-p.minX,f=i[c].getCenter(),d=0;for(s=i[c].atoms.length;d<s;d++){var v=i[c].atoms[d];v.x+=l+p/2-f.x,v.y-=f.y}l+=p+40}s=new n.d2.Line(new n.Point(l,0),new n.Point(l+40,0)),l+=80,c=a;for(h=a+u;c<h;c++){p=i[c].getBounds(),p=p.maxX-p.minX,f=i[c].getCenter();for(d=0;d<i[c].atoms.length;d++)v=i[c].atoms[d],v.x+=l+p/2-f.x,v.y-=f.y;l+=p+40}}else i.push(new n.Molecule),s=new n.d2.Line(new n.Point(-20,0),new n.Point(20,0));return s.arrowType=n.d2.Line.ARROW_SYNTHETIC,{molecules:i,shapes:[s]}},r.write=function(t,r){var i=[[],[]],s=void 0;if(t&&r){u=0;for(a=r.length;u<a;u++)if(r[u]instanceof n.d2.Line){s=r[u].getPoints();break}if(!s)return"";for(var u=0,a=t.length;u<a;u++)t[u].getCenter().x<s[1].x?i[0].push(t[u]):i[1].push(t[u]);s=[],s.push("$RXN\nReaction from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n"),s.push(this.fit(i[0].length.toString(),3)),s.push(this.fit(i[1].length.toString(),3)),s.push("\n");for(u=0;2>u;u++)for(var a=0,f=i[u].length;a<f;a++)s.push("$MOL\n"),s.push(e.writeMOL(i[u][a])),s.push("\n");return s.join("")}};var i=new t.RXNInterpreter;e.readRXN=function(e,t){return i.read(e,t)},e.writeRXN=function(e,t){return i.write(e,t)}}(ChemDoodle,ChemDoodle.io,ChemDoodle.structures),function(e,t,n,r,i,s){r.XYZInterpreter=function(){},t=r.XYZInterpreter.prototype=new r._Interpreter,t.deduceCovalentBonds=!0,t.read=function(t){var r=new i.Molecule;if(!t)return r;t=t.split("\n");for(var o=parseInt(s(t[0])),u=0;u<o;u++){var a=t[u+2].split(/\s+/g);r.atoms[u]=new i.Atom(isNaN(a[0])?a[0]:n[parseInt(a[0])-1],parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]))}return this.deduceCovalentBonds&&(new e.informatics.BondDeducer).deduceCovalentBonds(r,1),r};var o=new r.XYZInterpreter;e.readXYZ=function(e){return o.read(e)}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.SYMBOLS,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery.trim),ChemDoodle.monitor=function(e,t,n){var r={CANVAS_DRAGGING:void 0,CANVAS_OVER:void 0,ALT:!1,SHIFT:!1,META:!1};return e.supports_touch()||t(n).ready(function(){t(n).mousemove(function(e){r.CANVAS_DRAGGING&&r.CANVAS_DRAGGING.drag&&(r.CANVAS_DRAGGING.prehandleEvent(e),r.CANVAS_DRAGGING.drag(e))}),t(n).mouseup(function(e){r.CANVAS_DRAGGING&&r.CANVAS_DRAGGING!==r.CANVAS_OVER&&r.CANVAS_DRAGGING.mouseup&&(r.CANVAS_DRAGGING.prehandleEvent(e),r.CANVAS_DRAGGING.mouseup(e)),r.CANVAS_DRAGGING=void 0}),t(n).keydown(function(e){r.SHIFT=e.shiftKey,r.ALT=e.altKey,r.META=e.metaKey||e.ctrlKey;var t=r.CANVAS_OVER;r.CANVAS_DRAGGING&&(t=r.CANVAS_DRAGGING),t&&t.keydown&&(t.prehandleEvent(e),t.keydown(e))}),t(n).keypress(function(e){var t=r.CANVAS_OVER;r.CANVAS_DRAGGING&&(t=r.CANVAS_DRAGGING),t&&t.keypress&&(t.prehandleEvent(e),t.keypress(e))}),t(n).keyup(function(e){r.SHIFT=e.shiftKey,r.ALT=e.altKey,r.META=e.metaKey||e.ctrlKey;var t=r.CANVAS_OVER;r.CANVAS_DRAGGING&&(t=r.CANVAS_DRAGGING),t&&t.keyup&&(t.prehandleEvent(e),t.keyup(e))})}),r}(ChemDoodle.featureDetection,ChemDoodle.lib.jQuery,document),function(e,t,n,r,i,s,o,u,a,f){e._Canvas=function(){};var l=e._Canvas.prototype;l.molecules=void 0,l.shapes=void 0,l.emptyMessage=void 0,l.image=void 0,l.repaint=function(){if(!this.test){var e=u.getElementById(this.id);if(e.getContext){var t=e.getContext("2d");1!==this.pixelRatio&&e.width===this.width&&(e.width=this.width*this.pixelRatio,e.height=this.height*this.pixelRatio,t.scale(this.pixelRatio,this.pixelRatio)),this.image?t.drawImage(this.image,0,0):(this.specs.backgroundColor&&this.bgCache!==e.style.backgroundColor&&(e.style.backgroundColor=this.specs.backgroundColor,this.bgCache=e.style.backgroundColor),t.fillStyle=this.specs.backgroundColor,t.fillRect(0,0,this.width,this.height));if(this.innerRepaint)this.innerRepaint(t);else if(0!==this.molecules.length||0!==this.shapes.length){t.save(),t.translate(this.width/2,this.height/2),t.rotate(this.specs.rotateAngle),t.scale(this.specs.scale,this.specs.scale),t.translate(-this.width/2,-this.height/2);for(var e=0,n=this.molecules.length;e<n;e++)this.molecules[e].check(!0),this.molecules[e].draw(t,this.specs);e=0;for(n=this.shapes.length;e<n;e++)this.shapes[e].draw(t,this.specs);t.restore()}else this.emptyMessage&&(t.fillStyle="#737683",t.textAlign="center",t.textBaseline="middle",t.font="18px Helvetica, Verdana, Arial, Sans-serif",t.fillText(this.emptyMessage,this.width/2,this.height/2));this.drawChildExtras&&this.drawChildExtras(t)}}},l.resize=function(t,n){var r=s("#"+this.id);r.attr({width:t,height:n}),r.css("width",t),r.css("height",n),this.width=t,this.height=n;if(e._Canvas3D&&this instanceof e._Canvas3D){var r=t,i=n;1!==this.pixelRatio&&(r*=this.pixelRatio,i*=this.pixelRatio,this.gl.canvas.width=r,this.gl.canvas.height=i),this.gl.viewport(0,0,r,i),this.afterLoadContent()}else if(0<this.molecules.length){this.center(),r=0;for(i=this.molecules.length;r<i;r++)this.molecules[r].check()}this.repaint()},l.setBackgroundImage=function(e){this.image=new Image;var t=this;this.image.onload=function(){t.repaint()},this.image.src=e},l.loadMolecule=function(t){this.clear(),this.molecules.push(t),this.center(),e._Canvas3D&&this instanceof e._Canvas3D||t.check(),this.afterLoadContent&&this.afterLoadContent(),this.repaint()},l.loadContent=function(t,n){this.molecules=t?t:[],this.shapes=n?n:[],this.center();if(!(e._Canvas3D&&this instanceof e._Canvas3D))for(var r=0,i=this.molecules.length;r<i;r++)this.molecules[r].check();this.afterLoadContent&&this.afterLoadContent(),this.repaint()},l.addMolecule=function(t){this.molecules.push(t),e._Canvas3D&&this instanceof e._Canvas3D||t.check(),this.repaint()},l.removeMolecule=function(e){this.molecules=s.grep(this.molecules,function(t){return t!==e}),this.repaint()},l.getMolecule=function(){return 0<this.molecules.length?this.molecules[0]:void 0},l.getMolecules=function(){return this.molecules},l.addShape=function(e){this.shapes.push(e),this.repaint()},l.removeShape=function(e){this.shapes=s.grep(this.shapes,function(t){return t!==e}),this.repaint()},l.getShapes=function(){return this.shapes},l.clear=function(){this.molecules=[],this.shapes=[],this.specs.scale=1,this.repaint()},l.center=function(){for(var e=this.getContentBounds(),t=new i.Point((this.width-e.minX-e.maxX)/2,(this.height-e.minY-e.maxY)/2),n=0,r=this.molecules.length;n<r;n++)for(var s=this.molecules[n],u=0,a=s.atoms.length;u<a;u++)s.atoms[u].add(t);n=0;for(r=this.shapes.length;n<r;n++){s=this.shapes[n].getPoints(),u=0;for(a=s.length;u<a;u++)s[u].add(t)}this.specs.scale=1,t=e.maxX-e.minX,e=e.maxY-e.minY;if(t>this.width||e>this.height)this.specs.scale=.85*o.min(this.width/t,this.height/e)},l.bondExists=function(e,t){for(var n=0,r=this.molecules.length;n<r;n++)for(var i=this.molecules[n],s=0,o=i.bonds.length;s<o;s++){var u=i.bonds[s];if(u.contains(e)&&u.contains(t))return!0}return!1},l.getBond=function(e,t){for(var n=0,r=this.molecules.length;n<r;n++)for(var i=this.molecules[n],s=0,o=i.bonds.length;s<o;s++){var u=i.bonds[s];if(u.contains(e)&&u.contains(t))return u}},l.getMoleculeByAtom=function(e){for(var t=0,n=this.molecules.length;t<n;t++){var r=this.molecules[t];if(-1!==r.atoms.indexOf(e))return r}},l.getAllAtoms=function(){for(var e=[],t=0,n=this.molecules.length;t<n;t++)e=e.concat(this.molecules[t].atoms);return e},l.getAllPoints=function(){for(var e=[],t=0,n=this.molecules.length;t<n;t++)e=e.concat(this.molecules[t].atoms);t=0;for(n=this.shapes.length;t<n;t++)e=e.concat(this.shapes[t].getPoints());return e},l.getContentBounds=function(){for(var e=new n.Bounds,t=0,r=this.molecules.length;t<r;t++)e.expand(this.molecules[t].getBounds());t=0;for(r=this.shapes.length;t<r;t++)e.expand(this.shapes[t].getBounds());return e},l.create=function(n,l,c){this.id=n,this.width=l,this.height=c,this.molecules=[],this.shapes=[];if(u.getElementById(n)){var p=s("#"+n);l?p.attr("width",l):this.width=p.attr("width"),c?p.attr("height",c):this.height=p.attr("height"),p.attr("class","ChemDoodleWebComponent")}else{if(!e.featureDetection.supports_canvas_text()&&-1!=f.indexOf("MSIE")){u.writeln('<div style="border: 1px solid black;" width="'+l+'" height="'+c+'">Please install <a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>, then restart Internet Explorer.</div>');return}u.writeln('<canvas class="ChemDoodleWebComponent" id="'+n+'" width="'+l+'" height="'+c+'" alt="ChemDoodle Web Component">This browser does not support HTML5/Canvas.</canvas>')}n=s("#"+n),n.css("width",this.width),n.css("height",this.height),this.pixelRatio=a.devicePixelRatio?a.devicePixelRatio:1,this.specs=new i.VisualSpecifications;var v=this;t.supports_touch()?(n.bind("touchstart",function(e){var n=(new Date).getTime();if(!t.supports_gesture()&&2===e.originalEvent.touches.length){var r=e.originalEvent.touches,s=new i.Point(r[0].pageX,r[0].pageY),r=new i.Point(r[1].pageX,r[1].pageY);v.implementedGestureDist=s.distance(r),v.implementedGestureAngle=s.angle(r),v.gesturestart&&(v.prehandleEvent(e),v.gesturestart(e))}v.lastTouch&&1===e.originalEvent.touches.length&&500>n-v.lastTouch?v.dbltap?(v.prehandleEvent(e),v.dbltap(e)):v.dblclick?(v.prehandleEvent(e),v.dblclick(e)):v.touchstart?(v.prehandleEvent(e),v.touchstart(e)):v.mousedown&&(v.prehandleEvent(e),v.mousedown(e)):v.touchstart?(v.prehandleEvent(e),v.touchstart(e),this.hold&&clearTimeout(this.hold),this.touchhold&&(this.hold=setTimeout(function(){v.touchhold(e)},1e3))):v.mousedown&&(v.prehandleEvent(e),v.mousedown(e)),v.lastTouch=n}),n.bind("touchmove",function(e){this.hold&&(clearTimeout(this.hold),this.hold=void 0);if(!t.supports_gesture()&&2===e.originalEvent.touches.length&&v.gesturechange){var n=e.originalEvent.touches,r=new i.Point(n[0].pageX,n[0].pageY),s=new i.Point(n[1].pageX,n[1].pageY),n=r.distance(s),r=r.angle(s);e.originalEvent.scale=n/v.implementedGestureDist,e.originalEvent.rotation=180*(v.implementedGestureAngle-r)/o.PI,v.prehandleEvent(e),v.gesturechange(e)}if(1<e.originalEvent.touches.length&&v.multitouchmove){r=e.originalEvent.touches.length,v.prehandleEvent(e),n=new i.Point(-e.offset.left*r,-e.offset.top*r);for(s=0;s<r;s++)n.x+=e.originalEvent.changedTouches[s].pageX,n.y+=e.originalEvent.changedTouches[s].pageY;n.x/=r,n.y/=r,e.p=n,v.multitouchmove(e,r)}else v.touchmove?(v.prehandleEvent(e),v.touchmove(e)):v.drag&&(v.prehandleEvent(e),v.drag(e))}),n.bind("touchend",function(e){this.hold&&(clearTimeout(this.hold),this.hold=void 0),!t.supports_gesture()&&v.implementedGestureDist&&(v.implementedGestureDist=void 0,v.implementedGestureAngle=void 0,v.gestureend&&(v.prehandleEvent(e),v.gestureend(e))),v.touchend?(v.prehandleEvent(e),v.touchend(e)):v.mouseup&&(v.prehandleEvent(e),v.mouseup(e)),250>(new Date).getTime()-v.lastTouch&&(v.tap?(v.prehandleEvent(e),v.tap(e)):v.click&&(v.prehandleEvent(e),v.click(e)))}),n.bind("gesturestart",function(e){v.gesturestart&&(v.prehandleEvent(e),v.gesturestart(e))}),n.bind("gesturechange",function(e){v.gesturechange&&(v.prehandleEvent(e),v.gesturechange(e))}),n.bind("gestureend",function(e){v.gestureend&&(v.prehandleEvent(e),v.gestureend(e))})):(n.click(function(e){switch(e.which){case 1:v.click&&(v.prehandleEvent(e),v.click(e));break;case 2:v.middleclick&&(v.prehandleEvent(e),v.middleclick(e));break;case 3:v.rightclick&&(v.prehandleEvent(e),v.rightclick(e))}}),n.dblclick(function(e){v.dblclick&&(v.prehandleEvent(e),v.dblclick(e))}),n.mousedown(function(e){switch(e.which){case 1:r.CANVAS_DRAGGING=v,v.mousedown&&(v.prehandleEvent(e),v.mousedown(e));break;case 2:v.middlemousedown&&(v.prehandleEvent(e),v.middlemousedown(e));break;case 3:v.rightmousedown&&(v.prehandleEvent(e),v.rightmousedown(e))}}),n.mousemove(function(e){!r.CANVAS_DRAGGING&&v.mousemove&&(v.prehandleEvent(e),v.mousemove(e))}),n.mouseout(function(e){r.CANVAS_OVER=void 0,v.mouseout&&(v.prehandleEvent(e),v.mouseout(e))}),n.mouseover(function(e){r.CANVAS_OVER=v,v.mouseover&&(v.prehandleEvent(e),v.mouseover(e))}),n.mouseup(function(e){switch(e.which){case 1:v.mouseup&&(v.prehandleEvent(e),v.mouseup(e));break;case 2:v.middlemouseup&&(v.prehandleEvent(e),v.middlemouseup(e));break;case 3:v.rightmouseup&&(v.prehandleEvent(e),v.rightmouseup(e))}}),n.mousewheel(function(e,t){v.mousewheel&&(v.prehandleEvent(e),v.mousewheel(e,t))})),this.subCreate&&this.subCreate()},l.prehandleEvent=function(e){e.originalEvent.changedTouches&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY),e.preventDefault(),e.offset=s("#"+this.id).offset(),e.p=new i.Point(e.pageX-e.offset.left,e.pageY-e.offset.top)}}(ChemDoodle,ChemDoodle.featureDetection,ChemDoodle.math,ChemDoodle.monitor,ChemDoodle.structures,ChemDoodle.lib.jQuery,Math,document,window,navigator.userAgent),function(e,t){e._AnimatorCanvas=function(e,t,n){e&&this.create(e,t,n)};var n=e._AnimatorCanvas.prototype=new e._Canvas;n.timeout=33,n.startAnimation=function(){this.stopAnimation(),this.lastTime=(new Date).getTime();var e=this;this.nextFrame&&(this.handle=t.requestInterval(function(){var t=(new Date).getTime();e.nextFrame(t-e.lastTime),e.repaint(),e.lastTime=t},this.timeout))},n.stopAnimation=function(){this.handle&&(t.clearRequestInterval(this.handle),this.handle=void 0)},n.isRunning=function(){return void 0!==this.handle}}(ChemDoodle,ChemDoodle.animations),function(e,t){e.FileCanvas=function(e,n,r,i){e&&this.create(e,n,r),t.writeln('<br><form name="FileForm" enctype="multipart/form-data" method="POST" action="'+i+'" target="HiddenFileFrame"><input type="file" name="f" /><input type="submit" name="submitbutton" value="Show File" /></form><iframe id="HFF-'+e+'" name="HiddenFileFrame" height="0" width="0" style="display:none;" onLoad="GetMolFromFrame(\'HFF-'+e+"', "+e+')"></iframe>'),this.emptyMessage="Click below to load file",this.repaint()},e.FileCanvas.prototype=new e._Canvas}(ChemDoodle,document),function(e){e.HyperlinkCanvas=function(e,t,n,r,i,s){e&&this.create(e,t,n),this.urlOrFunction=r,this.color=i?i:"blue",this.size=s?s:2},e=e.HyperlinkCanvas.prototype=new e._Canvas,e.openInNewWindow=!0,e.hoverImage=void 0,e.drawChildExtras=function(e){this.e&&(this.hoverImage?e.drawImage(this.hoverImage,0,0):(e.strokeStyle=this.color,e.lineWidth=2*this.size,e.strokeRect(0,0,this.width,this.height)))},e.setHoverImage=function(e){this.hoverImage=new Image,this.hoverImage.src=e},e.click=function(){this.e=void 0,this.repaint(),this.urlOrFunction instanceof Function?this.urlOrFunction():this.openInNewWindow?window.open(this.urlOrFunction):location.href=this.urlOrFunction},e.mouseout=function(){this.e=void 0,this.repaint()},e.mouseover=function(e){this.e=e,this.repaint()}}(ChemDoodle),function(e,t,n,r){e.MolGrabberCanvas=function(e,t,i){e&&this.create(e,t,i),t=[],t.push('<br><input type="text" id="'),t.push(e),t.push('_query" size="32" value="" />'),t.push("<br><nobr>"),t.push('<select id="'),t.push(e),t.push('_select">'),t.push('<option value="chemexper">ChemExper'),t.push('<option value="chemspider">ChemSpider'),t.push('<option value="pubchem" selected>PubChem'),t.push("</select>"),t.push('<button id="'),t.push(e),t.push('_submit">Show Molecule</button>'),t.push("</nobr>"),r.getElementById(e),n("#"+e).after(t.join(""));var s=this;n("#"+e+"_submit").click(function(){s.search()}),n("#"+e+"_query").keypress(function(e){13===e.which&&s.search()}),this.emptyMessage="Enter search term below",this.repaint()},e=e.MolGrabberCanvas.prototype=new e._Canvas,e.setSearchTerm=function(e){n("#"+this.id+"_query").val(e),this.search()},e.search=function(){this.emptyMessage="Searching...",this.clear();var e=this;t.getMoleculeFromDatabase(n("#"+this.id+"_query").val(),{database:n("#"+this.id+"_select").val()},function(t){e.loadMolecule(t)})}}(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document),function(e,t,n){var r=[],i=[1,0,0],s=[0,1,0],o=[0,0,1];e.RotatorCanvas=function(e,t,n,r){e&&this.create(e,t,n),this.rotate3D=r},e=e.RotatorCanvas.prototype=new e._AnimatorCanvas,t=t.PI/15,e.xIncrement=t,e.yIncrement=t,e.zIncrement=t,e.nextFrame=function(e){if(0===this.molecules.length&&0===this.shapes.length)this.stopAnimation();else if(e/=1e3,this.rotate3D){n.identity(r),n.rotate(r,this.xIncrement*e,i),n.rotate(r,this.yIncrement*e,s),n.rotate(r,this.zIncrement*e,o),e=0;for(var t=this.molecules.length;e<t;e++){for(var u=this.molecules[e],a=0,f=u.atoms.length;a<f;a++){var c=u.atoms[a],p=[c.x-this.width/2,c.y-this.height/2,c.z];n.multiplyVec3(r,p),c.x=p[0]+this.width/2,c.y=p[1]+this.height/2,c.z=p[2]}a=0;for(f=u.rings.length;a<f;a++)u.rings[a].center=u.rings[a].getCenter();this.specs.atoms_display&&this.specs.atoms_circles_2D&&u.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&u.sortBondsByZ()}e=0;for(t=this.shapes.length;e<t;e++){u=this.shapes[e].getPoints(),a=0;for(f=u.length;a<f;a++)c=u[a],p=[c.x-this.width/2,c.y-this.height/2,0],n.multiplyVec3(r,p),c.x=p[0]+this.width/2,c.y=p[1]+this.height/2}}else this.specs.rotateAngle+=this.zIncrement*e},e.dblclick=function(){this.isRunning()?this.stopAnimation():this.startAnimation()}}(ChemDoodle,Math,ChemDoodle.lib.mat4),function(e,t,n){e.SlideshowCanvas=function(e,t,n){e&&this.create(e,t,n)},e=e.SlideshowCanvas.prototype=new e._AnimatorCanvas,e.frames=[],e.curIndex=0,e.timeout=5e3,e.alpha=0,e.innerHandle=void 0,e.phase=0,e.drawChildExtras=function(e){var t=n.getRGB(this.specs.backgroundColor,255);e.fillStyle="rgba("+t[0]+", "+t[1]+", "+t[2]+", "+this.alpha+")",e.fillRect(0,0,this.width,this.height)},e.nextFrame=function(){if(0===this.frames.length)this.stopAnimation();else{this.phase=0;var e=this,t=1;this.innerHandle=setInterval(function(){e.alpha=t/15,e.repaint(),15===t&&e.breakInnerHandle(),t++},33)}},e.breakInnerHandle=function(){this.innerHandle&&(clearInterval(this.innerHandle),this.innerHandle=void 0);if(0===this.phase){this.curIndex++,this.curIndex>this.frames.length-1&&(this.curIndex=0),this.alpha=1;var e=this.frames[this.curIndex];this.loadContent(e.mols,e.shapes),this.phase=1;var t=this,n=1;this.innerHandle=setInterval(function(){t.alpha=(15-n)/15,t.repaint(),15===n&&t.breakInnerHandle(),n++},33)}else 1===this.phase&&(this.alpha=0,this.repaint())},e.addFrame=function(e,t){0===this.frames.length&&this.loadContent(e,t),this.frames.push({mols:e,shapes:t})}}(ChemDoodle,ChemDoodle.animations,ChemDoodle.math),function(e,t,n,r,i){e.TransformCanvas=function(e,t,n,r){e&&this.create(e,t,n),this.rotate3D=r},e=e.TransformCanvas.prototype=new e._Canvas,e.lastPoint=void 0,e.rotationMultMod=1.3,e.lastPinchScale=1,e.lastGestureRotate=0,e.mousedown=function(e){this.lastPoint=e.p},e.dblclick=function(){this.center(),this.repaint()},e.drag=function(e){if(!this.lastPoint.multi){if(t.ALT){var s=new n.Point(e.p.x,e.p.y);s.sub(this.lastPoint);for(var u=0,a=this.molecules.length;u<a;u++){for(var f=this.molecules[u],c=0,p=f.atoms.length;c<p;c++)f.atoms[c].add(s);f.check()}u=0;for(a=this.shapes.length;u<a;u++){f=this.shapes[u].getPoints(),c=0;for(p=f.length;c<p;c++)f[c].add(s)}this.lastPoint=e.p}else if(!0===this.rotate3D){p=r.max(this.width/4,this.height/4),c=(e.p.x-this.lastPoint.x)/p*this.rotationMultMod,p=-(e.p.y-this.lastPoint.y)/p*this.rotationMultMod,s=[],i.identity(s),i.rotate(s,p,[1,0,0]),i.rotate(s,c,[0,1,0]),u=0;for(a=this.molecules.length;u<a;u++){f=this.molecules[u],c=0;for(p=f.atoms.length;c<p;c++)u=f.atoms[c],a=[u.x-this.width/2,u.y-this.height/2,u.z],i.multiplyVec3(s,a),u.x=a[0]+this.width/2,u.y=a[1]+this.height/2,u.z=a[2];u=0;for(a=f.rings.length;u<a;u++)f.rings[u].center=f.rings[u].getCenter();this.lastPoint=e.p,this.specs.atoms_display&&this.specs.atoms_circles_2D&&f.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&f.sortBondsByZ()}}else p=new n.Point(this.width/2,this.height/2),c=p.angle(this.lastPoint),p=p.angle(e.p),this.specs.rotateAngle-=p-c,this.lastPoint=e.p;this.repaint()}},e.mousewheel=function(e,t){this.specs.scale+=t/50,.01>this.specs.scale&&(this.specs.scale=.01),this.repaint()},e.multitouchmove=function(e,t){if(2===t)if(this.lastPoint.multi){var r=new n.Point(e.p.x,e.p.y);r.sub(this.lastPoint);for(var i=0,s=this.molecules.length;i<s;i++){for(var u=this.molecules[i],a=0,f=u.atoms.length;a<f;a++)u.atoms[a].add(r);u.check()}i=0;for(s=this.shapes.length;i<s;i++){u=this.shapes[i].getPoints(),a=0;for(f=u.length;a<f;a++)u[a].add(r)}this.lastPoint=e.p,this.lastPoint.multi=!0,this.repaint()}else this.lastPoint=e.p,this.lastPoint.multi=!0},e.gesturechange=function(
e){0!==e.originalEvent.scale-this.lastPinchScale&&(this.specs.scale*=e.originalEvent.scale/this.lastPinchScale,.01>this.specs.scale&&(this.specs.scale=.01),this.lastPinchScale=e.originalEvent.scale);if(0!==this.lastGestureRotate-e.originalEvent.rotation){for(var t=(this.lastGestureRotate-e.originalEvent.rotation)/180*r.PI,i=new n.Point(this.width/2,this.height/2),s=0,u=this.molecules.length;s<u;s++){for(var a=this.molecules[s],f=0,c=a.atoms.length;f<c;f++){var h=a.atoms[f],p=i.distance(h),d=i.angle(h)+t;h.x=i.x+p*r.cos(d),h.y=i.y-p*r.sin(d)}a.check()}this.lastGestureRotate=e.originalEvent.rotation}this.repaint()},e.gestureend=function(){this.lastPinchScale=1,this.lastGestureRotate=0}}(ChemDoodle,ChemDoodle.monitor,ChemDoodle.structures,Math,ChemDoodle.lib.mat4),function(e){e.ViewerCanvas=function(e,t,n){e&&this.create(e,t,n)},e.ViewerCanvas.prototype=new e._Canvas}(ChemDoodle),function(e){e._SpectrumCanvas=function(e,t,n){e&&this.create(e,t,n)},e=e._SpectrumCanvas.prototype=new e._Canvas,e.spectrum=void 0,e.emptyMessage="No Spectrum Loaded or Recognized",e.loadMolecule=void 0,e.getMolecule=void 0,e.innerRepaint=function(e){this.spectrum&&0<this.spectrum.data.length?this.spectrum.draw(e,this.specs,this.width,this.height):this.emptyMessage&&(e.fillStyle="#737683",e.textAlign="center",e.textBaseline="middle",e.font="18px Helvetica, Verdana, Arial, Sans-serif",e.fillText(this.emptyMessage,this.width/2,this.height/2))},e.loadSpectrum=function(e){this.spectrum=e,this.repaint()},e.getSpectrum=function(){return this.spectrum},e.getSpectrumCoordinates=function(e,t){return spectrum.getInternalCoordinates(e,t,this.width,this.height)}}(ChemDoodle,document),function(e){e.ObserverCanvas=function(e,t,n){e&&this.create(e,t,n)},e.ObserverCanvas.prototype=new e._SpectrumCanvas}(ChemDoodle),function(e){e.OverlayCanvas=function(e,t,n){e&&this.create(e,t,n)},e=e.OverlayCanvas.prototype=new e._SpectrumCanvas,e.overlaySpectra=[],e.superRepaint=e.innerRepaint,e.innerRepaint=function(e){this.superRepaint(e);if(this.spectrum&&0<this.spectrum.data.length)for(var t=0,n=this.overlaySpectra.length;t<n;t++){var r=this.overlaySpectra[t];r&&0<r.data.length&&(r.minX=this.spectrum.minX,r.maxX=this.spectrum.maxX,r.drawPlot(e,this.specs,this.width,this.height,this.spectrum.memory.offsetTop,this.spectrum.memory.offsetLeft,this.spectrum.memory.offsetBottom))}},e.addSpectrum=function(e){this.spectrum?this.overlaySpectra.push(e):this.spectrum=e}}(ChemDoodle),function(e,t,n){e.PerspectiveCanvas=function(e,t,n){e&&this.create(e,t,n)};var r=e.PerspectiveCanvas.prototype=new e._SpectrumCanvas;r.dragRange=void 0,r.rescaleYAxisOnZoom=!0,r.lastPinchScale=1,r.mousedown=function(t){this.dragRange=new e.structures.Point(t.p.x,t.p.x)},r.mouseup=function(e){this.dragRange&&this.dragRange.x!==this.dragRange.y&&(this.dragRange.multi||(e=this.spectrum.zoom(this.dragRange.x,e.p.x,this.width,this.rescaleYAxisOnZoom),this.rescaleYAxisOnZoom&&(this.specs.scale=e)),this.dragRange=void 0,this.repaint())},r.drag=function(e){this.dragRange&&(this.dragRange.multi?this.dragRange=void 0:(t.SHIFT&&(this.spectrum.translate(e.p.x-this.dragRange.x,this.width),this.dragRange.x=e.p.x),this.dragRange.y=e.p.x),this.repaint())},r.drawChildExtras=function(e){if(this.dragRange){var t=n.min(this.dragRange.x,this.dragRange.y),r=n.max(this.dragRange.x,this.dragRange.y);e.strokeStyle="gray",e.lineStyle=1,e.beginPath();for(e.moveTo(t,this.height/2);t<=r;t++)5>t%10?e.lineTo(t,n.round(this.height/2)):e.moveTo(t,n.round(this.height/2));e.stroke()}},r.mousewheel=function(e,t){this.specs.scale+=t/10,.01>this.specs.scale&&(this.specs.scale=.01),this.repaint()},r.dblclick=function(){this.spectrum.setup(),this.specs.scale=1,this.repaint()},r.multitouchmove=function(t,n){2===n&&(!this.dragRange||!this.dragRange.multi?(this.dragRange=new e.structures.Point(t.p.x,t.p.x),this.dragRange.multi=!0):(this.spectrum.translate(t.p.x-this.dragRange.x,this.width),this.dragRange.x=t.p.x,this.dragRange.y=t.p.x,this.repaint()))},r.gesturechange=function(e){this.specs.scale*=e.originalEvent.scale/this.lastPinchScale,.01>this.specs.scale&&(this.specs.scale=.01),this.lastPinchScale=e.originalEvent.scale,this.repaint()},r.gestureend=function(){this.lastPinchScale=1}}(ChemDoodle,ChemDoodle.monitor,Math),function(e,t,n){e.SeekerCanvas=function(e,t,n,r){e&&this.create(e,t,n),this.seekType=r};var r=e.SeekerCanvas.prototype=new e._SpectrumCanvas;r.superRepaint=r.innerRepaint,r.innerRepaint=function(r){this.superRepaint(r);if(this.spectrum&&0<this.spectrum.data.length&&this.p){var i,s;if(this.seekType===e.SeekerCanvas.SEEK_POINTER)i=this.p,s=this.spectrum.getInternalCoordinates(i.x,i.y);else if(this.seekType===e.SeekerCanvas.SEEK_PLOT||this.seekType===e.SeekerCanvas.SEEK_PEAK){s=this.seekType===e.SeekerCanvas.SEEK_PLOT?this.spectrum.getClosestPlotInternalCoordinates(this.p.x):this.spectrum.getClosestPeakInternalCoordinates(this.p.x);if(!s)return;i={x:this.spectrum.getTransformedX(s.x,this.specs,this.width,this.spectrum.memory.offsetLeft),y:this.spectrum.getTransformedY(s.y/100,this.specs,this.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)}}r.fillStyle="white",r.strokeStyle=this.specs.plots_color,r.lineWidth=this.specs.plots_width,r.beginPath(),r.arc(i.x,i.y,3,0,2*n.PI,!1),r.fill(),r.stroke(),r.font=t.getFontString(this.specs.text_font_size,this.specs.text_font_families),r.textAlign="left",r.textBaseline="bottom",s="x:"+s.x.toFixed(3)+", y:"+s.y.toFixed(3);var u=i.x+3,a=r.measureText(s).width;u+a>this.width-2&&(u-=6+a),i=i.y,0>i-this.specs.text_font_size-2&&(i+=this.specs.text_font_size),r.fillRect(u,i-this.specs.text_font_size,a,this.specs.text_font_size),r.fillStyle="black",r.fillText(s,u,i)}},r.mouseout=function(){this.p=void 0,this.repaint()},r.mousemove=function(e){this.p={x:e.p.x-2,y:e.p.y-3},this.repaint()},r.touchstart=function(e){this.mousemove(e)},r.touchmove=function(e){this.mousemove(e)},r.touchend=function(e){this.mouseout(e)},e.SeekerCanvas.SEEK_POINTER="pointer",e.SeekerCanvas.SEEK_PLOT="plot",e.SeekerCanvas.SEEK_PEAK="peak"}(ChemDoodle,ChemDoodle.extensions,Math),function(e,t,n,r,i,s,o,u,a,f,l,c){e._Canvas3D=function(e,t,n){e&&this.create(e,t,n)};var h=e._Canvas3D.prototype=new e._Canvas;h.rotationMatrix=void 0,h.translationMatrix=void 0,h.lastPoint=void 0,h.emptyMessage="WebGL is Unavailable!",h.lastPinchScale=1,h.lastGestureRotate=0,h.afterLoadContent=function(){for(var e=new n.Bounds,t=0,r=this.molecules.length;t<r;t++)e.expand(this.molecules[t].getBounds3D());var i=l.dist([e.maxX,e.maxY,e.maxZ],[e.minX,e.minY,e.minZ])/2+1.5;Infinity===i&&(i=10),t=45,r=Math.tan(t/360*Math.PI)/.8,this.depth=i/r;var r=o.max(this.depth-i,.1),i=this.depth+i,s=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight;1>s&&(t/=s),this.specs.projectionOrthoWidth_3D=2*Math.tan(t/360*Math.PI)*this.depth*s,this.specs.projectionPerspectiveVerticalFieldOfView_3D=t,this.specs.projectionFrontCulling_3D=r,this.specs.projectionBackCulling_3D=i,this.specs.projectionWidthHeightRatio_3D=s,this.translationMatrix=a.translate(a.identity([]),[0,0,-this.depth]),this.maxDimension=o.max(e.maxX-e.minX,e.maxY-e.minY),this.setupScene()},h.setViewDistance=function(e){this.specs.projectionPerspectiveVerticalFieldOfView_3D=n.clamp(this.specs.projectionPerspectiveVerticalFieldOfView_3D/e,.1,179.9),this.specs.projectionOrthoWidth_3D=2*o.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*Math.PI)*this.depth*this.specs.projectionWidthHeightRatio_3D,this.updateScene()},h.repaint=function(){if(this.gl){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.modelViewMatrix=a.multiply(this.translationMatrix,this.rotationMatrix,[]),this.gl.rotationMatrix=this.rotationMatrix;var e=this.gl.getUniformLocation(this.gl.program,"u_projection_matrix");this.gl.uniformMatrix4fv(e,!1,this.gl.projectionMatrix),this.gl.fogging.setMode(this.specs.fog_mode_3D);for(var t=0,n=this.molecules.length;t<n;t++)this.molecules[t].render(this.gl,this.specs);t=0;for(n=this.shapes.length;t<n;t++)this.shapes[t].render(this.gl,this.specs);this.specs.compass_display&&(this.gl.uniformMatrix4fv(e,!1,this.compass.projectionMatrix),this.compass.render(this.gl,this.specs),this.gl.setMatrixUniforms(this.gl.modelViewMatrix),this.gl.uniformMatrix4fv(e,!1,this.gl.projectionMatrix)),this.gl.enable(this.gl.BLEND),this.gl.depthMask(!1),this.gl.enableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.specs.atoms_displayLabels_3D&&this.label3D.render(this.gl,this.specs,this.getMolecules()),this.specs.compass_display&&this.specs.compass_displayText_3D&&(this.gl.uniformMatrix4fv(e,!1,this.compass.projectionMatrix),this.compass.renderAxis(this.gl),this.gl.setMatrixUniforms(this.gl.modelViewMatrix),this.gl.uniformMatrix4fv(e,!1,this.gl.projectionMatrix)),this.gl.disableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.gl.disable(this.gl.BLEND),this.gl.depthMask(!0),this.gl.disable(this.gl.DEPTH_TEST),this.drawChildExtras&&this.drawChildExtras(this.gl),this.gl.enable(this.gl.DEPTH_TEST),this.gl.flush()}},h.pick=function(e,t,n,r){if(this.gl){a.multiply(this.translationMatrix,this.rotationMatrix,this.gl.modelViewMatrix),this.gl.rotationMatrix=this.rotationMatrix;var i=this.gl.getUniformLocation(this.gl.program,"u_projection_matrix");return this.gl.uniformMatrix4fv(i,!1,this.gl.projectionMatrix),t=this.height-t,1!==this.pixelRatio&&(e*=this.pixelRatio,t*=this.pixelRatio),this.picker.pick(this.gl,this.molecules,this.specs,e,t,n,r)}},h.center=function(){for(var e=new r.Atom,t=0,n=this.molecules.length;t<n;t++){var i=this.molecules[t];e.add3D(i.getCenter3D())}e.x/=this.molecules.length,e.y/=this.molecules.length,t=0;for(n=this.molecules.length;t<n;t++){for(var i=this.molecules[t],s=0,o=i.atoms.length;s<o;s++)i.atoms[s].sub3D(e);if(i.chains&&i.fromJSON){s=0;for(o=i.chains.length;s<o;s++)for(var u=i.chains[s],a=0,f=u.length;a<f;a++){var l=u[a];l.cp1.sub3D(e),l.cp2.sub3D(e),l.cp3&&(l.cp3.sub3D(e),l.cp4.sub3D(e),l.cp5.sub3D(e))}}}},h.subCreate=function(){try{var e=u.getElementById(this.id);this.gl=e.getContext("webgl"),this.gl||(this.gl=e.getContext("experimental-webgl"))}catch(t){}this.gl?(1!==this.pixelRatio&&this.gl.canvas.width===this.width&&(this.gl.canvas.style.width=this.width+"px",this.gl.canvas.style.height=this.height+"px",this.gl.canvas.width=this.width*this.pixelRatio,this.gl.canvas.height=this.height*this.pixelRatio),this.rotationMatrix=a.identity([]),this.translationMatrix=a.identity([]),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.program=this.gl.createProgram(),this.gl.shader=new i.Shader,this.gl.shader.init(this.gl),this.gl.programLabel=this.gl.createProgram(),this.setupScene()):this.displayMessage()},e._Canvas.prototype.displayMessage=function(){var e=u.getElementById(this.id);e.getContext&&(e=e.getContext("2d"),this.specs.backgroundColor&&(e.fillStyle=this.specs.backgroundColor,e.fillRect(0,0,this.width,this.height)),this.emptyMessage&&(e.fillStyle="#737683",e.textAlign="center",e.textBaseline="middle",e.font="18px Helvetica, Verdana, Arial, Sans-serif",e.fillText(this.emptyMessage,this.width/2,this.height/2)))},h.renderText=function(e,t){if(this.gl){var n={position:[],texCoord:[],translation:[]};this.gl.textImage.pushVertexData(e,t,0,n),this.gl.textMesh.storeData(this.gl,n.position,n.texCoord,n.translation),this.gl.enable(this.gl.BLEND),this.gl.depthMask(!1),this.gl.enableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.gl.textImage.useTexture(this.gl),this.gl.textMesh.render(this.gl),this.gl.disableVertexAttribArray(this.gl.shader.vertexTexCoordAttribute),this.gl.disable(this.gl.BLEND),this.gl.depthMask(!0)}},h.setupScene=function(){if(this.gl){c("#"+this.id).css("background-color",this.specs.backgroundColor);var u=n.getRGB(this.specs.backgroundColor,1);this.gl.clearColor(u[0],u[1],u[2],1),this.gl.clearDepth(1),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),this.specs.cullBackFace_3D?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this.gl.sphereBuffer=new i.Sphere(1,this.specs.atoms_resolution_3D,this.specs.atoms_resolution_3D),this.gl.starBuffer=new i.Star,this.gl.cylinderBuffer=new i.Cylinder(1,1,this.specs.bonds_resolution_3D),this.gl.cylinderClosedBuffer=new i.Cylinder(1,1,this.specs.bonds_resolution_3D,!0),this.gl.boxBuffer=new i.Box(1,1,1),this.gl.pillBuffer=new i.Pill(this.specs.bonds_pillDiameter_3D/2,this.specs.bonds_pillHeight_3D,this.specs.bonds_pillLatitudeResolution_3D,this.specs.bonds_pillLongitudeResolution_3D),this.gl.lineBuffer=new i.Line,this.gl.lineArrowBuffer=new i.LineArrow,this.gl.arrowBuffer=new i.Arrow(.3,this.specs.compass_resolution_3D),this.gl.textMesh=new i.TextMesh,this.gl.textMesh.init(this.gl),this.gl.textImage=new i.TextImage,this.gl.textImage.init(this.gl),this.gl.textImage.updateFont(this.gl,this.specs.text_font_size,this.specs.text_font_families,this.specs.text_font_bold,this.specs.text_font_italic,this.specs.text_font_stroke_3D),this.label3D=new i.Label,this.label3D.init(this.gl,this.specs);for(var h=0,p=this.molecules.length;h<p;h++)if(u=this.molecules[h],u.labelMesh instanceof i.TextMesh||(u.labelMesh=new i.TextMesh,u.labelMesh.init(this.gl)),u.chains){u.ribbons=[],u.cartoons=[],u.tubes=[],u.pipePlanks=[];for(var v=0,m=u.chains.length;v<m;v++){for(var y=u.chains[v],w=0,E=y.length-1;w<E;w++)y[w].Test=w;var S=3<y.length&&s[y[3].name]&&"#BEA06E"===s[y[3].name].aminoColor;if(0<y.length&&!y[0].lineSegments){w=0;for(E=y.length-1;w<E;w++)y[w].setup(y[w+1].cp1,S?1:this.specs.proteins_horizontalResolution);if(!S){w=1;for(E=y.length-1;w<E;w++)t.vec3AngleFrom(y[w-1].D,y[w].D)>o.PI/2&&(y[w].guidePointsSmall.reverse(),y[w].guidePointsLarge.reverse(),l.scale(y[w].D,-1))}w=2;for(E=y.length-3;w<E;w++)y[w].computeLineSegments(y[w-2],y[w-1],y[w+1],!S,S?this.specs.nucleics_verticalResolution:this.specs.proteins_verticalResolution);y.pop(),y.pop(),y.pop(),y.shift(),y.shift()}w=n.hsl2rgb(1===m?.5:v/m,1,.5),w="rgb("+w[0]+","+w[1]+","+w[2]+")",y.chainColor=w,S?(S=new i.Tube(y,this.specs.nucleics_tubeThickness,this.specs.nucleics_tubeResolution_3D),S.chainColor=w,u.tubes.push(S)):(S=new i.PipePlank(y,this.specs),u.pipePlanks.push(S),S=y.shift(),E={front:new i.Ribbon(y,this.specs.proteins_ribbonThickness,!1),back:new i.Ribbon(y,-this.specs.proteins_ribbonThickness,!1)},E.front.chainColor=w,E.back.chainColor=w,u.ribbons.push(E),E={front:new i.Ribbon(y,this.specs.proteins_ribbonThickness,!0),back:new i.Ribbon(y,-this.specs.proteins_ribbonThickness,!0)},E.front.chainColor=w,E.back.chainColor=w,u.cartoons.push(E),y.unshift(S))}}this.label3D.updateVerticesBuffer(this.gl,this.getMolecules(),this.specs);if(this instanceof e.MovieCanvas3D&&this.frames){w=0;for(E=this.frames.length;w<E;w++){h=this.frames[w],v=0;for(m=h.mols.length;v<m;v++)u=h.mols[v],u.labelMesh instanceof r.d3.TextMesh||(u.labelMesh=new r.d3.TextMesh,u.labelMesh.init(this.gl));this.label3D.updateVerticesBuffer(this.gl,h.mols,this.specs)}}this.gl.lighting=new i.Light(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D),this.gl.lighting.lightScene(this.gl),this.gl.material=new i.Material(this.gl),this.gl.fogging=new i.Fog(this.gl),this.gl.fogging.setTempParameter(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D),this.compass=new i.Compass(this.gl,this.specs),u=this.width/this.height,this.specs.projectionWidthHeightRatio_3D&&(u=this.specs.projectionWidthHeightRatio_3D),this.gl.projectionMatrix=this.specs.projectionPerspective_3D?a.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,u,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D):a.ortho(-this.specs.projectionOrthoWidth_3D/2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/2/u,this.specs.projectionOrthoWidth_3D/2/u,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D),u=this.gl.getUniformLocation(this.gl.program,"u_projection_matrix"),this.gl.uniformMatrix4fv(u,!1,this.gl.projectionMatrix);var T=this.gl.getUniformLocation(this.gl.program,"u_model_view_matrix"),N=this.gl.getUniformLocation(this.gl.program,"u_normal_matrix");this.gl.setMatrixUniforms=function(e){this.uniformMatrix4fv(T,!1,e),e=f.transpose(a.toInverseMat3(e,[])),this.uniformMatrix3fv(N,!1,e)},v=this.gl.getUniformLocation(this.gl.program,"u_dimension"),this.gl.uniformMatrix4fv(u,!1,this.gl.projectionMatrix),this.gl.uniform2f(v,this.gl.canvas.clientWidth,this.gl.canvas.clientHeight),this.picker=new i.Picker,this.picker.init(this.gl),this.picker.setDimension(this.gl,this.gl.canvas.width,this.gl.canvas.height)}},h.updateScene=function(){this.gl.fogging.setTempParameter(this.specs.fog_color_3D||this.specs.backgroundColor,this.specs.fog_start_3D,this.specs.fog_end_3D,this.specs.fog_density_3D);var e=this.width/this.height;this.specs.projectionWidthHeightRatio_3D&&(e=this.specs.projectionWidthHeightRatio_3D),this.gl.projectionMatrix=this.specs.projectionPerspective_3D?a.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,e,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D):a.ortho(-this.specs.projectionOrthoWidth_3D/2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/2/e,this.specs.projectionOrthoWidth_3D/2/e,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D),this.repaint()},h.mousedown=function(e){this.lastPoint=e.p},h.mouseup=function(){this.lastPoint=void 0},h.rightmousedown=function(e){this.lastPoint=e.p},h.drag=function(t){if(this.lastPoint){if(e.monitor.ALT){var n=new r.Point(t.p.x,t.p.y);n.sub(this.lastPoint);var i=o.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*o.PI),i=this.depth/(this.height/2/i);a.translate(this.translationMatrix,[n.x*i,-n.y*i,0])}else i=t.p.x-this.lastPoint.x,n=t.p.y-this.lastPoint.y,i=a.rotate(a.identity([]),i*o.PI/180,[0,1,0]),a.rotate(i,n*o.PI/180,[1,0,0]),this.rotationMatrix=a.multiply(i,this.rotationMatrix);this.lastPoint=t.p,this.repaint()}},h.mousewheel=function(e,t){var n=this.specs.projectionPerspectiveVerticalFieldOfView_3D+t;this.specs.projectionPerspectiveVerticalFieldOfView_3D=.1>n?.1:179.9<n?179.9:n,this.specs.projectionOrthoWidth_3D=2*Math.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*Math.PI)*this.depth*this.specs.projectionWidthHeightRatio_3D,this.updateScene()},h.multitouchmove=function(e,t){if(2===t)if(this.lastPoint&&this.lastPoint.multi){var n=new r.Point(e.p.x,e.p.y);n.sub(this.lastPoint);var i=o.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*o.PI),i=this.depth/(this.height/2/i);a.translate(this.translationMatrix,[n.x*i,-n.y*i,0]),this.lastPoint=e.p,this.repaint()}else this.lastPoint=e.p,this.lastPoint.multi=!0},h.gesturechange=function(e){if(0!==e.originalEvent.scale-this.lastPinchScale){var t=30*-(e.originalEvent.scale/this.lastPinchScale-1);if(isNaN(t))return;t=this.specs.projectionPerspectiveVerticalFieldOfView_3D+t,this.specs.projectionPerspectiveVerticalFieldOfView_3D=.1>t?.1:179.9<t?179.9:t,this.specs.projectionOrthoWidth_3D=2*Math.tan(this.specs.projectionPerspectiveVerticalFieldOfView_3D/360*Math.PI)*this.depth*this.specs.projectionWidthHeightRatio_3D,this.updateScene(),this.lastPinchScale=e.originalEvent.scale}this.repaint()},h.gestureend=function(){this.lastPinchScale=1,this.lastGestureRotate=0}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.RESIDUE,Math,document,ChemDoodle.lib.mat4,ChemDoodle.lib.mat3,ChemDoodle.lib.vec3,ChemDoodle.lib.jQuery,window),function(e,t,n,r){e.MolGrabberCanvas3D=function(e,t,i){e&&this.create(e,t,i),t=[],t.push('<br><input type="text" id="'),t.push(e),t.push('_query" size="32" value="" />'),t.push("<br><nobr>"),t.push('<select id="'),t.push(e),t.push('_select">'),t.push('<option value="pubchem" selected>PubChem'),t.push("</select>"),t.push('<button id="'),t.push(e),t.push('_submit">Show Molecule</button>'),t.push("</nobr>"),r.writeln(t.join(""));var s=this;n("#"+e+"_submit").click(function(){s.search()}),n("#"+e+"_query").keypress(function(e){13===e.which&&s.search()})},e=e.MolGrabberCanvas3D.prototype=new e._Canvas3D,e.setSearchTerm=function(e){n("#"+this.id+"_query").val(e),this.search()},e.search=function(){var e=this;t.getMoleculeFromDatabase(n("#"+this.id+"_query").val(),{database:n("#"+this.id+"_select").val(),dimension:3},function(t){e.loadMolecule(t)})}}(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document),function(e,t){e.MovieCanvas3D=function(e,t,n){e&&this.create(e,t,n),this.frames=[]},e.MovieCanvas3D.PLAY_ONCE=0,e.MovieCanvas3D.PLAY_LOOP=1,e.MovieCanvas3D.PLAY_SPRING=2;var n=e.MovieCanvas3D.prototype=new e._Canvas3D;n.timeout=50,n.frameNumber=0,n.playMode=2,n.reverse=!1,n.startAnimation=e._AnimatorCanvas.prototype.startAnimation,n.stopAnimation=e._AnimatorCanvas.prototype.stopAnimation,n.isRunning=e._AnimatorCanvas.prototype.isRunning,n.dblclick=e.RotatorCanvas.prototype.dblclick,n.nextFrame=function(){var e=this.frames[this.frameNumber];this.molecules=e.mols,this.shapes=e.shapes,2===this.playMode&&this.reverse?(this.frameNumber--,0>this.frameNumber&&(this.frameNumber=1,this.reverse=!1)):(this.frameNumber++,this.frameNumber>=this.frames.length&&(2===this.playMode?(this.frameNumber-=2,this.reverse=!0):(this.frameNumber=0,0===this.playMode&&this.stopAnimation())))},n.center=function(){for(var e=new t.Atom,n=this.frames[0],r=0,i=n.mols.length;r<i;r++)e.add3D(n.mols[r].getCenter3D());e.x/=n.mols.length,e.y/=n.mols.length,n=new t.Atom,n.sub3D(e);for(var e=0,s=this.frames.length;e<s;e++)for(var o=this.frames[e],r=0,i=o.mols.length;r<i;r++)for(var u=o.mols[r],a=0,f=u.atoms.length;a<f;a++)u.atoms[a].add3D(n)},n.addFrame=function(e,t){this.frames.push({mols:e,shapes:t})}}(ChemDoodle,ChemDoodle.structures),function(e,t,n){var r=[],i=[1,0,0],s=[0,1,0],o=[0,0,1];e.RotatorCanvas3D=function(e,t,n){e&&this.create(e,t,n)};var u=e.RotatorCanvas3D.prototype=new e._Canvas3D;u.timeout=33,t=t.PI/15,u.xIncrement=t,u.yIncrement=t,u.zIncrement=t,u.startAnimation=e._AnimatorCanvas.prototype.startAnimation,u.stopAnimation=e._AnimatorCanvas.prototype.stopAnimation,u.isRunning=e._AnimatorCanvas.prototype.isRunning,u.dblclick=e.RotatorCanvas.prototype.dblclick,u.mousedown=void 0,u.rightmousedown=void 0,u.drag=void 0,u.mousewheel=void 0,u.nextFrame=function(e){0===this.molecules.length&&0===this.shapes.length?this.stopAnimation():(n.identity(r),e/=1e3,n.rotate(r,this.xIncrement*e,i),n.rotate(r,this.yIncrement*e,s),n.rotate(r,this.zIncrement*e,o),n.multiply(this.rotationMatrix,r))}}(ChemDoodle,Math,ChemDoodle.lib.mat4),function(e){e.TransformCanvas3D=function(e,t,n){e&&this.create(e,t,n)},e.TransformCanvas3D.prototype=new e._Canvas3D}(ChemDoodle),function(e){e.ViewerCanvas3D=function(e,t,n){e&&this.create(e,t,n)},e=e.ViewerCanvas3D.prototype=new e._Canvas3D,e.mousedown=void 0,e.rightmousedown=void 0,e.drag=void 0,e.mousewheel=void 0}(ChemDoodle),function(e,t,n){function r(e,t,n,r){this.element=e,this.x=t,this.y=n,this.dimension=r,this.allowMultipleSelections=!1}e.PeriodicTableCanvas=function(e,t){this.padding=5,e&&this.create(e,18*t+2*this.padding,10*t+2*this.padding),this.cellDimension=t?t:20,this.setupTable(),this.repaint()};var i=e.PeriodicTableCanvas.prototype=new e._Canvas;i.loadMolecule=void 0,i.getMolecule=void 0,i.getHoveredElement=function(){if(this.hovered)return this.hovered.element},i.innerRepaint=function(e){for(var t=0,n=this.cells.length;t<n;t++)this.drawCell(e,this.specs,this.cells[t]);this.hovered&&this.drawCell(e,this.specs,this.hovered),this.selected&&this.drawCell(e,this.specs,this.selected)},i.setupTable=function(){this.cells=[];for(var t=this.padding,n=this.padding,i=0,s=0,o=e.SYMBOLS.length;s<o;s++){18===i&&(i=0,n+=this.cellDimension,t=this.padding);var u=e.ELEMENT[e.SYMBOLS[s]];if(2===u.atomicNumber)t+=16*this.cellDimension,i+=16;else if(5===u.atomicNumber||13===u.atomicNumber)t+=10*this.cellDimension,i+=10;(58>u.atomicNumber||71<u.atomicNumber&&90>u.atomicNumber||103<u.atomicNumber)&&113>u.atomicNumber&&(this.cells.push(new r(u,t,n,this.cellDimension)),t+=this.cellDimension,i++)}n+=2*this.cellDimension,t=3*this.cellDimension+this.padding;for(s=57;104>s;s++)if(u=e.ELEMENT[e.SYMBOLS[s]],90===u.atomicNumber&&(n+=this.cellDimension,t=3*this.cellDimension+this.padding),58<=u.atomicNumber&&71>=u.atomicNumber||90<=u.atomicNumber&&103>=u.atomicNumber)this.cells.push(new r(u,t,n,this.cellDimension)),t+=this.cellDimension},i.drawCell=function(e,n,r){var i=e.createRadialGradient(r.x+r.dimension/3,r.y+r.dimension/3,1.5*r.dimension,r.x+r.dimension/3,r.y+r.dimension/3,r.dimension/10);i.addColorStop(0,"#000000"),i.addColorStop(.7,r.element.jmolColor),i.addColorStop(1,"#FFFFFF"),e.fillStyle=i,t.contextRoundRect(e,r.x,r.y,r.dimension,r.dimension,r.dimension/8);if(r===this.hovered||r===this.selected||r.selected)e.lineWidth=2,e.strokeStyle="#c10000",e.stroke(),e.fillStyle="white";e.fill(),e.font=t.getFontString(n.text_font_size,n.text_font_families),e.fillStyle=n.text_color,e.textAlign="center",e.textBaseline="middle",e.fillText(r.element.symbol,r.x+r.dimension/2,r.y+r.dimension/2)},i.click=function(){this.hovered&&(this.allowMultipleSelections?this.hovered.selected=!this.hovered.selected:this.selected=this.hovered,this.repaint())},i.touchstart=function(e){this.mousemove(e)},i.mousemove=function(e){var t=e.p.x;e=e.p.y,this.hovered=void 0;for(var r=0,i=this.cells.length;r<i;r++){var s=this.cells[r];if(n.isBetween(t,s.x,s.x+s.dimension)&&n.isBetween(e,s.y,s.y+s.dimension)){this.hovered=s;break}}this.repaint()},i.mouseout=function(){this.hovered=void 0,this.repaint()}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,document),function(e,t,n){e.png={},e.png.create=function(e){n.open(t.getElementById(e.id).toDataURL("image/png"))}}(ChemDoodle.io,document,window),function(e,t){e.file={},e.file.content=function(e,n){t.get(e,"",n)}}(ChemDoodle.io,ChemDoodle.lib.jQuery),function(e,t,n,r,i,s){t.SERVER_URL="https://ichemlabs.cloud.chemdoodle.com/icl_cdc_v070000/WebHQ",t.inRelay=!1,t.asynchronous=!0,t.INFO={userAgent:navigator.userAgent,v_cwc:e.getVersion(),v_jQuery:i.version,v_jQuery_ui:i.ui?i.ui.version:"N/A"};var o=new n.JSONInterpreter,u=new r.Queue;t.useHTTPS=function(){t.SERVER_URL="https"+t.SERVER_URL.substr(4)},t._contactServer=function(e,n,r,s,o){this.inRelay?u.enqueue({call:e,content:n,options:r,callback:s,errorback:o}):(t.inRelay=!0,i.ajax({dataType:"text",type:"POST",data:JSON.stringify({call:e,content:n,options:r,info:t.INFO}),url:this.SERVER_URL,success:function(e){e=JSON.parse(e),e.message&&alert(e.message),t.inRelay=!1,s&&e.content&&!e.stop&&s(e.content),e.stop&&o&&o(),u.isEmpty()||(e=u.dequeue(),t._contactServer(e.call,e.content,e.options,e.callback,e.errorback))},error:function(){"checkForUpdates"!=e&&alert("Call failed. Please try again. If you continue to see this message, please contact iChemLabs customer support."),t.inRelay=!1,o&&o();if(!u.isEmpty()){var n=u.dequeue();t._contactServer(n.call,n.content,n.options,n.callback,n.errorback)}},xhrFields:{withCredentials:!0},async:t.asynchronous}))},t.authenticate=function(e,t,n,r){this._contactServer("authenticate",{credential:e},t,function(e){n(e)},r)},t.calculate=function(e,t,n,r){this._contactServer("calculate",{mol:o.molTo(e)},t,function(e){n(e)},r)},t.createLewisDotStructure=function(e,t,n,r){this._contactServer("createLewisDot",{mol:o.molTo(e)},t,function(e){n(o.molFrom(e.mol))},r)},t.generateImage=function(e,t,n,r){this._contactServer("generateImage",{mol:o.molTo(e)},t,function(e){n(e.link)},r)},t.generateIUPACName=function(e,t,n,r){this._contactServer("generateIUPACName",{mol:o.molTo(e)},t,function(e){n(e.iupac)},r)},t.getAd=function(e,t){this._contactServer("getAd",{},{},function(t){e(t.image_url,t.target_url)},t)},t.getMoleculeFromContent=function(e,t,n,r){this._contactServer("getMoleculeFromContent",{content:e},t,function(e){for(var t=!1,r=0,i=e.mol.a.length;r<i;r++)if(0!==e.mol.a[r].z){t=!0;break}if(t){r=0;for(i=e.mol.a.length;r<i;r++)e.mol.a[r].x/=20,e.mol.a[r].y/=20,e.mol.a[r].z/=20}n(o.molFrom(e.mol))},r)},t.getMoleculeFromDatabase=function(e,t,n,r){this._contactServer("getMoleculeFromDatabase",{query:e},t,function(e){if(3===t.dimension)for(var r=0,i=e.mol.a.length;r<i;r++)e.mol.a[r].x/=20,e.mol.a[r].y/=-20,e.mol.a[r].z/=20;n(o.molFrom(e.mol))},r)},t.getOptimizedPDBStructure=function(e,t,n,i){this._contactServer("getOptimizedPDBStructure",{id:e},t,function(e){var t;t=e.mol?o.molFrom(e.mol):new r.Molecule,t.chains=o.chainsFrom(e.ribbons),t.fromJSON=!0,n(t)},i)},t.getZeoliteFromIZA=function(e,t,n,r){this._contactServer("getZeoliteFromIZA",{query:e},t,function(e){n(ChemDoodle.readCIF(e.cif,t.xSuper,t.ySuper,t.zSuper))},r)},t.isGraphIsomorphism=function(e,t,n,r,i){this._contactServer("isGraphIsomorphism",{arrow:o.molTo(e),target:o.molTo(t)},n,function(e){r(e.value)},i)},t.isSubgraphIsomorphism=function(e,t,n,r,i){this._contactServer("isSubgraphIsomorphism",{arrow:o.molTo(e),target:o.molTo(t)},n,function(e){r(e.value)},i)},t.isSupergraphIsomorphism=function(e,t,n,r,i){this._contactServer("isSupergraphIsomorphism",{arrow:o.molTo(e),target:o.molTo(t)},n,function(e){r(e.value)},i)},t.getSimilarityMeasure=function(e,t,n,r,i){this._contactServer("getSimilarityMeasure",{first:o.molTo(e),second:o.molTo(t)},n,function(e){r(e.value)},i)},t.kekulize=function(e,t,n,r){this._contactServer("kekulize",{mol:o.molTo(e)},t,function(e){n(o.molFrom(e.mol))},r)},t.optimize=function(e,t,n,r){this._contactServer("optimize",{mol:o.molTo(e)},t,function(r){r=o.molFrom(r.mol);if(2===t.dimension){for(var i=0,s=r.atoms.length;i<s;i++)e.atoms[i].x=r.atoms[i].x,e.atoms[i].y=r.atoms[i].y;n()}else if(3===t.dimension){i=0;for(s=r.atoms.length;i<s;i++)r.atoms[i].x/=20,r.atoms[i].y/=-20,r.atoms[i].z/=20;n(r)}},r)},t.readIUPACName=function(e,t,n,r){this._contactServer("readIUPACName",{iupac:e},t,function(e){n(o.molFrom(e.mol))},r)},t.readSMILES=function(e,t,n,r){this._contactServer("readSMILES",{smiles:e},t,function(e){n(o.molFrom(e.mol))},r)},t.saveFile=function(e,t,n,r){this._contactServer("saveFile",{mol:o.molTo(e)},t,function(e){n(e.link)},r)},t.simulate13CNMR=function(t,n,r,i){n.nucleus="C",n.isotope=13,this._contactServer("simulateNMR",{mol:o.molTo(t)},n,function(t){r(e.readJCAMP(t.jcamp))},i)},t.simulate1HNMR=function(t,n,r,i){n.nucleus="H",n.isotope=1,this._contactServer("simulateNMR",{mol:o.molTo(t)},n,function(t){r(e.readJCAMP(t.jcamp))},i)},t.simulateMassParentPeak=function(t,n,r,i){this._contactServer("simulateMassParentPeak",{mol:o.molTo(t)},n,function(t){r(e.readJCAMP(t.jcamp))},i)},t.writeSMILES=function(e,t,n,r){this._contactServer("writeSMILES",{mol:o.molTo(e)},t,function(e){n(e.smiles)},r)},t.version=function(e,t,n){this._contactServer("version",{},e,function(e){t(e.value)},n)},t.checkForUpdates=function(e){this._contactServer("checkForUpdates",{value:s.href},e,function(){},function(){})}}(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery,location);